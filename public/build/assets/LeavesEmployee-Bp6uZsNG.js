import{a as e,j as t,F as j,q as J,Y as K}from"./app-D3fM7yDT.js";import{s as Q,j as X,u as M,h as $,i as E,k as n,l as z,f as O,T as C,A as U,N as V,c as _,n as Z,o as ee,r as o,O as ae,G as p,F as te,m as re,S as ne,M as P,P as le,b as w,Q as oe,R as se,p as ie,e as de,q as ce,B as D,a as k}from"./vendor-BkBzn7Rm.js";import{r as pe,B as ue,G as W,A as he}from"./App-CN7_cQW_.js";import{E as me,D as ye}from"./Edit-eKb4YKV3.js";import{d as ve,G as fe}from"./GlassDialog-D3L0KGqR.js";import{L as xe}from"./LoadingButton-BIl3f8Bp.js";import{A as ge}from"./Add-4GSdkR1s.js";var R={},be=Q;Object.defineProperty(R,"__esModule",{value:!0});var G=R.default=void 0,Se=be(pe()),we=X;G=R.default=(0,Se.default)((0,we.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonChecked");const Ce=({allLeaves:g,allUsers:i})=>{const v=M();return e(ee,{style:{maxHeight:"84vh",overflowY:"auto"},children:t(Z,{"aria-label":"leave employee table",children:[e($,{children:t(E,{children:[e(n,{sx:{whiteSpace:"nowrap"},children:"Leave Type"}),e(n,{sx:{whiteSpace:"nowrap"},children:"From"}),e(n,{sx:{whiteSpace:"nowrap"},children:"To"}),e(n,{sx:{whiteSpace:"nowrap"},children:"No of Days"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Reason"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Status"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Approved by"}),e(n,{sx:{whiteSpace:"nowrap"},align:"center",children:"Actions"})]})}),e(z,{children:g.map(r=>t(E,{children:[e(n,{sx:{whiteSpace:"nowrap"},children:r.leave_type}),e(n,{sx:{whiteSpace:"nowrap"},children:new Date(r.from_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(n,{sx:{whiteSpace:"nowrap"},children:new Date(r.to_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(n,{sx:{whiteSpace:"nowrap"},children:r.no_of_days}),e(n,{sx:{whiteSpace:"nowrap"},children:r.reason}),e(n,{sx:{whiteSpace:"nowrap"},children:t(O,{variant:"outlined",color:"primary",sx:{borderRadius:"50px"},children:[e(G,{})," ",r.status]})}),e(n,{sx:{whiteSpace:"nowrap"},children:r.approved_by?t(C,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(U,{src:i.find(l=>l.id===r.approved_by).avatar,alt:i.find(l=>l.id===r.approved_by).name}),e(C,{sx:{marginLeft:"10px"},children:e(V,{href:"#",sx:{textDecoration:"none",color:v.palette.text.primary,fontWeight:"bold"},children:i.find(l=>l.id===r.approved_by).name})})]}):null}),t(n,{sx:{whiteSpace:"nowrap"},align:"center",children:[e(_,{href:"#",onClick:()=>{},children:e(me,{})}),e(_,{href:"#",onClick:()=>{},children:e(ye,{})})]})]},r.id))})]})})},De=({open:g,closeModal:i,leaveTypes:v,leaveCounts:r,setLeavesData:l})=>{const[h,T]=o.useState("Casual"),[f,L]=o.useState(""),[b,m]=o.useState(""),[B,q]=o.useState(""),[N,H]=o.useState(""),[A,Y]=o.useState(""),[s,Te]=o.useState({}),[F,I]=o.useState(!1);o.useEffect(()=>{console.log(h);const a=r.find(x=>x.leave_type===h);console.log(a),H(a.remaining_days)},[h]),o.useEffect(()=>{q(((x,u)=>{if(!x||!u)return"";const y=new Date(x),c=new Date(u);if(y>c)return"";const S=c.getTime()-y.getTime();return Math.ceil(S/(1e3*3600*24))})(f,b))},[f,b]);const d=M();return t(fe,{open:g,onClose:i,fullWidth:!0,maxWidth:"sm",children:[t(ae,{sx:{display:"flex",alignItems:"center"},children:[e(C,{variant:"h6",children:"Add Leave"}),e(_,{onClick:i,sx:{position:"absolute",top:8,right:16},children:e(ve,{})})]}),t("form",{onSubmit:async a=>{a.preventDefault(),I(!0);const x=new Promise(async(u,y)=>{try{const c=await fetch("/leave-add",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({leaveType:h,fromDate:f,toDate:b,daysCount:B,leaveReason:A})}),S=await c.json();c.ok?(l(S.leavesData),u([S.message||"Leave application submitted successfully"]),i()):y(S.error||"Failed to submit leave application")}catch(c){y(c.message||"An unexpected error occurred.")}finally{I(!1)}});ue.promise(x,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(ie,{}),e("span",{style:{marginLeft:"8px"},children:"Submitting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:d.glassCard.backgroundColor,border:d.glassCard.border,color:d.palette.text.primary}},success:{render({data:u}){return e(j,{children:u.map((y,c)=>e("div",{children:y},c))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:d.glassCard.backgroundColor,border:d.glassCard.border,color:d.palette.text.primary}},error:{render({data:u}){return e(j,{children:u})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:d.glassCard.backgroundColor,border:d.glassCard.border,color:d.palette.text.primary}}})},children:[e(oe,{children:t(p,{container:!0,spacing:2,children:[e(p,{item:!0,xs:12,md:6,children:t(te,{fullWidth:!0,children:[e(re,{id:"leave-type-label",children:"Leave Type"}),t(ne,{labelId:"leave-type-label",value:h,onChange:a=>T(a.target.value),label:"Leave Type",error:!!s.leaveType,children:[e(P,{value:"",disabled:!0,children:"Select Leave Type"}),v.map(a=>t(P,{value:a.type,children:[a.type," ",a.days," Days"]},a.id))]}),e(le,{children:s.leaveType})]})}),e(p,{item:!0,xs:12,md:6,children:e(w,{label:"From",type:"date",fullWidth:!0,value:f,onChange:a=>L(a.target.value),InputLabelProps:{shrink:!0},error:!!s.fromDate,helperText:s.fromDate})}),e(p,{item:!0,xs:12,md:6,children:e(w,{label:"To",type:"date",fullWidth:!0,value:b,onChange:a=>m(a.target.value),InputLabelProps:{shrink:!0},error:!!s.toDate,helperText:s.toDate})}),e(p,{item:!0,xs:12,md:6,children:e(w,{label:"Number of days",type:"text",fullWidth:!0,value:B,InputProps:{readOnly:!0},error:!!s.daysCount,helperText:s.daysCount})}),e(p,{item:!0,xs:12,md:6,children:e(w,{label:"Remaining Leaves",type:"text",fullWidth:!0,value:N,InputProps:{readOnly:!0},error:!!s.remainingLeaves,helperText:s.remainingLeaves})}),e(p,{item:!0,xs:12,children:e(w,{label:"Leave Reason",multiline:!0,rows:4,fullWidth:!0,value:A,onChange:a=>Y(a.target.value),error:!!s.leaveReason,helperText:s.leaveReason})})]})}),e(se,{sx:{padding:"16px",justifyContent:"center"},children:e(xe,{type:"submit",variant:"outlined",color:"primary",loading:F,disabled:F,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},Ee=({title:g,allUsers:i})=>{const[v,r]=o.useState(null),[l,h]=o.useState(J().props.leavesData),[T,f]=o.useState(l.allLeaves);o.useEffect(()=>{f(l.allLeaves)},[l]),console.log(l);const L=m=>{r(m)};return t(he,{children:[e(K,{title:g}),v==="leave"&&e(De,{open:v==="leave",setLeavesData:h,closeModal:()=>{r(null)},leaveTypes:l.leaveTypes,leaveCounts:l.leaveCounts}),e(D,{sx:{display:"flex",justifyContent:"center",p:2},children:e(de,{in:!0,children:t(W,{children:[e(ce,{title:"Leaves",sx:{padding:"24px"},action:e(D,{display:"flex",gap:2,children:e(O,{title:"Add Leave",variant:"outlined",color:"success",startIcon:e(ge,{}),onClick:()=>L("leave"),children:"Add Leave"})})}),e(k,{children:e(p,{container:!0,spacing:2,children:l.leaveCounts.map(m=>e(p,{item:!0,xs:12,sm:6,md:3,children:e(W,{children:e(k,{children:e(D,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",children:t(D,{children:[e(C,{variant:"h6",children:m.leave_type}),e(C,{variant:"h4",children:m.days_used})]})})})})},m.leave_type))})}),e(k,{children:e(Ce,{allLeaves:T,allUsers:i})})]})})})]})};export{Ee as default};
