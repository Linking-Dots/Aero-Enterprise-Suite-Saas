import{j as e,r as k,a as m,Y as _}from"./app-DNLNCuBz.js";import{n as B,u as L,t as M,T as O,M as g,I as f,v as H,w as v,A as z,B as E,c as G,d as J,b as U}from"./App-DkLwtiQt.js";import{G as $}from"./GlassCard-DZe_XPno.js";import{T as q,a as K,b as V,c as A,d as n,e as W}from"./TableRow-DCMn7Bni.js";import{F as T,I as F,S as D}from"./Select-BHCIVLGQ.js";import{E as X,D as Y}from"./Edit-D8v0z1fC.js";import{C as I}from"./CircularProgress-CodlnZbc.js";import{C as Q}from"./CardHeader-D0yuMQlG.js";const Z=B(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),ee=({allUsers:b,departments:u,designations:c})=>{const[j,y]=k.useState(b),s=L(),[re,N]=k.useState({});async function w(r,l,a){const d=new Promise(async(t,i)=>{try{const o=a.target.value,p=await fetch(route("profile.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:l,[r]:o})}),x=await p.json();p.ok?(y(R=>R.map(h=>{if(h.id===l){const C={...h};return r==="department"&&h.department!==o&&(C.designation=null),C[r]=o,C}return h})),t([...x.messages]),console.log(x.messages)):(i(x.messages),console.error(x.messages))}catch(o){console.log(o),i(["An unexpected error occurred."])}});v.promise(d,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(I,{}),e.jsxs("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}},success:{render({data:t}){return e.jsx(e.Fragment,{children:t.map((i,o)=>e.jsx("div",{children:i},o))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}},error:{render({data:t}){return e.jsx(e.Fragment,{children:t.map((i,o)=>e.jsx("div",{children:i},o))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}}})}const P=async r=>{const l=new Promise(async(a,d)=>{try{const t=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),i=await t.json();t.ok?(y(o=>o.filter(p=>p.id!==r)),a([i.message])):d([i.message])}catch(t){console.error("Error deleting user:",t),d(["An error occurred while deleting user. Please try again."])}});v.promise(l,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(I,{}),e.jsx("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}},success:{render({data:a}){return e.jsx(e.Fragment,{children:a.map((d,t)=>e.jsx("div",{children:d},t))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}},error:{render({data:a}){return e.jsx(e.Fragment,{children:a.map((d,t)=>e.jsx("div",{children:d},t))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}}})},S=r=>{N(l=>({...l,[r]:null}))};return e.jsx(q,{style:{maxHeight:"70vh",overflowY:"auto"},children:e.jsxs(K,{"aria-label":"employee table",children:[e.jsx(V,{children:e.jsxs(A,{children:[e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Employee ID"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Name"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Email"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Mobile"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Join Date"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Department"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:"Role"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},align:"right",children:"Action"})]})}),e.jsx(W,{children:j.map(r=>{var l;return e.jsxs(A,{children:[e.jsx(n,{sx:{whiteSpace:"nowrap"},children:r.employee_id||"N/A"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e.jsx(M,{src:`assets/images/users/${r.user_name}.jpg`,alt:r.first_name}),e.jsxs(O,{sx:{marginLeft:"10px"},children:[e.jsx(m,{sx:{textDecoration:"none"},href:route("profile",{user:r.id}),children:r.name||"N/A"}),e.jsx("br",{}),((l=c.find(a=>a.id===r.designation))==null?void 0:l.title)||"N/A"]})]}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:r.phone||"N/A"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:r.email||"N/A"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:r.date_of_joining||"N/A"}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:e.jsxs(T,{size:"small",fullWidth:!0,children:[e.jsx(F,{id:"department",children:"Department"}),e.jsxs(D,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:a=>w("department",r.id,a),label:"Department",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e.jsx(g,{value:"na",disabled:!0,children:"Select Department"}),u.map(a=>e.jsx(g,{value:a.id,children:a.name},a.id))]})]})}),e.jsx(n,{sx:{whiteSpace:"nowrap"},children:e.jsxs(T,{size:"small",fullWidth:!0,children:[e.jsx(F,{id:"designation",children:"Designation"}),e.jsxs(D,{labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:a=>w("designation",r.id,a),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e.jsx(g,{value:"na",disabled:!0,children:"Select Designation"}),c.filter(a=>a.department_id===r.department).map(a=>e.jsx(g,{value:a.id,children:a.title},a.id))]})]})}),e.jsxs(n,{sx:{whiteSpace:"nowrap"},align:"right",children:[e.jsx(f,{component:m,href:route("profile",{user:r.id}),onClick:()=>{S(r.id)},children:e.jsx(H,{})}),e.jsx(f,{component:m,href:route("profile",{user:r.id}),onClick:()=>{S(r.id)},children:e.jsx(X,{})}),e.jsxs(f,{component:m,href:route("profile",{user:r.id}),onClick:()=>{P(r.id)},children:[e.jsx(Y,{})," "]})]})]},r.id)})})]})})},ce=({title:b,allUsers:u,departments:c,designations:j})=>e.jsxs(z,{children:[e.jsx(_,{title:b}),e.jsx(E,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(G,{in:!0,children:e.jsxs($,{children:[e.jsx(Q,{title:"Employees",sx:{padding:"24px"},action:e.jsx(E,{display:"flex",gap:2,children:e.jsx(J,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e.jsx(Z,{}),children:"Add Employee"})})}),e.jsx(U,{children:e.jsx(ee,{allUsers:u,departments:c,designations:j})})]})})})]});export{ce as default};
