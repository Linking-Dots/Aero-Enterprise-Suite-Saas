import{V as nt,j as b,a,F as N,c as ar,M as ot}from"./app-CVTKC_2W.js";import{v as $e,w as oe,z as we,H as it,u as ve,ac as lt,t as ye,X as st,B as J,R as Re,b as ct,c as pe,r as u,W as Be,T as Se,G as Y,Y as Ne,Z as Ve,$ as dt,f as vr,m as ut,n as pt,o as xr,p as We,q as ft,a1 as mt,ah as w,g as gt,e as ht,h as bt,a as Cr}from"./vendor-TQEDv41K.js";import{r as Ae,F as yt,c as vt,B as ne,b as de,_ as xe,H as Ce,I as Dr,J as kr,G as xt,A as Ct}from"./App-DwdJgFxS.js";import{X as Dt,m as kt,A as _r}from"./minMax-Bi6xZslU.js";import{d as _t}from"./Delete-BMbsJmef.js";import{U as nr}from"./index-BPYJgbp_.js";import{l as Sr}from"./chunk-FGDGYNYV-BCfvPvKW.js";import{l as U,s as fe}from"./chunk-QEQ4EHOG-6kRY1WZA.js";import{u as er}from"./chunk-TLBGAR4N-BpoV9KAb.js";import{i as X}from"./chunk-IR2E3HZF-DkmptgH8.js";import{d as St}from"./dayjs.min-CEI8migf.js";import{d as ur,G as Ke}from"./GlassDialog-CPolmUVO.js";import{u as rr,w as Ft}from"./xlsx-DjuO7_Ju.js";import{L as Rr}from"./LoadingButton-DIfkXEVD.js";import{D as or}from"./Download-BLZ3CQUw.js";import{d as wt,p as At}from"./Search-Bq9Tw6Xp.js";import{C as It}from"./Clear-CujA7pR_.js";import"./DOMLayoutDelegate-BFh3-o5P.js";import"./useLabel-m5PTMAQU.js";import"./chunk-NCVCYSZZ-CVji088-.js";import"./useFormValidationState-4-POXV-D.js";const Et=$e(oe.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),Ot=$e(oe.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),Tt=$e(oe.jsx("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"}),"InsertDriveFile"),Pt=$e(oe.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf");var pr={},jt=we;Object.defineProperty(pr,"__esModule",{value:!0});var Lr=pr.default=void 0,Wt=jt(Ae()),zt=oe;Lr=pr.default=(0,Wt.default)((0,zt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle");var fr={},Rt=we;Object.defineProperty(fr,"__esModule",{value:!0});var Mr=fr.default=void 0,Lt=Rt(Ae()),Mt=oe;Mr=fr.default=(0,Lt.default)((0,Mt.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2M8.5 15H7.3l-2.55-3.5V15H3.5V9h1.25l2.5 3.5V9H8.5zm5-4.74H11v1.12h2.5v1.26H11v1.11h2.5V15h-4V9h4zm7 3.74c0 .55-.45 1-1 1h-4c-.55 0-1-.45-1-1V9h1.25v4.51h1.13V9.99h1.25v3.51h1.12V9h1.25z"}),"FiberNew");var mr={},Ht=we;Object.defineProperty(mr,"__esModule",{value:!0});var Hr=mr.default=void 0,$t=Ht(Ae()),Bt=oe;Hr=mr.default=(0,$t.default)((0,Bt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");var gr={},Nt=we;Object.defineProperty(gr,"__esModule",{value:!0});var $r=gr.default=void 0,Vt=Nt(Ae()),Kt=oe;$r=gr.default=(0,Vt.default)((0,Kt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");var hr={},Ut=we;Object.defineProperty(hr,"__esModule",{value:!0});var Br=hr.default=void 0,qt=Ut(Ae()),Yt=oe;Br=hr.default=(0,qt.default)((0,Yt.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m-2 14-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"AssignmentTurnedIn");const Gt=it(Dt)(({theme:e})=>({"& .rdt_Table":{backgroundColor:"transparent","& .rdt_TableHead":{"& .rdt_TableHeadRow":{backgroundColor:"transparent",color:e.palette.text.primary},top:0,zIndex:1},"& .rdt_TableBody":{overflowY:"auto",maxHeight:"52vh","& .rdt_TableRow":{minHeight:"auto",backgroundColor:"transparent",color:e.palette.text.primary,"& .rdt_TableCol":{backgroundColor:"transparent",borderBottom:`1px solid ${e.palette.divider}`,width:"auto",whiteSpace:"nowrap"}},"& .rdt_TableRow:hover":{backgroundColor:e.palette.action.hover}}}})),Qt=({allData:e,setData:r,loading:t,handleClickOpen:n,allInCharges:i,reports:s,juniors:d,reports_with_daily_works:g,openModal:f,setCurrentRow:D,filteredData:S,setFilteredData:v})=>{const{auth:E}=nt().props,y=ve(),A=E.roles.includes("Administrator"),q=E.roles.includes("Supervision Engineer"),O=[{value:"new",label:"New",icon:a(Mr,{})},{value:"resubmission",label:"Resubmission",icon:a(Hr,{})},{value:"completed",label:"Completed",icon:a(Lr,{})},{value:"emergency",label:"Emergency",icon:a($r,{})}],P=[{name:"Date",selector:o=>o.date,sortable:"true",center:"true",width:"110px"},{name:"RFI NO",selector:o=>o.number,sortable:"true",center:"true",width:"160px",cell:o=>b(N,{children:[o.status==="completed"&&o.file?a(Sr,{isExternal:!0,isBlock:!0,showAnchorIcon:!0,anchorIcon:a(Br,{}),href:o.file,color:"success",size:"sm",children:o.number}):o.status==="completed"&&!o.file?a(Sr,{isBlock:!0,showAnchorIcon:!0,anchorIcon:a(yt,{}),href:"#",color:"danger",size:"sm",onClick:async c=>{c.preventDefault();const p=await x();p&&await C(o.id,p)},children:o.number}):o.number,o.reports&&o.reports.map(c=>a("div",{children:b("span",{children:[a("i",{className:"mdi mdi-circle-medium"})," ",c.ref_no]})},c.ref_no))]})},{name:"Status",selector:o=>o.status,sortable:"true",center:"true",width:"220px",style:{padding:"0px 10px 0px 10px"},cell:o=>a(fe,{items:O,"aria-label":"Status",fullWidth:!0,value:o.status||"na",onChange:c=>I(o.id,"status",c.target.value),selectedKeys:[String(o.status)],style:{minWidth:"220px"},color:W(o.status),popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"},style:{whiteSpace:"nowrap",minWidth:"fit-content"}},placeholder:"Select Status",renderValue:c=>c.map(p=>{var _;return b("div",{className:"flex items-center gap-2 m-1",children:[(_=O.find(k=>k.value===p.data.value))==null?void 0:_.icon," ",a("span",{children:p.data.label})]},p.key)}),children:c=>a(U,{textValue:c.value,children:b("div",{className:"flex items-center gap-2",children:[c.icon," ",b("span",{style:{color:W(c.value)},children:[c.label," "]})]})},c.value)})},...q?[{name:"Assigned",selector:o=>o.assigned,sortable:"true",center:"true",cell:o=>a(fe,{items:d,variant:"underlined","aria-label":"Assigned",fullWidth:!0,size:"small",value:o.assigned||"na",style:{minWidth:"260px"},onChange:c=>I(o.id,"assigned",c.target.value),popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"},style:{whiteSpace:"nowrap",minWidth:"fit-content"}},placeholder:"Select a junior",selectedKeys:[String(o.assigned||"")],renderValue:c=>c.map(p=>a("div",{className:"flex items-center gap-2 m-1",children:a(er,{style:{whiteSpace:"nowrap"},size:"sm",name:p.data.name,avatarProps:{radius:"sm",size:"sm",src:p.data.profile_image}})},p.key)),children:c=>a(U,{textValue:c.id,children:b(J,{sx:{display:"flex"},children:[a(st,{src:c.profile_image,alt:c.name||"Not assigned",sx:{borderRadius:"50%",width:23,height:23,display:"flex",marginRight:1}}),c.name]})},c.id)})}]:[],{name:"Type",selector:o=>o.type,sortable:"true",center:"true",width:"140px"},{name:"Description",selector:o=>o.description,sortable:"true",left:"true",width:"260px",cell:o=>a(J,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:o.description})},{name:"Location",selector:o=>o.location,sortable:"true",center:"true",width:"200px",cell:o=>a(J,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:o.location})},{name:"Results",selector:o=>o.inspection_details,sortable:"true",width:"200px",center:"true",cell:o=>{const[c,p]=Re.useState(!1),[_,k]=Re.useState(o.inspection_details||"");return a(J,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",cursor:"pointer"},onClick:c?void 0:()=>{p(!0)},children:c?a(ct,{fullWidth:!0,value:_,onChange:F=>{k(F.target.value)},onBlur:()=>{p(!1),I(o.id,"inspection_details",_)},autoFocus:!0,variant:"standard",InputProps:{style:{marginBottom:0,border:"none",outline:"none",backgroundColor:"transparent",textAlign:"center"}}}):a(N,{children:o.inspection_details||"N/A"})})}},{name:"Road Type",selector:o=>o.side,sortable:"true",center:"true",width:"120px"},{name:"Quantity/Layer No.",selector:o=>o.qty_layer,sortable:"true",center:"true",width:"150px"},...A?[{name:"In charge",selector:o=>o.incharge,sortable:"true",center:"true",cell:o=>a(fe,{items:i,variant:"underlined","aria-label":"Incharge",fullWidth:!0,value:o.incharge||"na",onChange:c=>I(o.id,"incharge",c.target.value),selectedKeys:[String(o.incharge)],style:{minWidth:"260px"},popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"},style:{whiteSpace:"nowrap",minWidth:"fit-content"}},placeholder:"Select Incharge",renderValue:c=>c.map(p=>a("div",{className:"flex items-center gap-2 m-1",children:a(er,{style:{whiteSpace:"nowrap"},size:"sm",name:p.data.name,avatarProps:{radius:"sm",size:"sm",src:p.data.profile_image}})},p.key)),children:c=>{var p;return a(U,{textValue:c.id,children:a(er,{style:{whiteSpace:"nowrap"},size:"sm",name:c.name,description:((p=c.designation)==null?void 0:p.title)||"Incharge",avatarProps:{radius:"sm",size:"sm",src:c.profile_image}})},c.id)}})}]:[],{name:"Planned Time",selector:o=>o.planned_time,sortable:"true",center:"true",width:"130px"},{name:"Completion Time",selector:o=>o.completion_time,sortable:"true",center:"true",width:"250px",cell:o=>a(X,{fullWidth:!0,size:"sm",variant:"underlined",type:"datetime-local",value:o.completion_time?new Date(o.completion_time).toISOString().slice(0,16):"",onChange:c=>I(o.id,"completion_time",c.target.value),inputProps:{placeholder:"YYYY-MM-DDTHH:MM"}})},{name:"Resubmission Count",selector:o=>o.resubmission_count,sortable:"true",center:"true",width:"160px",cell:o=>a(N,{children:o.resubmission_count?`${o.resubmission_count} ${o.resubmission_count>1?"times":"time"}`:""})},...A?[{name:"RFI Submission Date",selector:o=>o.rfi_submission_date,sortable:"true",center:"true",width:"180px",cell:o=>a(X,{fullWidth:!0,size:"sm",type:"date",variant:"underlined",onChange:c=>I(o.id,"rfi_submission_date",c.target.value),value:o.rfi_submission_date?new Date(o.rfi_submission_date).toISOString().slice(0,10):"",style:{border:"none",outline:"none",backgroundColor:"transparent"},inputProps:{placeholder:"yyyy-MM-dd"}})}]:[],...A?[{name:"Actions",center:"true",width:"150px",cell:o=>b(J,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[a(pe,{sx:{m:1},variant:"outlined",color:"success",size:"small",onClick:()=>{D(o),f("editDailyWork")},children:a(vt,{})}),a(pe,{sx:{m:1},variant:"outlined",color:"error",size:"small",onClick:()=>n(o.id,"deleteDailyWork"),children:a(_t,{})})]})}]:[]],W=o=>{switch(o){case"new":return"primary";case"resubmission":return"warning";case"completed":return"success";case"emergency":return"danger";default:return""}},x=()=>new Promise((o,c)=>{const p=document.createElement("input");p.type="file",p.accept="image/*",p.capture="camera",document.body.appendChild(p),p.onchange=async()=>{const _=p.files[0];if(_){const k=new Image;k.src=URL.createObjectURL(_),k.onload=()=>{const V=1024*(k.width/k.height),F=document.createElement("canvas");F.width=V,F.height=1024,F.getContext("2d").drawImage(k,0,0,V,1024),F.toBlob(le=>{if(le){const me=new File([le],"resized_task_completion.jpg",{type:"image/jpeg"});o(me)}else c(new Error("Image resizing failed"));URL.revokeObjectURL(k.src),document.body.removeChild(p)},"image/jpeg")},k.onerror=()=>{c(new Error("Failed to load image")),document.body.removeChild(p)}}else c(new Error("No file selected")),document.body.removeChild(p)},p.click()}),C=async(o,c)=>{const p=new Promise(async(_,k)=>{try{const z=new FormData;z.append("taskId",o),z.append("file",c);const L=await ar.post(route("dailyWorks.uploadRFI"),z,{headers:{"Content-Type":"multipart/form-data"}});L.status===200&&(r(V=>V.map(F=>F.id===o?{...F,file:L.data.url}:F)),_([L.data.message||"RFI file uploaded successfully"]),console.log(L.data.message?[L.data.message]:L.data.messages))}catch(z){console.error(z),k(z.response.statusText||"Failed to upload RFI file")}});ne.promise(p,{pending:{render(){return b("div",{style:{display:"flex",alignItems:"center"},children:[a(ye,{}),a("span",{style:{marginLeft:"8px"},children:"Uploading RFI file..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}},success:{render({data:_}){return a(N,{children:_.map((k,z)=>a("div",{children:k},z))})},icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}},error:{render({data:_}){return a(N,{children:_})},icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}}})},I=async(o,c,p)=>{var _,k;try{if(c==="status"&&p==="completed"){const L=await x();L&&await C(o,L)}const z=await ar.post(route("dailyWorks.update"),{id:o,[c]:p});z.status===200?(r(L=>L.map(V=>V.id===o?{...V,[c]:p}:V)),ne.success(...z.data.messages||"Task updated successfully",{icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}})):ne.error(z.data.error||`Failed to update task ${[c]}.`,{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}})}catch(z){ne.error(((k=(_=z.response)==null?void 0:_.data)==null?void 0:k.message)||"An unexpected error occurred.",{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}})}};return b("div",{children:[a(lt,{styles:{"& .cgTKyH":{backgroundColor:"transparent !important",color:y.palette.text.primary}}}),a(Gt,{classNames:{base:"max-h-[84vh] overflow-scroll",table:"min-h-[84vh]"},columns:P,data:e,loading:t,loadingComponent:a(ye,{}),defaultSortField:"date",highlightOnHover:!0,responsive:!0,dense:!0})]})},Fr=({open:e,closeModal:r,currentRow:t,setData:n,modalType:i})=>{const s=ve(),[d,g]=u.useState({id:(t==null?void 0:t.id)||"",date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],number:(t==null?void 0:t.number)||"",planned_time:(t==null?void 0:t.planned_time)||"",type:(t==null?void 0:t.type)||"Structure",location:(t==null?void 0:t.location)||"",description:(t==null?void 0:t.description)||"",side:(t==null?void 0:t.side)||"SR-R",qty_layer:(t==null?void 0:t.qty_layer)||""}),[f,D]=u.useState({}),[S,v]=u.useState(!1),[E,y]=u.useState(!1);u.useEffect(()=>{const O=Object.values(d).some(P=>P!=="");y(O)},[d]);const A=O=>{const{name:P,value:W}=O.target;g(x=>({...x,[P]:W})),y(!0)};async function q(O){O.preventDefault(),v(!0);const P=new Promise(async(W,x)=>{try{const C=await axios.post(route(`dailyWorks.${i}`),{ruleSet:"details",...d});console.log(C),C.status===200&&(n(I=>I.map(o=>o.id===d.id?{...o,...d}:o)),r(),W(C.data.message?[C.data.message]:C.data.messages),v(!1),r(),console.log(C.data.message?[C.data.message]:C.data.messages))}catch(C){v(!1),console.error(C),x(["An unexpected error occurred."])}});ne.promise(P,{pending:{render(){return b("div",{style:{display:"flex",alignItems:"center"},children:[a(ye,{}),a("span",{style:{marginLeft:"8px"},children:"Updating daily work ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}},success:{render({data:W}){return a(N,{children:W.map((x,C)=>a("div",{children:x},C))})},icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}},error:{render({data:W}){return a(N,{children:W.map((x,C)=>a("div",{children:x},C))})},icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}}})}return b(Ke,{open:e,onClose:r,children:[b(Be,{style:{cursor:"move"},id:"draggable-dialog-title",children:[a(Se,{children:"Add Task"}),a(pe,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16},children:a(ur,{})})]}),b("form",{onSubmit:q,children:[a(Ne,{children:b(Y,{container:!0,spacing:2,children:[a(Y,{item:!0,xs:12,md:6,children:a(X,{variant:"underlined",label:"RFI Date",type:"date",name:"date",fullWidth:!0,value:d.date,onChange:A,isInvalid:!!f.date,errorMessage:f.date})}),a(Y,{item:!0,xs:12,md:6,children:a(X,{variant:"underlined",label:"RFI Number",name:"number",fullWidth:!0,value:d.number,onChange:A,isInvalid:!!f.number,errorMessage:f.number})}),a(Y,{item:!0,xs:12,md:6,children:a(X,{variant:"underlined",label:"Planned Time",name:"planned_time",fullWidth:!0,value:d.planned_time,onChange:A,isInvalid:!!f.planned_time,errorMessage:f.planned_time})}),a(Y,{item:!0,xs:12,md:6,children:b(fe,{variant:"underlined",label:"Type",name:"type",fullWidth:!0,value:d.type,isInvalid:!!f.type,errorMessage:f.type,labelId:"type-label",selectedKeys:[d.type],popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"}},children:[a(U,{value:"Structure",children:"Structure"},"Structure"),a(U,{value:"Embankment",children:"Embankment"},"Embankment"),a(U,{value:"Pavement",children:"Pavement"},"Pavement")]})}),a(Y,{item:!0,xs:12,md:6,children:a(X,{variant:"underlined",label:"Location",name:"location",fullWidth:!0,value:d.location,onChange:A,isInvalid:!!f.location,errorMessage:f.location})}),a(Y,{item:!0,xs:12,md:6,children:a(X,{variant:"underlined",label:"Description",name:"description",fullWidth:!0,value:d.description,onChange:A,isInvalid:!!f.description,errorMessage:f.description})}),a(Y,{item:!0,xs:12,md:6,children:b(fe,{variant:"underlined",select:"true",label:"Road Type",name:"side",fullWidth:!0,value:d.side,onChange:A,isInvalid:!!f.side,errorMessage:f.side,selectedKeys:[d.side],popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"}},children:[a(U,{value:"SR-R",children:"SR-R"},"SR-R"),a(U,{value:"SR-L",children:"SR-L"},"SR-L"),a(U,{value:"TR-R",children:"TR-R"},"TR-R"),a(U,{value:"TR-L",children:"TR-L"},"TR-L")]})}),a(Y,{item:!0,xs:12,md:6,children:a(X,{variant:"underlined",label:"Quantity/Layer No.",name:"qty_layer",fullWidth:!0,value:d.qty_layer,onChange:A,isInvalid:!!f.qty_layer,errorMessage:f.qty_layer})})]})}),a(Ve,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"16px"},children:a(de,{disabled:!E,radius:"lg",variant:"bordered",color:"primary",type:"submit",isLoading:S,children:"Submit"})})]})]})},Xt=({open:e,handleClose:r,handleDelete:t})=>(ve(),b(Ke,{open:e,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[a(Be,{id:"alert-dialog-title",children:"Confirm Deletion"}),a(Ne,{children:a(dt,{id:"alert-dialog-description",children:"Are you sure you want to delete this task? This action cannot be undone."})}),b(Ve,{children:[a(vr,{onClick:r,color:"primary",children:"Cancel"}),a(vr,{onClick:t,color:"error",autoFocus:!0,children:"Delete"})]})]})),Jt=({open:e,closeModal:r,data:t,users:n})=>{u.useState(!1);const i=ve(),s=[{label:"Date",key:"date"},{label:"RFI No.",key:"number"},{label:"Status",key:"status"},{label:"Assigned",key:"assigned"},{label:"In charge",key:"incharge"},{label:"Type",key:"type"},{label:"Description",key:"description"},{label:"Location",key:"location"},{label:"Side",key:"side"},{label:"Quantity/Layer",key:"qty_layer"},{label:"Planned Time",key:"planned_time"},{label:"Completion Time",key:"completion_time"},{label:"Results",key:"inspection_details"},{label:"Resubmission Count",key:"resubmission_count"},{label:"RFI Submission Date",key:"rfi_submission_date"}],[d,g]=u.useState(s.map(S=>({...S,checked:!0}))),f=S=>{const v=[...d];v[S].checked=!v[S].checked,g(v)},D=async S=>{const v=new Promise((E,y)=>{try{const A=t.map(P=>{const W={};return S.forEach(x=>{if(x.checked)if(x.key==="incharge"||x.key==="assigned"){const C=n.find(I=>I.id===P[x.key]);W[x.label]=C?C.name:"N/A"}else if(x.key==="status"){const C=P[x.key];W[x.label]=C.charAt(0).toUpperCase()+C.slice(1)}else W[x.label]=P[x.key]}),W}),q=rr.json_to_sheet(A),O=rr.book_new();rr.book_append_sheet(O,q,"Daily Works"),Ft(O,"DailyWorks.xlsx"),E("Export successful!"),r()}catch(A){y("Failed to export data. Please try again."),console.error("Error exporting data to Excel:",A)}});ne.promise(v,{pending:{render(){return b("div",{style:{display:"flex",alignItems:"center"},children:[a(ye,{}),a("span",{style:{marginLeft:"8px"},children:"Exporting data to Excel ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:i.glassCard.backgroundColor,border:i.glassCard.border,color:i.palette.text.primary}},success:{render({data:E}){return a(N,{children:E})},icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:i.glassCard.backgroundColor,border:i.glassCard.border,color:i.palette.text.primary}},error:{render({data:E}){return a(N,{children:E})},icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:i.glassCard.backgroundColor,border:i.glassCard.border,color:i.palette.text.primary}}})};return b(Ke,{open:e,onClose:r,children:[b(Be,{style:{cursor:"move"},id:"draggable-dialog-title",children:[a(Se,{children:"Export Daily Works"}),a(pe,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16},children:a(ur,{})})]}),a(Ne,{children:b(ut,{size:"small",sx:{"& .MuiTableCell-root":{padding:"4px 8px"},"& .MuiCheckbox-root":{padding:"0px"}},children:[a(pt,{children:b(xr,{children:[a(We,{children:"Column Label"}),a(We,{align:"center",children:"Include in Export"})]})}),a(ft,{children:d.map((S,v)=>b(xr,{children:[a(We,{children:S.label}),a(We,{align:"center",children:a(mt,{checked:S.checked,onChange:()=>f(v)})})]},S.key))})]})}),a(Ve,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:a(Rr,{sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",onClick:()=>D(d),startIcon:a(or,{}),children:"Download"})})]})};var Zt=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Ie(e,r){var t=ea(e);if(typeof t.path!="string"){var n=e.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof r=="string"?r:typeof n=="string"&&n.length>0?n:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function ea(e){var r=e.name,t=r&&r.lastIndexOf(".")!==-1;if(t&&!e.type){var n=r.split(".").pop().toLowerCase(),i=Zt.get(n);i&&Object.defineProperty(e,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return e}var ra=[".DS_Store","Thumbs.db"];function ta(e){return xe(this,void 0,void 0,function(){return Ce(this,function(r){return Le(e)&&aa(e.dataTransfer)?[2,la(e.dataTransfer,e.type)]:na(e)?[2,oa(e)]:Array.isArray(e)&&e.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,ia(e)]:[2,[]]})})}function aa(e){return Le(e)}function na(e){return Le(e)&&Le(e.target)}function Le(e){return typeof e=="object"&&e!==null}function oa(e){return ir(e.target.files).map(function(r){return Ie(r)})}function ia(e){return xe(this,void 0,void 0,function(){var r;return Ce(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(n){return n.getFile()}))];case 1:return r=t.sent(),[2,r.map(function(n){return Ie(n)})]}})})}function la(e,r){return xe(this,void 0,void 0,function(){var t,n;return Ce(this,function(i){switch(i.label){case 0:return e.items?(t=ir(e.items).filter(function(s){return s.kind==="file"}),r!=="drop"?[2,t]:[4,Promise.all(t.map(sa))]):[3,2];case 1:return n=i.sent(),[2,wr(Nr(n))];case 2:return[2,wr(ir(e.files).map(function(s){return Ie(s)}))]}})})}function wr(e){return e.filter(function(r){return ra.indexOf(r.name)===-1})}function ir(e){if(e===null)return[];for(var r=[],t=0;t<e.length;t++){var n=e[t];r.push(n)}return r}function sa(e){if(typeof e.webkitGetAsEntry!="function")return Ar(e);var r=e.webkitGetAsEntry();return r&&r.isDirectory?Vr(r):Ar(e)}function Nr(e){return e.reduce(function(r,t){return Dr(Dr([],kr(r),!1),kr(Array.isArray(t)?Nr(t):[t]),!1)},[])}function Ar(e){var r=e.getAsFile();if(!r)return Promise.reject("".concat(e," is not a File"));var t=Ie(r);return Promise.resolve(t)}function ca(e){return xe(this,void 0,void 0,function(){return Ce(this,function(r){return[2,e.isDirectory?Vr(e):da(e)]})})}function Vr(e){var r=e.createReader();return new Promise(function(t,n){var i=[];function s(){var d=this;r.readEntries(function(g){return xe(d,void 0,void 0,function(){var f,D,S;return Ce(this,function(v){switch(v.label){case 0:if(g.length)return[3,5];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return f=v.sent(),t(f),[3,4];case 3:return D=v.sent(),n(D),[3,4];case 4:return[3,6];case 5:S=Promise.all(g.map(ca)),i.push(S),s(),v.label=6;case 6:return[2]}})})},function(g){n(g)})}s()})}function da(e){return xe(this,void 0,void 0,function(){return Ce(this,function(r){return[2,new Promise(function(t,n){e.file(function(i){var s=Ie(i,e.fullPath);t(s)},function(i){n(i)})})]})})}var ua=function(e,r){if(e&&r){var t=Array.isArray(r)?r:r.split(","),n=e.name||"",i=(e.type||"").toLowerCase(),s=i.replace(/\/.*$/,"");return t.some(function(d){var g=d.trim().toLowerCase();return g.charAt(0)==="."?n.toLowerCase().endsWith(g):g.endsWith("/*")?s===g.replace(/\/.*$/,""):i===g})}return!0};function Ir(e){return ma(e)||fa(e)||Ur(e)||pa()}function pa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fa(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ma(e){if(Array.isArray(e))return lr(e)}function Er(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function Or(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Er(Object(t),!0).forEach(function(n){Kr(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Er(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Kr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Fe(e,r){return ba(e)||ha(e,r)||Ur(e,r)||ga()}function ga(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ur(e,r){if(e){if(typeof e=="string")return lr(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lr(e,r)}}function lr(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ha(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,d,g;try{for(t=t.call(e);!(i=(d=t.next()).done)&&(n.push(d.value),!(r&&n.length===r));i=!0);}catch(f){s=!0,g=f}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function ba(e){if(Array.isArray(e))return e}var ya="file-invalid-type",va="file-too-large",xa="file-too-small",Ca="too-many-files",Da=function(r){r=Array.isArray(r)&&r.length===1?r[0]:r;var t=Array.isArray(r)?"one of ".concat(r.join(", ")):r;return{code:ya,message:"File type must be ".concat(t)}},Tr=function(r){return{code:va,message:"File is larger than ".concat(r," ").concat(r===1?"byte":"bytes")}},Pr=function(r){return{code:xa,message:"File is smaller than ".concat(r," ").concat(r===1?"byte":"bytes")}},ka={code:Ca,message:"Too many files"};function qr(e,r){var t=e.type==="application/x-moz-file"||ua(e,r);return[t,t?null:Da(r)]}function Yr(e,r,t){if(ue(e.size))if(ue(r)&&ue(t)){if(e.size>t)return[!1,Tr(t)];if(e.size<r)return[!1,Pr(r)]}else{if(ue(r)&&e.size<r)return[!1,Pr(r)];if(ue(t)&&e.size>t)return[!1,Tr(t)]}return[!0,null]}function ue(e){return e!=null}function _a(e){var r=e.files,t=e.accept,n=e.minSize,i=e.maxSize,s=e.multiple,d=e.maxFiles,g=e.validator;return!s&&r.length>1||s&&d>=1&&r.length>d?!1:r.every(function(f){var D=qr(f,t),S=Fe(D,1),v=S[0],E=Yr(f,n,i),y=Fe(E,1),A=y[0],q=g?g(f):null;return v&&A&&!q})}function Me(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function ze(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(r){return r==="Files"||r==="application/x-moz-file"}):!!e.target&&!!e.target.files}function jr(e){e.preventDefault()}function Sa(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function Fa(e){return e.indexOf("Edge/")!==-1}function wa(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Sa(e)||Fa(e)}function ee(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(n){for(var i=arguments.length,s=new Array(i>1?i-1:0),d=1;d<i;d++)s[d-1]=arguments[d];return r.some(function(g){return!Me(n)&&g&&g.apply(void 0,[n].concat(s)),Me(n)})}}function Aa(){return"showOpenFilePicker"in window}function Ia(e){if(ue(e)){var r=Object.entries(e).filter(function(t){var n=Fe(t,2),i=n[0],s=n[1],d=!0;return Gr(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),d=!1),(!Array.isArray(s)||!s.every(Qr))&&(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),d=!1),d}).reduce(function(t,n){var i=Fe(n,2),s=i[0],d=i[1];return Or(Or({},t),{},Kr({},s,d))},{});return[{description:"Files",accept:r}]}return e}function Ea(e){if(ue(e))return Object.entries(e).reduce(function(r,t){var n=Fe(t,2),i=n[0],s=n[1];return[].concat(Ir(r),[i],Ir(s))},[]).filter(function(r){return Gr(r)||Qr(r)}).join(",")}function Oa(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function Ta(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Gr(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Qr(e){return/^.*\.[\w]+$/.test(e)}var Pa=["children"],ja=["open"],Wa=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],za=["refKey","onChange","onClick"];function Ra(e){return Ha(e)||Ma(e)||Xr(e)||La()}function La(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ma(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ha(e){if(Array.isArray(e))return sr(e)}function tr(e,r){return Na(e)||Ba(e,r)||Xr(e,r)||$a()}function $a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xr(e,r){if(e){if(typeof e=="string")return sr(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sr(e,r)}}function sr(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Ba(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,d,g;try{for(t=t.call(e);!(i=(d=t.next()).done)&&(n.push(d.value),!(r&&n.length===r));i=!0);}catch(f){s=!0,g=f}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw g}}return n}}function Na(e){if(Array.isArray(e))return e}function Wr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,n)}return t}function j(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Wr(Object(t),!0).forEach(function(n){cr(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Wr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function cr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function He(e,r){if(e==null)return{};var t=Va(e,r),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}function Va(e,r){if(e==null)return{};var t={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(r.indexOf(i)>=0)&&(t[i]=e[i]);return t}var br=u.forwardRef(function(e,r){var t=e.children,n=He(e,Pa),i=Zr(n),s=i.open,d=He(i,ja);return u.useImperativeHandle(r,function(){return{open:s}},[s]),Re.createElement(u.Fragment,null,t(j(j({},d),{},{open:s})))});br.displayName="Dropzone";var Jr={disabled:!1,getFilesFromEvent:ta,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};br.defaultProps=Jr;br.propTypes={children:w.func,accept:w.objectOf(w.arrayOf(w.string)),multiple:w.bool,preventDropOnDocument:w.bool,noClick:w.bool,noKeyboard:w.bool,noDrag:w.bool,noDragEventsBubbling:w.bool,minSize:w.number,maxSize:w.number,maxFiles:w.number,disabled:w.bool,getFilesFromEvent:w.func,onFileDialogCancel:w.func,onFileDialogOpen:w.func,useFsAccessApi:w.bool,autoFocus:w.bool,onDragEnter:w.func,onDragLeave:w.func,onDragOver:w.func,onDrop:w.func,onDropAccepted:w.func,onDropRejected:w.func,onError:w.func,validator:w.func};var dr={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Zr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=j(j({},Jr),e),t=r.accept,n=r.disabled,i=r.getFilesFromEvent,s=r.maxSize,d=r.minSize,g=r.multiple,f=r.maxFiles,D=r.onDragEnter,S=r.onDragLeave,v=r.onDragOver,E=r.onDrop,y=r.onDropAccepted,A=r.onDropRejected,q=r.onFileDialogCancel,O=r.onFileDialogOpen,P=r.useFsAccessApi,W=r.autoFocus,x=r.preventDropOnDocument,C=r.noClick,I=r.noKeyboard,o=r.noDrag,c=r.noDragEventsBubbling,p=r.onError,_=r.validator,k=u.useMemo(function(){return Ea(t)},[t]),z=u.useMemo(function(){return Ia(t)},[t]),L=u.useMemo(function(){return typeof O=="function"?O:zr},[O]),V=u.useMemo(function(){return typeof q=="function"?q:zr},[q]),F=u.useRef(null),H=u.useRef(null),le=u.useReducer(Ka,dr),me=tr(le,2),De=me[0],G=me[1],Ee=De.isFocused,Z=De.isFileDialogActive,re=u.useRef(typeof window<"u"&&window.isSecureContext&&P&&Aa()),T=function(){!re.current&&Z&&setTimeout(function(){if(H.current){var m=H.current.files;m.length||(G({type:"closeDialog"}),V())}},300)};u.useEffect(function(){return window.addEventListener("focus",T,!1),function(){window.removeEventListener("focus",T,!1)}},[H,Z,V,re]);var te=u.useRef([]),se=function(m){F.current&&F.current.contains(m.target)||(m.preventDefault(),te.current=[])};u.useEffect(function(){return x&&(document.addEventListener("dragover",jr,!1),document.addEventListener("drop",se,!1)),function(){x&&(document.removeEventListener("dragover",jr),document.removeEventListener("drop",se))}},[F,x]),u.useEffect(function(){return!n&&W&&F.current&&F.current.focus(),function(){}},[F,W,n]);var ae=u.useCallback(function(l){p?p(l):console.error(l)},[p]),ke=u.useCallback(function(l){l.preventDefault(),l.persist(),Pe(l),te.current=[].concat(Ra(te.current),[l.target]),ze(l)&&Promise.resolve(i(l)).then(function(m){if(!(Me(l)&&!c)){var M=m.length,K=M>0&&_a({files:m,accept:k,minSize:d,maxSize:s,multiple:g,maxFiles:f,validator:_}),Q=M>0&&!K;G({isDragAccept:K,isDragReject:Q,isDragActive:!0,type:"setDraggedFiles"}),D&&D(l)}}).catch(function(m){return ae(m)})},[i,D,ae,c,k,d,s,g,f,_]),Oe=u.useCallback(function(l){l.preventDefault(),l.persist(),Pe(l);var m=ze(l);if(m&&l.dataTransfer)try{l.dataTransfer.dropEffect="copy"}catch{}return m&&v&&v(l),!1},[v,c]),h=u.useCallback(function(l){l.preventDefault(),l.persist(),Pe(l);var m=te.current.filter(function(K){return F.current&&F.current.contains(K)}),M=m.indexOf(l.target);M!==-1&&m.splice(M,1),te.current=m,!(m.length>0)&&(G({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),ze(l)&&S&&S(l))},[F,S,c]),R=u.useCallback(function(l,m){var M=[],K=[];l.forEach(function(Q){var _e=qr(Q,k),be=tr(_e,2),qe=be[0],Ye=be[1],Ge=Yr(Q,d,s),je=tr(Ge,2),Qe=je[0],Xe=je[1],Je=_?_(Q):null;if(qe&&Qe&&!Je)M.push(Q);else{var Ze=[Ye,Xe];Je&&(Ze=Ze.concat(Je)),K.push({file:Q,errors:Ze.filter(function(at){return at})})}}),(!g&&M.length>1||g&&f>=1&&M.length>f)&&(M.forEach(function(Q){K.push({file:Q,errors:[ka]})}),M.splice(0)),G({acceptedFiles:M,fileRejections:K,type:"setFiles"}),E&&E(M,K,m),K.length>0&&A&&A(K,m),M.length>0&&y&&y(M,m)},[G,g,k,d,s,f,E,y,A,_]),$=u.useCallback(function(l){l.preventDefault(),l.persist(),Pe(l),te.current=[],ze(l)&&Promise.resolve(i(l)).then(function(m){Me(l)&&!c||R(m,l)}).catch(function(m){return ae(m)}),G({type:"reset"})},[i,R,ae,c]),B=u.useCallback(function(){if(re.current){G({type:"openDialog"}),L();var l={multiple:g,types:z};window.showOpenFilePicker(l).then(function(m){return i(m)}).then(function(m){R(m,null),G({type:"closeDialog"})}).catch(function(m){Oa(m)?(V(m),G({type:"closeDialog"})):Ta(m)?(re.current=!1,H.current?(H.current.value=null,H.current.click()):ae(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):ae(m)});return}H.current&&(G({type:"openDialog"}),L(),H.current.value=null,H.current.click())},[G,L,V,P,R,ae,z,g]),ie=u.useCallback(function(l){!F.current||!F.current.isEqualNode(l.target)||(l.key===" "||l.key==="Enter"||l.keyCode===32||l.keyCode===13)&&(l.preventDefault(),B())},[F,B]),ce=u.useCallback(function(){G({type:"focus"})},[]),ge=u.useCallback(function(){G({type:"blur"})},[]),yr=u.useCallback(function(){C||(wa()?setTimeout(B,0):B())},[C,B]),he=function(m){return n?null:m},Ue=function(m){return I?null:he(m)},Te=function(m){return o?null:he(m)},Pe=function(m){c&&m.stopPropagation()},et=u.useMemo(function(){return function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=l.refKey,M=m===void 0?"ref":m,K=l.role,Q=l.onKeyDown,_e=l.onFocus,be=l.onBlur,qe=l.onClick,Ye=l.onDragEnter,Ge=l.onDragOver,je=l.onDragLeave,Qe=l.onDrop,Xe=He(l,Wa);return j(j(cr({onKeyDown:Ue(ee(Q,ie)),onFocus:Ue(ee(_e,ce)),onBlur:Ue(ee(be,ge)),onClick:he(ee(qe,yr)),onDragEnter:Te(ee(Ye,ke)),onDragOver:Te(ee(Ge,Oe)),onDragLeave:Te(ee(je,h)),onDrop:Te(ee(Qe,$)),role:typeof K=="string"&&K!==""?K:"presentation"},M,F),!n&&!I?{tabIndex:0}:{}),Xe)}},[F,ie,ce,ge,yr,ke,Oe,h,$,I,o,n]),rt=u.useCallback(function(l){l.stopPropagation()},[]),tt=u.useMemo(function(){return function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=l.refKey,M=m===void 0?"ref":m,K=l.onChange,Q=l.onClick,_e=He(l,za),be=cr({accept:k,multiple:g,type:"file",style:{display:"none"},onChange:he(ee(K,$)),onClick:he(ee(Q,rt)),tabIndex:-1},M,H);return j(j({},be),_e)}},[H,t,g,$,n]);return j(j({},De),{},{isFocused:Ee&&!n,getRootProps:et,getInputProps:tt,rootRef:F,inputRef:H,open:he(B)})}function Ka(e,r){switch(r.type){case"focus":return j(j({},e),{},{isFocused:!0});case"blur":return j(j({},e),{},{isFocused:!1});case"openDialog":return j(j({},dr),{},{isFileDialogActive:!0});case"closeDialog":return j(j({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return j(j({},e),{},{isDragActive:r.isDragActive,isDragAccept:r.isDragAccept,isDragReject:r.isDragReject});case"setFiles":return j(j({},e),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections});case"reset":return j({},dr);default:return e}}function zr(){}const Ua=({open:e,closeModal:r,setTotalRows:t,setData:n})=>{const[i,s]=u.useState(null),[d,g]=u.useState(!1),f=ve(),D=O=>{s(O[0])},S=()=>{s(null)},{getRootProps:v,getInputProps:E,isDragActive:y}=Zr({onDrop:D,noClick:!!i,noKeyboard:!!i}),A=O=>{if(!O)return a(Et,{fontSize:"large"});const P=O.type;return P.startsWith("image/")?a(Image,{fontSize:"large"}):P==="application/pdf"?a(Pt,{fontSize:"large"}):P==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?a(Ot,{fontSize:"large"}):a(Tt,{fontSize:"large"})};return b(Ke,{open:e,onClose:r,children:[b(Be,{style:{cursor:"move"},id:"draggable-dialog-title",children:[a(Se,{children:"Import Daily Works"}),a(pe,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16,zIndex:0},children:a(ur,{})})]}),b("form",{onSubmit:async O=>{O.preventDefault(),g(!0);const P=new FormData;P.append("file",i);const W=new Promise(async(x,C)=>{try{const I=await axios.post(route("dailyWorks.import"),P);console.log(I),I.status===200&&(n(I.data.data),t(I.data.total),x(I.data.message||"Daily works imported successfully."),r())}catch(I){console.log(I.response),console.log(I.response.data.errors),C(`Error: ${I.message||"An unexpected error occurred."}`)}finally{g(!1)}});ne.promise(W,{pending:{render(){return b("div",{style:{display:"flex",alignItems:"center"},children:[a(ye,{}),a("span",{style:{marginLeft:"8px"},children:"Uploading file ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,color:f.palette.text.primary}},success:{render({data:x}){return a(N,{children:x})},icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,color:f.palette.text.primary}},error:{render({data:x}){return a(N,{children:x})},icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,color:f.palette.text.primary}}})},children:[a(Ne,{children:a(Y,{container:!0,spacing:2,children:a(Y,{item:!0,xs:12,children:b(J,{...v(),sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"2px dashed #ccc",borderRadius:"8px",padding:"20px",cursor:i?"not-allowed":"pointer","&:hover":{borderColor:i?"#ccc":"#aaa"}},children:[a("input",{...E()}),a(pe,{sx:{borderRadius:"50%",backgroundColor:"#f0f0f0","&:hover":{backgroundColor:i?"#f0f0f0":"#e0e0e0",cursor:i?"not-allowed":"pointer"}},disabled:!!i,children:A(i)}),i?b(N,{children:[b(Se,{variant:"body1",sx:{marginTop:"10px"},children:[i.name," (",(i.size/1024).toFixed(2)," KB)"]}),a(pe,{onClick:S,sx:{marginTop:"10px",backgroundColor:"#f0f0f0","&:hover":{backgroundColor:"#e0e0e0"}},children:a(It,{})})]}):a(Se,{variant:"body1",sx:{marginTop:"10px"},children:"Drag & drop files here, or click to select files"})]})})})}),a(Ve,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:a(Rr,{disabled:!i,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",loading:d,startIcon:a(nr,{}),children:"Upload"})})]})]})};St.extend(kt);const qa=Re.memo(({auth:e,title:r,allData:t,jurisdictions:n,users:i,reports:s,reports_with_daily_works:d,overallEndDate:g,overallStartDate:f})=>{const D=ve(),[S,v]=u.useState([]),[E,y]=u.useState(!1),[A,q]=u.useState(0),[O,P]=u.useState(0),[W,x]=u.useState([]),[C,I]=u.useState(),[o,c]=u.useState(null),[p,_]=u.useState(null),[k,z]=u.useState(""),L=gt(D.breakpoints.down("md")),[V,F]=u.useState(30),[H,le]=u.useState(1),me=async(h,R,$)=>{try{const B=await ar.get(route("dailyWorks.paginate"),{params:{page:h,perPage:R,search:k,status:$.status!=="all"?$.status:"",inCharge:$.incharge!=="all"?$.incharge:"",startDate:$.startDate,endDate:$.endDate}});console.log(B),v(B.data.data),q(B.data.total),P(B.data.last_page),y(!1)}catch(B){console.log(B),ne.error("Failed to fetch data.",{icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:D.glassCard.backgroundColor,border:D.glassCard.border,color:D.palette.text.primary}}),y(!1)}},De=()=>{const h=new Promise(async(R,$)=>{var B,ie;try{const ce=await fetch("/delete-daily-work",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:o,page:H,perPage:V,search:k,status:T.status!=="all"?T.status:"",inCharge:T.incharge!=="all"?T.incharge:"",startDate:(B=T.startDate)==null?void 0:B.format("YYYY-MM-DD"),endDate:(ie=T.endDate)==null?void 0:ie.format("YYYY-MM-DD")})}),ge=await ce.json();ce.ok?(v(ge.data),q(ge.total),R("Daily work deleted successfully")):$(ge.error||"Failed to delete task")}catch(ce){console.error("Error deleting task:",ce),$("An error occurred while deleting the task")}finally{Ee()}});ne.promise(h,{pending:{render(){return b("div",{style:{display:"flex",alignItems:"center"},children:[a(ye,{}),a("span",{style:{marginLeft:"8px"},children:"Deleting task..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:D.glassCard.backgroundColor,border:D.glassCard.border,color:D.palette.text.primary}},success:{render({data:R}){return a(N,{children:R})},icon:"🟢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:D.glassCard.backgroundColor,border:D.glassCard.border,color:D.palette.text.primary}},error:{render({data:R}){return a(N,{children:R})},icon:"🔴",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:D.glassCard.backgroundColor,border:D.glassCard.border,color:D.palette.text.primary}}})},G=u.useCallback((h,R)=>{c(h),_(R)},[]),Ee=u.useCallback(()=>{_(null),c(null)},[]),Z=u.useCallback(h=>{_(h)},[]),re=u.useCallback(()=>{_(null)},[]),[T,te]=u.useState({startDate:null,endDate:null,status:"all",incharge:"all",report:""}),se=u.useCallback((h,R)=>{if(console.log(h,R),h==="startDate"||h==="endDate"){ke(1);const $=h==="startDate"?R:T.startDate,B=h==="endDate"?R:T.endDate;te(ie=>({...ie,startDate:$,endDate:h==="endDate"?B<$?"":B:ie.endDate}))}else te($=>({...$,[h]:R}))},[T]),ae=h=>{const R=h.target.value.toLowerCase();z(R)};u.useEffect(()=>{y(!0),me(H,V,T)},[H,V,T,k]);const ke=h=>{le(h)},Oe=h=>{switch(h){case"new":return"primary";case"resubmission":return"warning";case"completed":return"success";case"emergency":return"danger";default:return""}};return console.log(f,g),b(N,{children:[a(ot,{title:r}),p==="addDailyWork"&&a(Fr,{modalType:"add",open:p==="addDailyWork",setData:v,closeModal:re}),p==="editDailyWork"&&a(Fr,{modalType:"update",open:p==="editDailyWork",currentRow:C,setData:v,closeModal:re}),p==="deleteDailyWork"&&a(Xt,{open:p==="deleteDailyWork",handleClose:Ee,handleDelete:De,setData:v}),p==="importDailyWorks"&&a(Ua,{open:p==="importDailyWorks",closeModal:re,setData:v,setTotalRows:q}),p==="exportDailyWorks"&&a(Jt,{open:p==="exportDailyWorks",closeModal:re,data:S,users:i}),a(J,{sx:{display:"flex",justifyContent:"center",p:2},children:a(ht,{in:!0,children:b(xt,{children:[a(bt,{title:r,sx:{padding:"24px"},action:b(J,{display:"flex",gap:2,children:[e.roles.includes("Administrator")&&a(N,{children:L?a(de,{variant:"faded",isIconOnly:!0,title:"Add Daily Work",color:"primary",onClick:()=>Z("addDailyWork"),children:a(_r,{})}):a(de,{title:"Add Daily Work",variant:"bordered",color:"primary",startContent:a(_r,{}),onClick:()=>Z("addDailyWork"),children:"Add"})}),e.roles.includes("Administrator")&&a(N,{children:L?b(N,{children:[a(de,{variant:"faded",isIconOnly:!0,title:"Import Daily Works",color:"warning",onClick:()=>Z("importDailyWorks"),children:a(nr,{})}),a(de,{variant:"faded",isIconOnly:!0,title:"Export Daily Works",color:"success",onClick:()=>Z("exportDailyWorks"),children:a(or,{})})]}):b(N,{children:[a(de,{title:"Import Daily Works",variant:"bordered",color:"warning",startContent:a(nr,{}),onClick:()=>Z("importDailyWorks"),children:"Import"}),a(de,{title:"Export Daily Works",variant:"bordered",color:"success",startContent:a(or,{}),onClick:()=>Z("exportDailyWorks"),children:"Export"})]})})]})}),a(Cr,{children:a(J,{children:b(Y,{container:!0,spacing:2,children:[a(Y,{item:!0,xs:12,sm:6,md:6,children:b(J,{display:"flex",alignItems:"center",children:[a(X,{isLoading:E,label:"Start Date",type:"text",onFocus:h=>h.target.type="date",onBlur:h=>h.target.type="text","aria-label":"Start Date",variant:"bordered",value:T.startDate||"",onChange:h=>se("startDate",h.target.value),placeholder:"Select Start Date",min:f,max:T.endDate||g}),a(J,{mx:1,children:"to"}),a(X,{isLoading:E,label:"End Date",disabled:!T.startDate,type:"text",onFocus:h=>h.target.type="date",onBlur:h=>h.target.type="text",variant:"bordered",value:T.endDate||"",onChange:h=>se("endDate",h.target.value),placeholder:"Select End Date",min:T.startDate||f,max:g})]})}),a(Y,{item:!0,xs:6,sm:4,md:3,children:b(fe,{isLoading:E,label:"Status",fullWidth:!0,variant:"bordered","aria-label":"Status",color:Oe(T.status),placeholder:"Select Status",value:T.status,onChange:h=>se("status",h.target.value),selectedKeys:[T.status],popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"}},children:[a(U,{value:"all",children:"All"},"all"),a(U,{value:"completed",children:"Completed"},"completed"),a(U,{value:"new",children:"New"},"new"),a(U,{value:"resubmission",children:"Resubmission"},"resubmission"),a(U,{value:"emergency",children:"Emergency"},"emergency")]})}),e.roles.includes("Administrator")&&a(Y,{item:!0,xs:6,sm:4,md:3,children:b(fe,{isLoading:E,label:"Incharge",fullWidth:!0,"aria-label":"Incharge",variant:"bordered",placeholder:"Select Status",name:"incharge",value:T.incharge,onChange:h=>se("incharge",h.target.value),selectedKeys:[T.status],popoverProps:{classNames:{content:"bg-transparent backdrop-blur-lg border-inherit"}},children:[a(U,{value:"all",children:"All"},"all"),t.allInCharges.map(h=>a(U,{value:h.id,children:h.name},h.id))]})}),a(Y,{item:!0,xs:12,sm:12,md:12,children:a(X,{isLoading:E,size:"lg","aria-label":"Search",fullWidth:!0,variant:"bordered",placeholder:"Search...",value:k,onChange:ae,startContent:a(wt,{})})})]})})}),b(Cr,{children:[a(Qt,{setData:v,filteredData:W,setFilteredData:x,reports:s,setCurrentRow:I,currentPage:H,setCurrentPage:le,setLoading:y,handleClickOpen:G,openModal:Z,juniors:t.juniors,totalRows:A,lastPage:O,loading:E,allData:S,allInCharges:t.allInCharges,jurisdictions:n,users:i,reports_with_daily_works:d}),A>=30&&a("div",{className:"py-2 px-2 flex justify-center items-center",children:a(At,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:H,total:O,onChange:ke})})]})]})})})]})});qa.layout=e=>a(Ct,{children:e});export{qa as default};
