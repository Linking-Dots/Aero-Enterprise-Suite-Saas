import{a as e,j as t,F as I,q as H,Y}from"./app-DlWLaSZ7.js";import{s as J,j as K,u as Q,h as X,i as j,k as n,l as $,f as W,T as w,A as z,N as U,c as k,n as V,o as Z,r as o,O as ee,G as c,F as ae,m as te,S as re,M as E,P as ne,b as S,Q as le,R as oe,p as se,e as ie,q as de,B as C,a as L}from"./vendor-BJIGEQ4S.js";import{r as ce,B as pe,G as P,A as ue}from"./App-DPt84Ubs.js";import{E as he,D as me}from"./Edit-CtlaAq0A.js";import{d as ye,G as ve}from"./GlassDialog-DRb3oUGC.js";import{L as fe}from"./LoadingButton-5pXDESbp.js";import{A as xe}from"./Add-C_Wp1qAA.js";var _={},ge=J;Object.defineProperty(_,"__esModule",{value:!0});var M=_.default=void 0,be=ge(ce()),Se=K;M=_.default=(0,be.default)((0,Se.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonChecked");const we=({allLeaves:x,allUsers:i})=>{const y=Q();return e(Z,{style:{maxHeight:"84vh",overflowY:"auto"},children:t(V,{"aria-label":"leave employee table",children:[e(X,{children:t(j,{children:[e(n,{sx:{whiteSpace:"nowrap"},children:"Leave Type"}),e(n,{sx:{whiteSpace:"nowrap"},children:"From"}),e(n,{sx:{whiteSpace:"nowrap"},children:"To"}),e(n,{sx:{whiteSpace:"nowrap"},children:"No of Days"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Reason"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Status"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Approved by"}),e(n,{sx:{whiteSpace:"nowrap"},align:"center",children:"Actions"})]})}),e($,{children:x.map(r=>t(j,{children:[e(n,{sx:{whiteSpace:"nowrap"},children:r.leave_type}),e(n,{sx:{whiteSpace:"nowrap"},children:new Date(r.from_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(n,{sx:{whiteSpace:"nowrap"},children:new Date(r.to_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(n,{sx:{whiteSpace:"nowrap"},children:r.no_of_days}),e(n,{sx:{whiteSpace:"nowrap"},children:r.reason}),e(n,{sx:{whiteSpace:"nowrap"},children:t(W,{variant:"outlined",color:"primary",sx:{borderRadius:"50px"},children:[e(M,{})," ",r.status]})}),e(n,{sx:{whiteSpace:"nowrap"},children:r.approved_by?t(w,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(z,{src:i.find(l=>l.id===r.approved_by).avatar,alt:i.find(l=>l.id===r.approved_by).name}),e(w,{sx:{marginLeft:"10px"},children:e(U,{href:"#",sx:{textDecoration:"none",color:y.palette.text.primary,fontWeight:"bold"},children:i.find(l=>l.id===r.approved_by).name})})]}):null}),t(n,{sx:{whiteSpace:"nowrap"},align:"center",children:[e(k,{href:"#",onClick:()=>{},children:e(he,{})}),e(k,{href:"#",onClick:()=>{},children:e(me,{})})]})]},r.id))})]})})},Ce=({open:x,closeModal:i,leaveTypes:y,leaveCounts:r,setLeavesData:l})=>{const[u,D]=o.useState("Casual"),[v,T]=o.useState(""),[g,h]=o.useState(""),[R,O]=o.useState(""),[G,q]=o.useState(""),[B,N]=o.useState(""),[s,De]=o.useState({}),[A,F]=o.useState(!1);return o.useEffect(()=>{console.log(u);const a=r.find(f=>f.leave_type===u);console.log(a),q(a.remaining_days)},[u]),o.useEffect(()=>{O(((f,p)=>{if(!f||!p)return"";const m=new Date(f),d=new Date(p);if(m>d)return"";const b=d.getTime()-m.getTime();return Math.ceil(b/(1e3*3600*24))+1})(v,g))},[v,g]),t(ve,{open:x,onClose:i,fullWidth:!0,maxWidth:"sm",children:[t(ee,{sx:{display:"flex",alignItems:"center"},children:[e(w,{variant:"h6",children:"Add Leave"}),e(k,{onClick:i,sx:{position:"absolute",top:8,right:16},children:e(ye,{})})]}),t("form",{onSubmit:async a=>{a.preventDefault(),F(!0);const f=new Promise(async(p,m)=>{try{const d=await fetch("/leave-add",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({leaveType:u,fromDate:v,toDate:g,daysCount:R,leaveReason:B})}),b=await d.json();d.ok?(l(b.leavesData),p([b.message||"Leave application submitted successfully"]),i()):m(b.error||"Failed to submit leave application")}catch(d){m(d.message||"An unexpected error occurred.")}finally{F(!1)}});pe.promise(f,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(se,{}),e("span",{style:{marginLeft:"8px"},children:"Submitting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.backgroundColor,border:theme.glassCard.border,color:theme.palette.text.primary}},success:{render({data:p}){return e(I,{children:p.map((m,d)=>e("div",{children:m},d))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.backgroundColor,border:theme.glassCard.border,color:theme.palette.text.primary}},error:{render({data:p}){return e(I,{children:p})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.backgroundColor,border:theme.glassCard.border,color:theme.palette.text.primary}}})},children:[e(le,{children:t(c,{container:!0,spacing:2,children:[e(c,{item:!0,xs:12,md:6,children:t(ae,{fullWidth:!0,children:[e(te,{id:"leave-type-label",children:"Leave Type"}),t(re,{labelId:"leave-type-label",value:u,onChange:a=>D(a.target.value),label:"Leave Type",error:!!s.leaveType,children:[e(E,{value:"",disabled:!0,children:"Select Leave Type"}),y.map(a=>t(E,{value:a.type,children:[a.type," ",a.days," Days"]},a.id))]}),e(ne,{children:s.leaveType})]})}),e(c,{item:!0,xs:12,md:6,children:e(S,{label:"From",type:"date",fullWidth:!0,value:v,onChange:a=>T(a.target.value),InputLabelProps:{shrink:!0},error:!!s.fromDate,helperText:s.fromDate})}),e(c,{item:!0,xs:12,md:6,children:e(S,{label:"To",type:"date",fullWidth:!0,value:g,onChange:a=>h(a.target.value),InputLabelProps:{shrink:!0},error:!!s.toDate,helperText:s.toDate})}),e(c,{item:!0,xs:12,md:6,children:e(S,{label:"Number of days",type:"text",fullWidth:!0,value:R,InputProps:{readOnly:!0},error:!!s.daysCount,helperText:s.daysCount})}),e(c,{item:!0,xs:12,md:6,children:e(S,{label:"Remaining Leaves",type:"text",fullWidth:!0,value:G,InputProps:{readOnly:!0},error:!!s.remainingLeaves,helperText:s.remainingLeaves})}),e(c,{item:!0,xs:12,children:e(S,{label:"Leave Reason",multiline:!0,rows:4,fullWidth:!0,value:B,onChange:a=>N(a.target.value),error:!!s.leaveReason,helperText:s.leaveReason})})]})}),e(oe,{sx:{padding:"16px",justifyContent:"center"},children:e(fe,{type:"submit",variant:"outlined",color:"primary",loading:A,disabled:A,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},je=({title:x,allUsers:i})=>{const[y,r]=o.useState(null),[l,u]=o.useState(H().props.leavesData),[D,v]=o.useState(l.allLeaves);o.useEffect(()=>{v(l.allLeaves)},[l]),console.log(l);const T=h=>{r(h)};return t(ue,{children:[e(Y,{title:x}),y==="leave"&&e(Ce,{open:y==="leave",setLeavesData:u,closeModal:()=>{r(null)},leaveTypes:l.leaveTypes,leaveCounts:l.leaveCounts}),e(C,{sx:{display:"flex",justifyContent:"center",p:2},children:e(ie,{in:!0,children:t(P,{children:[e(de,{title:"Leaves",sx:{padding:"24px"},action:e(C,{display:"flex",gap:2,children:e(W,{title:"Add Leave",variant:"outlined",color:"success",startIcon:e(xe,{}),onClick:()=>T("leave"),children:"Add Leave"})})}),e(L,{children:e(c,{container:!0,spacing:2,children:l.leaveCounts.map(h=>e(c,{item:!0,xs:12,sm:6,md:3,children:e(P,{children:e(L,{children:e(C,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",children:t(C,{children:[e(w,{variant:"h6",children:h.leave_type}),e(w,{variant:"h4",children:h.days_used})]})})})})},h.leave_type))})}),e(L,{children:e(we,{allLeaves:D,allUsers:i})})]})})})]})};export{je as default};
