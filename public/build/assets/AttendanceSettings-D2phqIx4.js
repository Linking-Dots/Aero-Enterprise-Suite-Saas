import{j as n,a as e,M as ue,F as R,c as B}from"./app-DTeAm_q0.js";import{r as l,u as pe,G as i,e as ge,g as P,a as $,T as p,b as m,F as be,k as he,S as me,aa as fe,B as b,x as xe,M as ye,$ as ke,a2 as we,c as G,v as H,w as z,y as N,z as Z,f as C,D as q}from"./vendor-JC7umhPn.js";import{G as U,A as ve,B as k}from"./App-3VVgp6Zi.js";import{L as V}from"./LoadingButton-v0Xq5d2G.js";function _e({title:d,titleId:u,...f},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":u},f),d?l.createElement("title",{id:u},d):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const J=l.forwardRef(_e);function Ce({title:d,titleId:u,...f},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":u},f),d?l.createElement("title",{id:u},d):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const We=l.forwardRef(Ce);function Se({title:d,titleId:u,...f},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":u},f),d?l.createElement("title",{id:u},d):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Te=l.forwardRef(Se);function Fe({title:d,titleId:u,...f},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":u},f),d?l.createElement("title",{id:u},d):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Le=l.forwardRef(Fe),Be=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],De=({title:d,attendanceSettings:u,attendanceTypes:f})=>{const r=pe(),[o,K]=l.useState(u||{}),[W,D]=l.useState(f||[]),[Q,I]=l.useState(!1),[X,j]=l.useState(!1),[g,S]=l.useState(null),[T,M]=l.useState({config:{}}),[x,w]=l.useState({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]}),[y,Y]=l.useState({office_start_time:(o==null?void 0:o.office_start_time)||"09:00",office_end_time:(o==null?void 0:o.office_end_time)||"18:00",break_time_duration:(o==null?void 0:o.break_time_duration)||60,late_mark_after:(o==null?void 0:o.late_mark_after)||15,early_leave_before:(o==null?void 0:o.early_leave_before)||15,overtime_after:(o==null?void 0:o.overtime_after)||30,auto_punch_out:(o==null?void 0:o.auto_punch_out)??!1,auto_punch_out_time:(o==null?void 0:o.auto_punch_out_time)||"20:00",weekend_days:(o==null?void 0:o.weekend_days)||["saturday","sunday"]}),[ee,A]=l.useState(!1),[c,E]=l.useState({}),v=(a,t)=>{Y(s=>({...s,[a]:t}))},ae=async a=>{a.preventDefault(),A(!0);try{const t=await B.post(route("attendance-settings.update"),y);t.status===200&&(K(t.data.attendanceSettings),E({}),k.success(t.data.message||"Attendance settings updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}}))}catch(t){t.response&&t.response.status===422?(E(t.response.data.errors||{}),k.error(t.response.data.error||"Failed to update attendance settings.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}})):k.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}})}finally{A(!1)}},re=a=>{a.slug==="route-waypoint"||a.name.toLowerCase().includes("waypoint")||a.name.toLowerCase().includes("route")?oe(a):(S(a),M({config:a.config||{}}),I(!0))},F=()=>I(!1),te=(a,t)=>{M(s=>({...s,config:{...s.config,[a]:t}}))},ne=async()=>{if(!g)return;const a=await B.post(route("attendance-types.update",g.id),{config:T.config});D(W.map(t=>t.id===g.id?a.data.attendanceType:t)),F()},oe=(a=null)=>{var t,s;if(a){S(a);const h=((t=a.config)==null?void 0:t.waypoints)||[],_=((s=a.config)==null?void 0:s.tolerance)||100;h.length>0?w({tolerance:_,waypoints:h}):w({tolerance:_,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})}j(!0)},L=()=>{j(!1),S(null),w({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})},O=(a,t,s)=>{w(h=>({...h,waypoints:h.waypoints.map((_,ce)=>ce===a?{..._,[t]:s}:_)}))},le=()=>{w(a=>({...a,waypoints:[...a.waypoints,{lat:"",lng:""}]}))},ie=a=>{x.waypoints.length>2&&w(t=>({...t,waypoints:t.waypoints.filter((s,h)=>h!==a)}))},se=a=>{w(t=>({...t,tolerance:a}))},de=async()=>{const a=x.waypoints.filter(t=>t.lat&&t.lng);if(a.length===0){k.error("Please add at least one valid waypoint.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}});return}if(!x.tolerance||x.tolerance<=0){k.error("Please enter a valid tolerance value.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}});return}try{if(g){const t={...g.config,tolerance:x.tolerance,waypoints:a},s=await B.post(route("attendance-types.update",g.id),{config:t});D(W.map(h=>h.id===g.id?s.data.attendanceType:h)),k.success("Waypoints updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}})}else k.success("Waypoints saved successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}});L()}catch{k.error("Failed to save waypoints.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,color:r.palette.text.primary}})}};return n(R,{children:[e(ue,{title:d}),e(b,{sx:{display:"flex",justifyContent:"center",p:2},children:n(i,{container:!0,spacing:4,children:[e(i,{item:!0,xs:12,md:6,children:e(ge,{in:!0,children:n(U,{children:[e(P,{title:"Attendance Settings"}),n("form",{onSubmit:ae,children:[n($,{children:[e(p,{variant:"h6",gutterBottom:!0,children:"Office Timing"}),n(i,{container:!0,spacing:3,children:[e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Office Start Time",type:"time",value:y.office_start_time,onChange:a=>v("office_start_time",a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!c.office_start_time,helperText:c.office_start_time})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Office End Time",type:"time",value:y.office_end_time,onChange:a=>v("office_end_time",a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!c.office_end_time,helperText:c.office_end_time})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Break Time Duration (minutes)",type:"number",value:y.break_time_duration,onChange:a=>v("break_time_duration",parseInt(a.target.value)),fullWidth:!0,error:!!c.break_time_duration,helperText:c.break_time_duration})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Late Mark After (minutes)",type:"number",value:y.late_mark_after,onChange:a=>v("late_mark_after",parseInt(a.target.value)),fullWidth:!0,error:!!c.late_mark_after,helperText:c.late_mark_after})})]}),e(p,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Attendance Rules"}),n(i,{container:!0,spacing:3,children:[e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Early Leave Before (minutes)",type:"number",value:y.early_leave_before,onChange:a=>v("early_leave_before",parseInt(a.target.value)),fullWidth:!0,error:!!c.early_leave_before,helperText:c.early_leave_before})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Overtime After (minutes)",type:"number",value:y.overtime_after,onChange:a=>v("overtime_after",parseInt(a.target.value)),fullWidth:!0,error:!!c.overtime_after,helperText:c.overtime_after})})]}),e(p,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Weekend Settings"}),e(i,{container:!0,spacing:3,children:e(i,{item:!0,xs:12,children:n(be,{fullWidth:!0,children:[e(he,{id:"weekend-days",children:"Weekend Days"}),e(me,{labelId:"weekend-days",multiple:!0,value:y.weekend_days,onChange:a=>v("weekend_days",a.target.value),input:e(fe,{label:"Weekend Days"}),error:!!c.weekend_days,renderValue:a=>e(b,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(t=>e(xe,{label:t.charAt(0).toUpperCase()+t.slice(1)},t))}),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:Be.map(a=>e(ye,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),e(ke,{children:c.weekend_days})]})})})]}),e(we,{sx:{justifyContent:"center"},children:e(V,{loading:ee,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",children:"Save"})})]})]})})}),e(i,{item:!0,xs:12,md:6,children:n(U,{children:[e(P,{title:"Attendance Types"}),e($,{children:e(i,{container:!0,spacing:2,children:W.map(a=>e(i,{item:!0,xs:12,children:n(b,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderRadius:3,background:"rgba(255,255,255,0.12)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.18)",backdropFilter:"blur(12px) saturate(180%)",transition:"box-shadow 0.2s","&:hover":{boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.18)"}},children:[n(b,{sx:{display:"flex",alignItems:"center",gap:2},children:[e(b,{sx:{mr:1},children:a.icon}),n(b,{children:[e(p,{variant:"subtitle1",sx:{fontWeight:600},children:a.name}),e(p,{variant:"body2",color:"text.secondary",children:a.description}),n(p,{variant:"caption",color:"text.secondary",children:["Slug: ",a.slug]}),n(p,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:["Config: ",JSON.stringify(a.config)]})]})]}),e(b,{children:e(G,{onClick:()=>re(a),children:e(We,{style:{width:20,height:20,color:r.palette.primary.main}})})})]})},a.id))})})]})})]})}),n(H,{open:Q,onClose:F,maxWidth:"sm",fullWidth:!0,children:[e(z,{children:"Edit Attendance Type Config"}),e(N,{children:g&&n(R,{children:[n(p,{variant:"subtitle1",sx:{mb:2},children:[g.name," (",g.slug,")"]}),Object.keys(T.config).length===0&&e(p,{variant:"body2",color:"text.secondary",children:"No config fields available for this type."}),Object.entries(T.config).map(([a,t])=>e(m,{label:a,value:t,onChange:s=>te(a,s.target.value),fullWidth:!0,margin:"normal"},a))]})}),n(Z,{children:[e(C,{onClick:F,children:"Cancel"}),e(C,{onClick:ne,variant:"contained",children:"Save"})]})]}),n(H,{open:X,onClose:L,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:r.glassCard.background,border:r.glassCard.border,borderRadius:3,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"}},children:[n(z,{sx:{display:"flex",alignItems:"center",gap:2,borderBottom:"1px solid rgba(255,255,255,0.1)",pb:2},children:[e(J,{style:{width:24,height:24,color:r.palette.primary.main}}),e(p,{variant:"h6",component:"span",children:g?`Manage Waypoints - ${g.name}`:"Manage Waypoints"})]}),n(N,{sx:{pt:3},children:[e(p,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Define location waypoints for attendance tracking. Each waypoint requires latitude and longitude coordinates."}),e(b,{sx:{mb:4},children:n(b,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[n(p,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:r.palette.primary.main,fontWeight:600,mb:2},children:[n("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",children:[e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Location Tolerance Settings"]}),e(m,{label:"Tolerance (meters)",placeholder:"e.g., 100",type:"number",value:x.tolerance,onChange:a=>se(parseInt(a.target.value)||0),fullWidth:!0,inputProps:{min:1,max:1e4,step:1},helperText:"Distance in meters within which attendance can be marked from each waypoint",sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})]})}),e(q,{sx:{my:3,opacity:.3}}),e(i,{container:!0,spacing:3,children:x.waypoints.map((a,t)=>n(i,{item:!0,xs:12,children:[n(b,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[n(b,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[n(p,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:r.palette.primary.main,fontWeight:600},children:[e(J,{style:{width:16,height:16}}),"Waypoint ",t+1]}),x.waypoints.length>2&&e(G,{onClick:()=>ie(t),size:"small",sx:{color:r.palette.error.main,"&:hover":{background:"rgba(255,0,0,0.08)"}},children:e(Le,{style:{width:16,height:16}})})]}),n(i,{container:!0,spacing:2,children:[e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Latitude",placeholder:"e.g., 40.7128",type:"number",value:a.lat,onChange:s=>O(t,"lat",s.target.value),fullWidth:!0,inputProps:{step:"any",min:-90,max:90},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Longitude",placeholder:"e.g., -74.0060",type:"number",value:a.lng,onChange:s=>O(t,"lng",s.target.value),fullWidth:!0,inputProps:{step:"any",min:-180,max:180},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})})]})]}),t<x.waypoints.length-1&&e(q,{sx:{my:2,opacity:.3}})]},t))}),e(b,{sx:{mt:3,display:"flex",justifyContent:"center"},children:e(C,{startIcon:e(Te,{style:{width:20,height:20}}),onClick:le,variant:"outlined",sx:{borderRadius:3,background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.2)",color:r.palette.primary.main,"&:hover":{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)"}},children:"Add Another Waypoint"})})]}),n(Z,{sx:{p:3,borderTop:"1px solid rgba(255,255,255,0.1)",gap:2},children:[e(C,{onClick:L,sx:{borderRadius:3,color:r.palette.text.secondary,"&:hover":{background:"rgba(255,255,255,0.05)"}},children:"Cancel"}),e(V,{onClick:de,variant:"contained",sx:{borderRadius:3,background:`linear-gradient(135deg, ${r.palette.primary.main}, ${r.palette.primary.dark})`,boxShadow:"0 4px 20px rgba(0,0,0,0.15)","&:hover":{boxShadow:"0 6px 25px rgba(0,0,0,0.2)"}},children:"Save Waypoints"})]})]})]})};De.layout=d=>e(ve,{children:d});export{De as default};
