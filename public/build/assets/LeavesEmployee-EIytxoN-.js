import{a as e,j as l,F as A,q as ee,Y as ae}from"./app-Dyy-F2b9.js";import{i as te,j as re,v as q,A as le,E as O,H as d,J as se,f as B,T,R as oe,V as ne,c as j,z as ie,U as de,r as o,D as $,G as f,F as ce,P as pe,S as ue,Q as H,W as he,b as S,K as Y,L as J,t as K,X as me,e as ye,O as xe,B as R,a as W}from"./vendor-N08UupYT.js";import{r as fe,B as Q,G as z,A as ge}from"./App-CdC1ZRe-.js";import{d as be}from"./Edit-BwFpiRrQ.js";import{d as ve}from"./Delete-8M3YVVmq.js";import{d as Ce,G as U}from"./GlassDialog-BqlN9hZd.js";import{L as we}from"./LoadingButton-QHHPzujN.js";import{A as De}from"./Add-B9yJxGkf.js";var G={},Se=te;Object.defineProperty(G,"__esModule",{value:!0});var V=G.default=void 0,Te=Se(fe()),ke=re;V=G.default=(0,Te.default)((0,ke.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonChecked");const _e=({allLeaves:b,allUsers:c,handleClickOpen:u,setCurrentLeave:m,openModal:r})=>{const t=q();return e(de,{style:{maxHeight:"84vh",overflowY:"auto"},children:l(ie,{"aria-label":"leave employee table",children:[e(le,{children:l(O,{children:[e(d,{sx:{whiteSpace:"nowrap"},children:"Leave Type"}),e(d,{sx:{whiteSpace:"nowrap"},children:"From"}),e(d,{sx:{whiteSpace:"nowrap"},children:"To"}),e(d,{sx:{whiteSpace:"nowrap"},children:"No of Days"}),e(d,{sx:{whiteSpace:"nowrap"},children:"Reason"}),e(d,{sx:{whiteSpace:"nowrap"},children:"Status"}),e(d,{sx:{whiteSpace:"nowrap"},children:"Approved by"}),e(d,{sx:{whiteSpace:"nowrap"},align:"center",children:"Actions"})]})}),e(se,{children:b.map(a=>l(O,{children:[e(d,{sx:{whiteSpace:"nowrap"},children:a.leave_type}),e(d,{sx:{whiteSpace:"nowrap"},children:new Date(a.from_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(d,{sx:{whiteSpace:"nowrap"},children:new Date(a.to_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(d,{sx:{whiteSpace:"nowrap"},children:a.no_of_days}),e(d,{sx:{whiteSpace:"nowrap"},children:a.reason}),e(d,{sx:{whiteSpace:"nowrap"},children:l(B,{variant:"outlined",color:"primary",sx:{borderRadius:"50px"},children:[e(V,{})," ",a.status]})}),e(d,{sx:{whiteSpace:"nowrap"},children:a.approved_by?l(T,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(oe,{src:c.find(s=>s.id===a.approved_by).avatar,alt:c.find(s=>s.id===a.approved_by).name}),e(T,{sx:{marginLeft:"10px"},children:e(ne,{href:"#",sx:{textDecoration:"none",color:t.palette.text.primary,fontWeight:"bold"},children:c.find(s=>s.id===a.approved_by).name})})]}):null}),l(d,{sx:{whiteSpace:"nowrap"},align:"center",children:[e(j,{sx:{m:1},variant:"outlined",color:"success",size:"small",onClick:()=>{m(a),r("edit_leave")},children:e(be,{})}),e(j,{sx:{m:1},variant:"outlined",color:"error",size:"small",onClick:()=>u(a.id,"delete_leave"),children:e(ve,{})})]})]},a.id))})]})})},N=({open:b,closeModal:c,leaveTypes:u,leaveCounts:m,setLeavesData:r,currentLeave:t})=>{const a=q(),[s,w]=o.useState((t==null?void 0:t.leave_type)||"Casual"),[p,L]=o.useState((t==null?void 0:t.from_date)||""),[v,k]=o.useState((t==null?void 0:t.to_date)||""),[_,E]=o.useState((t==null?void 0:t.no_of_days)||""),[F,y]=o.useState(""),[I,X]=o.useState((t==null?void 0:t.reason)||""),[h,Z]=o.useState({}),[M,P]=o.useState(!1);return o.useEffect(()=>{const n=m.find(C=>C.leave_type===s);y(n.remaining_days)},[s]),o.useEffect(()=>{E(((C,g)=>{if(!C||!g)return"";const x=new Date(C),i=new Date(g);if(x>i)return"";const D=i.getTime()-x.getTime();return Math.ceil(D/(1e3*3600*24))+1})(p,v))},[p,v]),l(U,{open:b,onClose:c,fullWidth:!0,maxWidth:"sm",children:[l($,{sx:{display:"flex",alignItems:"center"},children:[e(T,{variant:"h6",children:"Add Leave"}),e(j,{onClick:c,sx:{position:"absolute",top:8,right:16},children:e(Ce,{})})]}),l("form",{onSubmit:async n=>{n.preventDefault(),P(!0);const C=new Promise(async(g,x)=>{try{const i={leaveType:s,fromDate:p,toDate:v,daysCount:_,leaveReason:I};t&&(i.id=t.id);const D=await axios.post(route("leave-add"),i);D.status===200&&(r(D.data.leavesData),g([D.data.messages||"Leave application submitted successfully"]),c())}catch(i){P(!1),i.response?(i.response.status===422?(Z(i.response.data.errors||{}),x(i.response.statusText||"Failed to submit leave application")):x("An unexpected error occurred. Please try again later."),console.error(i.response)):i.request?(x("No response received from the server. Please check your internet connection."),console.error(i.request)):(x("An error occurred while setting up the request."),console.error("Error",i.message))}finally{P(!1)}});Q.promise(C,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(K,{}),e("span",{style:{marginLeft:"8px"},children:"Submitting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:g}){return e(A,{children:g.map((x,i)=>e("div",{children:x},i))})},icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:g}){return e(A,{children:g})},icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},children:[e(Y,{children:l(f,{container:!0,spacing:2,children:[e(f,{item:!0,xs:12,md:6,children:l(ce,{fullWidth:!0,children:[e(pe,{id:"leave-type-label",children:"Leave Type"}),l(ue,{labelId:"leave-type-label",value:s,onChange:n=>w(n.target.value),label:"Leave Type",error:!!h.leaveType,children:[e(H,{value:"",disabled:!0,children:"Select Leave Type"}),u.map(n=>l(H,{value:n.type,children:[n.type," ",n.days," Days"]},n.id))]}),e(he,{children:h.leaveType})]})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"From",type:"date",fullWidth:!0,value:p,onChange:n=>L(n.target.value),InputLabelProps:{shrink:!0},error:!!h.fromDate,helperText:h.fromDate})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"To",type:"date",fullWidth:!0,value:v,onChange:n=>k(n.target.value),InputLabelProps:{shrink:!0},error:!!h.toDate,helperText:h.toDate})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"Number of days",type:"text",fullWidth:!0,value:_,InputProps:{readOnly:!0},error:!!h.daysCount,helperText:h.daysCount})}),e(f,{item:!0,xs:12,md:6,children:e(S,{label:"Remaining Leaves",type:"text",fullWidth:!0,value:F,InputProps:{readOnly:!0},error:!!h.remainingLeaves,helperText:h.remainingLeaves})}),e(f,{item:!0,xs:12,children:e(S,{label:"Leave Reason",multiline:!0,rows:4,fullWidth:!0,value:I,onChange:n=>X(n.target.value),error:!!h.leaveReason,helperText:h.leaveReason})})]})}),e(J,{sx:{padding:"16px",justifyContent:"center"},children:e(we,{type:"submit",variant:"outlined",color:"primary",loading:M,disabled:M,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},Fe=({open:b,handleClose:c,leaveIdToDelete:u,setLeavesData:m})=>{const r=q();return l(U,{open:b,onClose:c,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e($,{id:"alert-dialog-title",children:"Confirm Deletion"}),e(Y,{children:e(me,{id:"alert-dialog-description",children:"Are you sure you want to delete this leave? This action cannot be undone."})}),l(J,{children:[e(B,{onClick:c,color:"primary",children:"Cancel"}),e(B,{onClick:()=>{const a=new Promise(async(s,w)=>{try{const p=await axios.delete(route("leave-delete",{id:u}));p.status===200&&(m(p.data.leavesData),s("Task deleted successfully"))}catch(p){console.error("Error deleting task:",p),w(p.response.data.error||"Failed to delete task")}finally{c()}});Q.promise(a,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(K,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting task..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:r.glassCard.backgroundColor,border:r.glassCard.border,color:r.palette.text.primary}},success:{render({data:s}){return e(A,{children:s})},icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:r.glassCard.backgroundColor,border:r.glassCard.border,color:r.palette.text.primary}},error:{render({data:s}){return e(A,{children:s})},icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:r.glassCard.backgroundColor,border:r.glassCard.border,color:r.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})},Ge=({title:b,allUsers:c})=>{const[u,m]=o.useState(null),[r,t]=o.useState(ee().props.leavesData),[a,s]=o.useState(r.allLeaves),[w,p]=o.useState(null),[L,v]=o.useState();o.useEffect(()=>{s(r.allLeaves)},[r]);const k=y=>{m(y)},_=o.useCallback((y,I)=>{p(y),m(I)},[]),E=o.useCallback(()=>{m(null),p(null)},[]),F=()=>{m(null)};return l(ge,{children:[e(ae,{title:b}),u==="add_leave"&&e(N,{open:u==="add_leave",setLeavesData:t,closeModal:F,leaveTypes:r.leaveTypes,leaveCounts:r.leaveCounts}),u==="edit_leave"&&e(N,{open:u==="edit_leave",setLeavesData:t,closeModal:F,leaveTypes:r.leaveTypes,leaveCounts:r.leaveCounts,currentLeave:L}),u==="delete_leave"&&e(Fe,{open:u==="delete_leave",handleClose:E,leaveIdToDelete:w,setLeavesData:t}),e(R,{sx:{display:"flex",justifyContent:"center",p:2},children:e(ye,{in:!0,children:l(z,{children:[e(xe,{title:"Leaves",sx:{padding:"24px"},action:e(R,{display:"flex",gap:2,children:e(B,{title:"Add Leave",variant:"outlined",color:"success",startIcon:e(De,{}),onClick:()=>k("add_leave"),children:"Add Leave"})})}),e(W,{children:e(f,{container:!0,spacing:2,children:r.leaveCounts.map(y=>e(f,{item:!0,xs:12,sm:6,md:3,children:e(z,{children:e(W,{children:e(R,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",children:l(R,{children:[e(T,{variant:"h6",children:y.leave_type}),e(T,{variant:"h4",children:y.days_used})]})})})})},y.leave_type))})}),e(W,{children:e(_e,{handleClickOpen:_,setCurrentLeave:v,openModal:k,allLeaves:a,allUsers:c})})]})})})]})};export{Ge as default};
