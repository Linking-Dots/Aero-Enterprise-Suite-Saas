import{a as e,j as o,b as m,F as x,Y as M}from"./app-D4vjZJpx.js";import{r as D,u as O,h as q,i as T,k as n,l as G,A as H,T as J,F,m as N,S as P,M as g,c as S,n as U,o as W,p as I,e as z,q as K,B as j,f as X,a as Y}from"./vendor-BkBzn7Rm.js";import{a as $,B as _,G as V,A as Q}from"./App-ENa7V2m3.js";import{E as Z,D as ee}from"./Edit-eKb4YKV3.js";import{A as re}from"./Add-4GSdkR1s.js";const ae=({allUsers:b,departments:u,designations:c})=>{const[C,k]=D.useState(b),a=O(),[te,B]=D.useState({});async function A(r,d,t){const p=new Promise(async(l,s)=>{try{const i=t.target.value,f=r==="department"?"user.updateDepartment":"user.updateDesignation",v=await fetch(route(f,{id:d}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({[r]:i})}),y=await v.json();v.ok?(k(R=>R.map(h=>{if(h.id===d){const w={...h};return r==="department"&&h.department!==i&&(w.designation=null),w[r]=i,w}return h})),l(y.messages)):(s(y.messages||"Failed to update profile information."),console.error(y.errors))}catch(i){console.log(i),s(["An unexpected error occurred."])}});_.promise(p,{pending:{render(){return o("div",{style:{display:"flex",alignItems:"center"},children:[e(I,{}),o("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:l}){return e(x,{children:l.map((s,i)=>e("div",{children:s},i))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:l}){return e(x,{children:l.map((s,i)=>e("div",{children:s},i))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}const L=async r=>{const d=new Promise(async(t,p)=>{try{const l=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),s=await l.json();l.ok?(k(i=>i.filter(f=>f.id!==r)),t([s.message])):p([s.message])}catch(l){console.error("Error deleting user:",l),p(["An error occurred while deleting user. Please try again."])}});_.promise(d,{pending:{render(){return o("div",{style:{display:"flex",alignItems:"center"},children:[e(I,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:t}){return e(x,{children:t.map((p,l)=>e("div",{children:p},l))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:t}){return e(x,{children:t.map((p,l)=>e("div",{children:p},l))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},E=r=>{B(d=>({...d,[r]:null}))};return e(W,{style:{maxHeight:"84vh",overflowY:"auto"},children:o(U,{"aria-label":"employee table",children:[e(q,{children:o(T,{children:[e(n,{sx:{whiteSpace:"nowrap"},children:"Employee ID"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Name"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Mobile"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Email"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Join Date"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Department"}),e(n,{sx:{whiteSpace:"nowrap"},children:"Role"}),e(n,{sx:{whiteSpace:"nowrap"},align:"right",children:"Action"})]})}),e(G,{children:C.map(r=>{var d;return o(T,{children:[e(n,{sx:{whiteSpace:"nowrap"},children:r.employee_id||"N/A"}),o(n,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(H,{src:r.profile_image,alt:r.first_name}),o(J,{sx:{marginLeft:"10px"},children:[e(m,{style:{textDecoration:"none",color:a.palette.text.primary,fontWeight:"bold"},href:route("profile",{user:r.id}),children:r.name||"N/A"}),e("br",{}),((d=c.find(t=>t.id===r.designation))==null?void 0:d.title)||"N/A"]})]}),e(n,{sx:{whiteSpace:"nowrap"},children:r.phone||"N/A"}),e(n,{sx:{whiteSpace:"nowrap"},children:r.email||"N/A"}),e(n,{sx:{whiteSpace:"nowrap"},children:r.date_of_joining||"N/A"}),e(n,{sx:{whiteSpace:"nowrap"},children:o(F,{size:"small",fullWidth:!0,children:[e(N,{id:"department",children:"Department"}),o(P,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:t=>A("department",r.id,t),label:"Department",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(g,{value:"na",disabled:!0,children:"Select Department"}),u.map(t=>e(g,{value:t.id,children:t.name},t.id))]})]})}),e(n,{sx:{whiteSpace:"nowrap"},children:o(F,{size:"small",fullWidth:!0,children:[e(N,{id:"designation",children:"Designation"}),o(P,{labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:t=>A("designation",r.id,t),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(g,{value:"na",disabled:!0,children:"Select Designation"}),c.filter(t=>t.department_id===r.department).map(t=>e(g,{value:t.id,children:t.title},t.id))]})]})}),o(n,{sx:{whiteSpace:"nowrap"},align:"right",children:[e(S,{component:m,href:route("profile",{user:r.id}),onClick:()=>{E(r.id)},children:e($,{})}),e(S,{component:m,href:route("profile",{user:r.id}),onClick:()=>{E(r.id)},children:e(Z,{})}),o(S,{component:m,href:route("profile",{user:r.id}),onClick:()=>{L(r.id)},children:[e(ee,{})," "]})]})]},r.id)})})]})})},se=({title:b,allUsers:u,departments:c,designations:C})=>o(Q,{children:[e(M,{title:b}),e(j,{sx:{display:"flex",justifyContent:"center",p:2},children:e(z,{in:!0,children:o(V,{children:[e(K,{title:"Employees",sx:{padding:"24px"},action:e(j,{display:"flex",gap:2,children:e(X,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e(re,{}),children:"Add Employee"})})}),e(Y,{children:e(ae,{allUsers:u,departments:c,designations:C})})]})})})]});export{se as default};
