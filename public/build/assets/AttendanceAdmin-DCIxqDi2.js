import{r as $,q as A,a as e,j as c,d as L,Y as V,G as N,F as g,c as O,B as Q}from"./app-CyKuMGCi.js";import{p as Z,q as z,s as J,u as F,r as n,Z as K,e as U,g as X,B as _,c as ee,f as te,a as I,G as f,b as S,I as M}from"./vendor-UQRQluBo.js";import{A as ae}from"./App-kieZ_qw-.js";import{t as re,a as ne,b as oe,c as se,d as j,e as le}from"./chunk-YRZGWF2W-Bv4e_WgC.js";import{u as de}from"./chunk-TLBGAR4N-BWTggEP9.js";import{d as ce,p as ie}from"./Search-4Bad71TE.js";import{D as Y}from"./Download-CpmiTayw.js";const H=Z(z.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"}),"CalendarMonth");var D={},ue=J;Object.defineProperty(D,"__esModule",{value:!0});var W=D.default=void 0,he=ue($()),pe=z;W=D.default=(0,he.default)((0,pe.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done");const me=({allUsers:i,attendanceData:v,currentYear:s,currentMonth:m})=>{A().props,F();const u=new Date(s,m,0).getDate(),y=v.reduce((t,r)=>(t[r.user_id]=r,t),{}),x=(t,r)=>{const o=`${s}-${String(m).padStart(2,"0")}-${String(r).padStart(2,"0")}`;return((y[t.id]||{})[o]||"absent")==="present"?e(W,{}):e(L,{})},C=[{name:"Employee",uid:"employee"},...Array.from({length:u},(t,r)=>({name:(r+1).toString(),uid:(r+1).toString()}))];return e("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:c(le,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Attendance Table",children:[e(re,{columns:C,children:t=>e(ne,{align:"center",children:t.name},t.uid)}),e(oe,{items:i,children:t=>c(se,{children:[e(j,{children:e(de,{avatarProps:{radius:"lg",src:t.profile_image},name:t.name})}),Array.from({length:u},(r,o)=>e(j,{children:x(t,o+1)},o+1))]},t.id)})]})})},ge=({title:i,allUsers:v})=>{const s=F(),{auth:m}=A().props,[u,y]=n.useState(A().props.attendanceData),[x,C]=n.useState(0),[t,r]=n.useState(0),[o,w]=n.useState(""),P=K(s.breakpoints.down("md")),[k,fe]=n.useState(30),[b,B]=n.useState(1),[h,R]=n.useState({currentYear:new Date().getFullYear(),currentMonth:new Date().getMonth()+1});console.log(h);const E=n.useCallback((a,p)=>{R(l=>({...l,[a]:p}))},[]),q=async(a,p,l)=>{try{const d=await O.get(route("attendancesAdmin.paginate"),{params:{page:a,perPage:p,employee:o,currentYear:l.currentYear!=="all"?l.currentYear:"",currentMonth:l.currentMonth!=="all"?l.currentMonth:""}});console.log(d),y(d.data.data),C(d.data.total),r(d.data.last_page)}catch(d){console.log(d),Q.error("Failed to fetch data.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:s.glassCard.backgroundColor,border:s.glassCard.border,color:s.palette.text.primary}})}},G=a=>{const p=a.target.value.toLowerCase();w(p)};n.useEffect(()=>{q(b,k,h)},[b,k,h,o]);const T=a=>{B(a)};return console.log(u),c(g,{children:[e(V,{title:i}),e(_,{sx:{display:"flex",justifyContent:"center",p:2},children:e(U,{in:!0,children:c(N,{children:[e(X,{title:"Attendances",sx:{padding:"24px"},action:e(_,{display:"flex",gap:2,children:m.roles.includes("Administrator")&&e(g,{children:P?e(g,{children:e(ee,{title:"Export Daily Works",color:"success",onClick:()=>openModal("exportDailyWorks"),children:e(Y,{})})}):e(g,{children:e(te,{title:"Export Daily Works",variant:"outlined",color:"success",startIcon:e(Y,{}),onClick:()=>openModal("exportDailyWorks"),children:"Export"})})})})}),e(I,{children:e(_,{children:c(f,{container:!0,spacing:2,children:[e(f,{item:!0,xs:12,sm:6,md:3,children:e(S,{label:"Employee",fullWidth:!0,variant:"outlined",placeholder:"Employee...",value:o,onChange:G,InputProps:{startAdornment:e(M,{position:"start",children:e(ce,{})})}})}),e(f,{item:!0,xs:6,sm:4,md:3,children:e(S,{label:"Current Month",type:"month",fullWidth:!0,variant:"outlined",placeholder:"Month...",value:h.currentMonth,onChange:a=>E("currentMonth",a.target.value),InputProps:{startAdornment:e(M,{position:"start",children:e(H,{})})}})}),e(f,{item:!0,xs:6,sm:4,md:3,children:e(S,{label:"Current Year",type:"year",fullWidth:!0,variant:"outlined",placeholder:"Year...",value:h.currentYear,onChange:a=>E("currentYear",a.target.value),InputProps:{startAdornment:e(M,{position:"start",children:e(H,{})})}})})]})})}),c(I,{children:[e(me,{allUsers:v,attendanceData:u}),x>=30&&e("div",{className:"py-2 px-2 flex justify-center items-center",children:e(ie,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:b,total:t,onChange:T})})]})]})})})]})};ge.layout=i=>e(ae,{children:i});export{ge as default};
