import{V as we,a as t,j as s,F as Be,c as je}from"./app-BZCEtsTA.js";import{u as Oe,t as ye,r as p,G as z,e as Ne,g as be,B as l,T as E,v as Ge,w as ie,c as ce,x as P,a as me,y as Se,z as Ve,f as Ke}from"./vendor-Dz0S-B-S.js";import{F as G,a as D,G as ke,d as $e,b as Je,c as Qe,e as qe,f as Xe}from"./App-DC-ZgINO.js";import{d as Y}from"./dayjs.min-CAEEVKYd.js";import{u as te,w as Ze}from"./xlsx-CggEr6S4.js";import{E as et,P as tt}from"./jspdf.es.min-vOS8zZW3.js";import{a as nt,F as st}from"./jspdf.plugin.autotable-zIale6pD.js";import{F as ue}from"./UserIcon-eOL2cvBT.js";import{R as rt}from"./Refresh-CRq7m_6F.js";import{F as at}from"./MagnifyingGlassIcon-DuaQ8gio.js";import{c as De}from"./chunk-MW56SEHC-C_vttlAv.js";import{F as ne,a as ot}from"./XCircleIcon-BMNLY5mX.js";import{F as lt}from"./CheckCircleIcon-BuTS0DT4.js";import{i as he}from"./chunk-HJTJQZF3-BzkPrm6I.js";import{s as it}from"./chunk-TLYTI3QM-BPHH7-Md.js";import{t as ct,a as mt,b as ut,c as ht,d as pt,e as A}from"./chunk-F3UDT23P-DeTl2FO5.js";import{p as dt}from"./chunk-YHY32LNM-CFkxuyBu.js";import{u as ft}from"./chunk-R6AK6OQ4-QieAj_Uz.js";import"./chunk-2BFF5KFD-Ckbf7p12.js";import"./chunk-SLABUSGS-CcvCt12y.js";import"./chunk-MZRCPRP2-aDeFXsnk.js";import"./chunk-7F3ZLNJ6-BWkLKS2d.js";const _t=(V,g=!1)=>{if(!Array.isArray(V))return[];if(g){const a=V.reduce((c,m)=>{var k;const f=m.date.split("T")[0];return c[f]||(c[f]={id:m.id,user_id:(k=m.user)==null?void 0:k.id,user:m.user,date:m.date,punches:[]}),c[f].punches.push({punch_in:m.punchin_time,punch_out:m.punchout_time||null,id:m.id,date:m.date}),c},{});return Object.values(a).map(c=>{if(c.punches.length===0)return{...c,punchin_time:null,punchout_time:null,total_work_minutes:0,punch_count:0,complete_punches:0,has_incomplete_punch:!1};c.punches.sort((h,w)=>{if(!h.punch_in)return 1;if(!w.punch_in)return-1;const $=new Date(`${h.date}T${h.punch_in}`),I=new Date(`${w.date}T${w.punch_in}`);return $-I});const m=c.punches[0],f=c.punches.filter(h=>h.punch_out);let k=null;f.length>0&&(f.sort((h,w)=>{const $=new Date(`${h.date}T${h.punch_out}`);return new Date(`${w.date}T${w.punch_out}`)-$}),k=f[0]);let F=0,_=0,u=!1;return c.punches.forEach(h=>{if(h.punch_in&&h.punch_out){const w=h.date.split("T")[0],$=new Date(`${w}T${h.punch_in}`),I=new Date(`${w}T${h.punch_out}`);if(!isNaN($.getTime())&&!isNaN(I.getTime())){const Q=I-$;Q>0&&(F+=Q/(1e3*60),_++)}}else h.punch_in&&!h.punch_out&&(u=!0)}),{...c,punchin_time:(m==null?void 0:m.punch_in)||null,punchout_time:(k==null?void 0:k.punch_out)||null,total_work_minutes:Math.round(F*100)/100,punch_count:c.punches.length,complete_punches:_,has_incomplete_punch:u,first_punch_date:c.date,last_punch_date:c.date}}).sort((c,m)=>new Date(m.date)-new Date(c.date))}const H=V.reduce((a,i)=>{var m;const c=(m=i.user)==null?void 0:m.id;return c&&(a[c]||(a[c]={id:i.id,user_id:i.user.id,user:i.user,date:i.date,punches:[]}),a[c].punches.push({punch_in:i.punchin_time,punch_out:i.punchout_time||null,id:i.id,date:i.date})),a},{});return Object.values(H).map(a=>{if(a.punches.length===0)return{...a,punchin_time:null,punchout_time:null,total_work_minutes:0,punch_count:0,complete_punches:0,has_incomplete_punch:!1};a.punches.sort((_,u)=>{if(!_.punch_in)return 1;if(!u.punch_in)return-1;const h=new Date(`${_.date}T${_.punch_in}`),w=new Date(`${u.date}T${u.punch_in}`);return h-w});const i=a.punches[0],c=a.punches.filter(_=>_.punch_out);let m=null;c.length>0&&(c.sort((_,u)=>{const h=new Date(`${_.date}T${_.punch_out}`);return new Date(`${u.date}T${u.punch_out}`)-h}),m=c[0]);let f=0,k=0,F=!1;return a.punches.forEach(_=>{if(_.punch_in&&_.punch_out){const u=_.date.split("T")[0],h=new Date(`${u}T${_.punch_in}`),w=new Date(`${u}T${_.punch_out}`);if(!isNaN(h.getTime())&&!isNaN(w.getTime())){const $=w-h;$>0&&(f+=$/(1e3*60),k++)}}else _.punch_in&&!_.punch_out&&(F=!0)}),{...a,punchin_time:(i==null?void 0:i.punch_in)||null,punchout_time:(m==null?void 0:m.punch_out)||null,total_work_minutes:Math.round(f*100)/100,punch_count:a.punches.length,complete_punches:k,has_incomplete_punch:F,first_punch_date:(i==null?void 0:i.date)||a.date,last_punch_date:(m==null?void 0:m.date)||a.date}})},zt=({handleDateChange:V,selectedDate:g,updateTimeSheet:H})=>{const{auth:K}=we().props,{url:a}=we(),i=Oe(),c=ye("(min-width: 1025px)"),m=ye("(min-width: 641px) and (max-width: 1024px)"),[f,k]=p.useState([]),[F,_]=p.useState([]),[u,h]=p.useState([]),[w,$]=p.useState(""),[I,Q]=p.useState(0),[Ce,ve]=p.useState(0),[B,gt]=p.useState(10),[U,Te]=p.useState(1),[R,Ee]=p.useState(""),[q,se]=p.useState(!1),[pe,Pe]=p.useState(0),[N,Ae]=p.useState({currentMonth:Y().format("YYYY-MM")}),[X,Z]=p.useState(2),re=p.useRef(null),ae=p.useRef(null),oe=async(e,x,o,b,C,r=!1)=>{var S,L,T,W;const d=a!=="/attendance-employee"?route("getAllUsersAttendanceForDate"):route("getCurrentUserAttendanceForDate");try{se(!1);const v=await je.get(d,{params:{page:x,perPage:o,employee:b,date:e,currentYear:C.currentMonth?Y(C.currentMonth).year():"",currentMonth:C.currentMonth?Y(C.currentMonth).format("MM"):"",_t:r?Date.now():void 0}});if(v.status===200){const n=a==="/attendance-employee",y=_t(v.data.attendances,n);k(y),_(v.data.leaves),h(v.data.absent_users),Q(y.length),ve(Math.ceil(y.length/o)),$(""),se(!0)}}catch(v){$(((L=(S=v.response)==null?void 0:S.data)==null?void 0:L.message)||"An error occurred while retrieving attendance data."),h(((W=(T=v.response)==null?void 0:T.data)==null?void 0:W.absent_users)||[]),se(!0)}},Me=p.useCallback(()=>{Pe(e=>e+1),oe(g,U,B,R,N,!0)},[g,U,B,R,N]),M=p.useCallback(()=>{if(re.current&&ae.current){const e=re.current.clientHeight,x=ae.current.clientHeight,o=e-150,b=Math.max(1,Math.floor(o/x));Z(b)}},[]),Le=e=>{Ee(e.target.value.toLowerCase())},Fe=e=>{Te(e)},Ie=p.useCallback((e,x)=>{Ae(o=>({...o,[e]:x}))},[]),Ue=()=>{Z(e=>e+2)},J=e=>F.find(x=>String(x.user_id)===String(e)),de=e=>{switch(e==null?void 0:e.toLowerCase()){case"approved":return t(lt,{className:"w-4 h-4 text-success"});case"rejected":return t(ot,{className:"w-4 h-4 text-danger"});default:return t(D,{className:"w-4 h-4 text-warning"})}},Re=e=>{switch(e==null?void 0:e.toLowerCase()){case"approved":return"success";case"rejected":return"danger";default:return"warning"}},We=[{name:"Date",uid:"date",icon:G},...K.roles.includes("Administrator")&&a!=="/attendance-employee"?[{name:"Employee",uid:"employee",icon:ue}]:[],{name:"Clock In",uid:"clockin_time",icon:D},{name:"Clock Out",uid:"clockout_time",icon:D},{name:"Work Hours",uid:"production_time",icon:D},{name:"Punches",uid:"punch_details",icon:D}],ze=(e,x)=>{var o,b,C;switch(x){case"date":return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(G,{className:"w-4 h-4 text-primary"}),s(l,{className:"flex flex-col",children:[t("span",{children:new Date(e.first_punch_date||e.date).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.last_punch_date&&e.last_punch_date!==e.first_punch_date&&s("span",{className:"text-xs text-default-500",children:["to ",new Date(e.last_punch_date).toLocaleString("en-US",{month:"short",day:"numeric"})]})]})]})});case"employee":return t(A,{className:"whitespace-nowrap text-xs sm:text-sm md:text-base",children:t(ft,{avatarProps:{radius:"lg",size:c||m?"md":"sm",src:(o=e.user)==null?void 0:o.profile_image,fallback:t(ue,{className:"w-6 h-6"})},description:(b=e.user)==null?void 0:b.phone,name:(C=e.user)==null?void 0:C.name})});case"clockin_time":return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(D,{className:"w-4 h-4 text-success"}),s(l,{className:"flex flex-col",children:[t("span",{children:e.punchin_time?new Date(`2024-06-04T${e.punchin_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"Not clocked in"}),e.punchin_time&&t("span",{className:"text-xs text-default-500",children:"First punch"})]})]})});case"clockout_time":return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(D,{className:"w-4 h-4 text-danger"}),s(l,{className:"flex flex-col",children:[t("span",{children:e.punchout_time?new Date(`2024-06-04T${e.punchout_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):e.punchin_time?"Still working":"Not started"}),e.punchout_time&&t("span",{className:"text-xs text-default-500",children:"Last punch"})]})]})});case"production_time":const d=e.total_work_minutes>0,S=e.has_incomplete_punch;if(d){const L=Math.floor(e.total_work_minutes/60),T=Math.floor(e.total_work_minutes%60);return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(D,{className:`w-4 h-4 ${S?"text-warning":"text-primary"}`}),s(l,{className:"flex flex-col",children:[t("span",{className:"font-medium",children:`${L}h ${T}m`}),t("span",{className:"text-xs text-default-500",children:S?"Partial + In Progress":"Total worked"})]})]})})}else if(S||e.punchin_time&&!e.punchout_time)return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(D,{className:"w-4 h-4 text-warning"}),s(l,{className:"flex flex-col",children:[t("span",{className:"text-warning",children:"In Progress"}),t("span",{className:"text-xs text-default-500",children:"Currently working"})]})]})});return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(ne,{className:"w-4 h-4 text-warning"}),s(l,{className:"flex flex-col",children:[t("span",{className:"text-warning",children:"No work time"}),t("span",{className:"text-xs text-default-500",children:"Incomplete punches"})]})]})});case"punch_details":return t(A,{className:"text-xs sm:text-sm md:text-base",children:s(l,{className:"flex items-center gap-2",children:[t(D,{className:"w-4 h-4 text-default-400"}),s(l,{className:"flex flex-col",children:[s("span",{className:"text-xs font-medium",children:[e.punch_count||0," punch",(e.punch_count||0)!==1?"es":""]}),e.complete_punches!==e.punch_count&&s("span",{className:"text-xs text-warning",children:[e.complete_punches," complete"]}),e.complete_punches===e.punch_count&&e.punch_count>0&&t("span",{className:"text-xs text-success",children:"All complete"})]})]})});default:return t(A,{className:"text-xs sm:text-sm md:text-base",children:"N/A"})}},Ye=p.useCallback(()=>{try{const e=[];f.forEach((n,y)=>{var fe,_e,ge,xe;const j=Math.floor(n.total_work_minutes/60),ee=Math.floor(n.total_work_minutes%60),le=n.total_work_minutes>0?`${j}h ${ee}m`:n.has_incomplete_punch?"In Progress":"No work time",O=n.complete_punches===n.punch_count&&n.punch_count>0?"Complete":n.has_incomplete_punch?"In Progress":"Incomplete";e.push({"No.":e.length+1,Date:new Date(n.first_punch_date||n.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),"Employee Name":((fe=n.user)==null?void 0:fe.name)||"N/A","Employee ID":((_e=n.user)==null?void 0:_e.employee_id)||"N/A",Designation:((ge=n.user)==null?void 0:ge.designation_name)||"N/A",Phone:((xe=n.user)==null?void 0:xe.phone)||"N/A","Clock In":n.punchin_time?new Date(`2024-06-04T${n.punchin_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"Not clocked in","Clock Out":n.punchout_time?new Date(`2024-06-04T${n.punchout_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):n.punchin_time?"Still working":"Not started","Work Hours":le,"Total Punches":n.punch_count||0,"Complete Punches":n.complete_punches||0,Status:O,Remarks:O==="Complete"?"Present - All punches complete":O==="In Progress"?"Present - Currently working":"Present - Incomplete punches"})}),u.forEach(n=>{const y=J(n.id);let j="Absent without leave";if(y){const ee=y.from_date===y.to_date?y.from_date:`${y.from_date} to ${y.to_date}`;j=`On ${y.leave_type} Leave (${ee}) - Status: ${y.status}`}e.push({"No.":e.length+1,Date:new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),"Employee Name":n.name||"N/A","Employee ID":n.employee_id||"N/A",Designation:n.designation_name||"N/A",Phone:n.phone||"N/A","Clock In":"Absent","Clock Out":"Absent","Work Hours":"0h 0m","Total Punches":0,"Complete Punches":0,Status:"Absent",Remarks:j})});const x=te.book_new(),b=[[a==="/attendance-employee"?`Employee Timesheet - ${new Date(N.currentMonth).toLocaleString("en-US",{month:"long",year:"numeric"})}`:`Daily Timesheet - ${new Date(g).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}`],[`Generated on: ${new Date().toLocaleString("en-US")}`],[`Total Employees: ${e.length} (Present: ${f.length}, Absent: ${u.length})`],[],["No.","Date","Employee Name","Employee ID","Designation","Phone","Clock In","Clock Out","Work Hours","Total Punches","Complete Punches","Status","Remarks"]],C=e.map(n=>[n["No."],n.Date,n["Employee Name"],n["Employee ID"],n.Designation,n.Phone,n["Clock In"],n["Clock Out"],n["Work Hours"],n["Total Punches"],n["Complete Punches"],n.Status,n.Remarks]),r=[...b,...C],d=te.aoa_to_sheet(r),S=[{wch:5},{wch:12},{wch:20},{wch:12},{wch:20},{wch:15},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:40}];d["!cols"]=S,d["!merges"]=[{s:{r:0,c:0},e:{r:0,c:12}},{s:{r:1,c:0},e:{r:1,c:12}},{s:{r:2,c:0},e:{r:2,c:12}}];const L={font:{bold:!0,sz:16},alignment:{horizontal:"center"}};d.A1&&(d.A1.s=L);const T=["A5","B5","C5","D5","E5","F5","G5","H5","I5","J5","K5","L5","M5"];T.forEach(n=>{d[n]&&(d[n].s={font:{bold:!0},fill:{fgColor:{rgb:"E3F2FD"}},alignment:{horizontal:"center"}})});const W=6;e.forEach((n,y)=>{const j=W+y;n.Status==="Absent"&&T.forEach((ee,le)=>{const O=te.encode_cell({r:j-1,c:le});d[O]&&(d[O].s={fill:{fgColor:{rgb:"FFEBEE"}},font:{color:{rgb:"D32F2F"}}})})}),te.book_append_sheet(x,d,"Timesheet");const v=a==="/attendance-employee"?`Employee_Timesheet_${Y(N.currentMonth).format("YYYY_MM")}.xlsx`:`Daily_Timesheet_${Y(g).format("YYYY_MM_DD")}.xlsx`;Ze(x,v)}catch(e){console.error("Error generating Excel file:",e),alert("Error generating Excel file. Please try again.")}},[f,u,g,N,a,J]),He=p.useCallback(()=>{try{const e=new et,x=a==="/attendance-employee"?`Employee Timesheet - ${new Date(N.currentMonth).toLocaleString("en-US",{month:"long",year:"numeric"})}`:`Daily Timesheet - ${new Date(g).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}`;e.setFontSize(18),e.setFont("helvetica","bold"),e.text(x,e.internal.pageSize.getWidth()/2,20,{align:"center"}),e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Generated on: ${new Date().toLocaleString("en-US")}`,14,35),e.text(`Total Employees: ${f.length+u.length} (Present: ${f.length}, Absent: ${u.length})`,14,42);const o=[];f.forEach((r,d)=>{var n;const S=Math.floor(r.total_work_minutes/60),L=Math.floor(r.total_work_minutes%60),T=r.total_work_minutes>0?`${S}h ${L}m`:r.has_incomplete_punch?"In Progress":"No work time",W=r.complete_punches===r.punch_count&&r.punch_count>0?"Complete":r.has_incomplete_punch?"In Progress":"Incomplete",v=W==="Complete"?"Present - All complete":W==="In Progress"?"Present - Working":"Present - Incomplete";o.push([o.length+1,new Date(r.first_punch_date||r.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),((n=r.user)==null?void 0:n.name)||"N/A",r.punchin_time?new Date(`2024-06-04T${r.punchin_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"Not clocked in",r.punchout_time?new Date(`2024-06-04T${r.punchout_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):r.punchin_time?"Still working":"Not started",T,`${r.complete_punches}/${r.punch_count}`,v])}),u.forEach(r=>{const d=J(r.id);let S="Absent without leave";d&&(S=`On ${d.leave_type} Leave - ${d.status}`),o.push([o.length+1,new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),r.name||"N/A","Absent","Absent","0h 0m","0/0",S])}),nt(e,{head:[["No.","Date","Employee","Clock In","Clock Out","Work Hours","Punches","Remarks"]],body:o,startY:50,theme:"grid",styles:{fontSize:7,cellPadding:2,lineColor:[200,200,200],lineWidth:.5},headStyles:{fillColor:[66,139,202],textColor:[255,255,255],fontStyle:"bold",fontSize:8},alternateRowStyles:{fillColor:[245,245,245]},columnStyles:{0:{cellWidth:12,halign:"center"},1:{cellWidth:20},2:{cellWidth:30},3:{cellWidth:20},4:{cellWidth:20},5:{cellWidth:18},6:{cellWidth:15,halign:"center"},7:{cellWidth:35}},margin:{top:10,left:14,right:14},didParseCell:function(r){if(r.row.index>=0){const d=o[r.row.index];d&&d[7]&&(d[7].includes("Absent")||d[7].includes("Leave"))&&(r.cell.styles.fillColor=[255,235,238],r.cell.styles.textColor=[211,47,47])}}});const b=e.internal.getNumberOfPages();for(let r=1;r<=b;r++)e.setPage(r),e.setFontSize(8),e.setFont("helvetica","normal"),e.text(`Page ${r} of ${b}`,e.internal.pageSize.getWidth()-30,e.internal.pageSize.getHeight()-10),e.text("Generated by Glass ERP System",14,e.internal.pageSize.getHeight()-10);const C=a==="/attendance-employee"?`Employee_Timesheet_${Y(N.currentMonth).format("YYYY_MM")}.pdf`:`Daily_Timesheet_${Y(g).format("YYYY_MM_DD")}.pdf`;e.save(C)}catch(e){console.error("Error generating PDF file:",e),alert("Error generating PDF file. Please try again.")}},[f,u,g,N,a,J]);return p.useEffect(()=>{Z(2);const e=setTimeout(()=>{M()},100);return window.addEventListener("resize",M),()=>{clearTimeout(e),window.removeEventListener("resize",M)}},[u,H,M]),p.useEffect(()=>{oe(g,U,B,R,N)},[g,U,B,R,N,H,pe]),p.useEffect(()=>{Z(2);const e=setTimeout(()=>{M()},100);return window.addEventListener("resize",M),()=>{clearTimeout(e),window.removeEventListener("resize",M)}},[u,H,M]),p.useEffect(()=>{oe(g,U,B,R,N)},[g,U,B,R,N,H,pe]),t(l,{sx:{display:"flex",justifyContent:"center",p:2},component:"main",role:"main","aria-label":"Timesheet Management",children:s(z,{container:!0,spacing:2,children:[t(z,{item:!0,xs:12,md:a!=="/attendance-employee"?9:12,children:t(Ne,{in:!0,timeout:500,children:s(ke,{children:[t(be,{title:s(l,{className:"flex items-center gap-3",children:[t(D,{className:"w-6 h-6 text-primary"}),t(E,{variant:"h5",component:"h1",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem",md:"1.75rem"},fontWeight:600},children:a==="/attendance-employee"?`Timesheet - ${new Date(N.currentMonth).toLocaleString("en-US",{month:"long",year:"numeric"})}`:`Daily Timesheet - ${new Date(g).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}`})]}),action:s(Ge,{direction:"row",spacing:1,children:[t(ie,{title:"Download as Excel",children:t(ce,{onClick:Ye,disabled:!q||f.length===0,sx:{background:P(i.palette.success.main,.1),backdropFilter:"blur(10px)",border:`1px solid ${P(i.palette.success.main,.2)}`,"&:hover":{background:P(i.palette.success.main,.2),transform:"scale(1.05)"},"&:disabled":{opacity:.5}},children:t(st,{sx:{color:i.palette.success.main}})})}),t(ie,{title:"Download as PDF",children:t(ce,{onClick:He,disabled:!q||f.length===0,sx:{background:P(i.palette.error.main,.1),backdropFilter:"blur(10px)",border:`1px solid ${P(i.palette.error.main,.2)}`,"&:hover":{background:P(i.palette.error.main,.2),transform:"scale(1.05)"},"&:disabled":{opacity:.5}},children:t(tt,{sx:{color:i.palette.error.main}})})}),t(ie,{title:"Refresh Timesheet",children:t(ce,{onClick:Me,disabled:!q,sx:{background:P(i.palette.primary.main,.1),backdropFilter:"blur(10px)",border:`1px solid ${P(i.palette.primary.main,.2)}`,"&:hover":{background:P(i.palette.primary.main,.2),transform:"scale(1.05)"},"&:disabled":{opacity:.5}},children:t(rt,{color:"primary"})})})]}),sx:{padding:"24px"}}),t($e,{}),t(me,{children:t(l,{component:"section",role:"search","aria-label":"Timesheet filters",children:s(z,{container:!0,spacing:3,children:[K.roles.includes("Administrator")&&a!=="/attendance-employee"&&s(Be,{children:[t(z,{item:!0,xs:12,sm:6,md:4,children:t(he,{label:"Search Employee",type:"text",fullWidth:!0,variant:"bordered",placeholder:"Enter employee name...",value:R,onChange:Le,startContent:t(at,{className:"w-4 h-4 text-default-400"}),"aria-label":"Search employees"})}),t(z,{item:!0,xs:12,sm:6,md:4,children:t(he,{label:"Select Date",type:"date",variant:"bordered",onChange:V,value:new Date(g).toISOString().slice(0,10)||"",startContent:t(G,{className:"w-4 h-4 text-default-400"}),"aria-label":"Select date for timesheet"})})]}),K.roles.includes("Employee")&&a==="/attendance-employee"&&t(z,{item:!0,xs:12,sm:6,md:4,children:t(he,{label:"Select Month",type:"month",fullWidth:!0,variant:"bordered",placeholder:"Select month...",value:N.currentMonth,onChange:e=>Ie("currentMonth",e.target.value),startContent:t(G,{className:"w-4 h-4 text-default-400"}),"aria-label":"Select month for timesheet"})})]})})}),t(me,{children:w?t(De,{className:"p-4 bg-danger-50 border-danger-200",children:s(l,{className:"flex items-center gap-3",children:[t(ne,{className:"w-5 h-5 text-danger"}),t(E,{color:"error",variant:"body1",children:w})]})}):s(l,{sx:{maxHeight:"70vh"},role:"region","aria-label":"Attendance data table",children:[t(Je,{orientation:"horizontal",className:"overflow-y-hidden",children:t(it,{className:"rounded-lg",isLoaded:q,children:s(ct,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,removeWrapper:!0,"aria-label":"Employee attendance timesheet table",isHeaderSticky:!0,children:[t(mt,{columns:We,children:e=>t(ut,{align:"start",children:s(l,{className:"flex items-center gap-2",children:[e.icon&&t(e.icon,{className:"w-4 h-4"}),t("span",{children:e.name})]})},e.uid)}),t(ht,{items:f,emptyContent:s(l,{className:"flex flex-col items-center justify-center py-8",children:[t(D,{className:"w-12 h-12 text-default-300 mb-4"}),t(E,{variant:"body1",color:"textSecondary",children:"No attendance records found"})]}),children:e=>t(pt,{children:x=>ze(e,x)},e.user_id)})]})})}),I>10&&t(l,{className:"py-4 flex justify-center",children:t(dt,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:U,total:Ce,onChange:Fe,"aria-label":"Timesheet pagination"})})]})})]})})}),K.roles.includes("Administrator")&&a!=="/attendance-employee"&&u.length>0&&t(z,{item:!0,xs:12,md:3,children:t(Ne,{in:!0,timeout:700,children:s(ke,{ref:re,children:[t(be,{title:s(l,{className:"flex items-center justify-between",children:[s(l,{className:"flex items-center gap-2",children:[t(Qe,{className:"w-5 h-5 text-warning"}),t(E,{variant:"h6",component:"h2",sx:{fontSize:{xs:"1rem",sm:"1.1rem",md:"1.2rem"},fontWeight:600},children:"Absent"})]}),t(Se,{label:u.length,variant:"flat",color:"warning",size:"sm",startContent:t(ne,{className:"w-3 h-3"})})]}),subheader:s(E,{variant:"body2",color:"textSecondary",className:"flex items-center gap-1",children:[t(G,{className:"w-4 h-4"}),new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})}),t($e,{}),t(me,{children:s(l,{role:"region","aria-label":"Absent employees list",children:[u.slice(0,X).map((e,x)=>{const o=J(e.id),b=x===0?ae:null;return t(Ve,{in:x<X,timeout:"auto",unmountOnExit:!0,children:t(De,{ref:b,className:"mb-3 p-3 bg-default-50 border-default-200",shadow:"sm",children:s(l,{className:"flex items-start justify-between",children:[s(l,{className:"flex items-center gap-3 flex-1",children:[t(qe,{src:e.profile_image,alt:e.name,size:"sm",fallback:t(ue,{className:"w-4 h-4"})}),s(l,{children:[t(E,{variant:"body2",fontWeight:"medium",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:e.name}),o?s(l,{className:"flex flex-col gap-1 mt-1",children:[s(E,{variant:"caption",color:"textSecondary",className:"flex items-center gap-1",children:[t(G,{className:"w-3 h-3"}),o.from_date===o.to_date?o.from_date:`${o.from_date} - ${o.to_date}`]}),s(E,{variant:"caption",color:"primary",className:"flex items-center gap-1",children:[de(o.status),o.leave_type," Leave"]})]}):s(E,{variant:"caption",color:"error",className:"flex items-center gap-1 mt-1",children:[t(ne,{className:"w-3 h-3"}),"Absent without leave"]})]})]}),o&&t(Se,{label:o.status,variant:"flat",color:Re(o.status),size:"sm",startContent:de(o.status)})]})})},e.id)}),X<u.length&&t(l,{className:"text-center mt-3",children:s(Ke,{variant:"outlined",onClick:Ue,startIcon:t(Xe,{className:"w-4 h-4"}),size:"small",children:["Show More (",u.length-X," remaining)"]})})]})})]})})})]})})};export{zt as default};
