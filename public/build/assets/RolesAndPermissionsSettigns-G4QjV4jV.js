import{r as F,j as n,a as t}from"./app-zs-SEecS.js";import{K,q as Z,r as a,G as f,f as s,Z as j,$ as T,a0 as _,B as v,C as J,L as Q,N as I,j as X,k as Y,l as O,m as c,n as ee,a1 as g,U as x,V as D,W as S}from"./vendor-D-JNEeQ3.js";import{d as te}from"./Edit-BfZLgRcJ.js";import{d as ne}from"./Delete-i0136_TX.js";var k={},le=K;Object.defineProperty(k,"__esModule",{value:!0});var P=k.default=void 0,ae=le(F()),oe=Z;P=k.default=(0,ae.default)((0,oe.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");const ce=()=>{const[i,h]=a.useState([]),[N,L]=a.useState([]),[o,m]=a.useState({}),[q,A]=a.useState(!1),[w,E]=a.useState(!1),[B,y]=a.useState(!1),[b,M]=a.useState(""),[r,p]=a.useState([]);useEffect(()=>{axios.get("/api/roles-permissions").then(e=>{h(e.data.roles),L(e.data.permissions)}).catch(e=>console.error(e))},[]);const W=()=>A(!0),u=()=>A(!1),$=e=>{m(e),p(e.permissions.map(l=>l.name)),E(!0)},R=()=>E(!1),G=e=>{m(e),y(!0)},C=()=>y(!1),H=()=>{axios.post("/api/roles",{name:b,permissions:r}).then(e=>{h([...i,e.data.role]),u()}).catch(e=>console.error(e))},U=()=>{axios.put(`/api/roles/${o.id}`,{name:o.name,permissions:r}).then(e=>{const l=i.map(d=>d.id===o.id?e.data.role:d);h(l),R()}).catch(e=>console.error(e))},V=e=>{r.includes(e)?p(r.filter(l=>l!==e)):p([...r,e])};return n(f,{container:!0,spacing:2,children:[n(f,{item:!0,xs:12,sm:4,md:4,lg:3,children:[t(s,{variant:"contained",startIcon:t(P,{}),onClick:W,fullWidth:!0,children:"Add Roles"}),t(v,{mt:2,children:t(j,{children:i.map((e,l)=>n(T,{selected:l===0,button:!0,children:[t(_,{primary:e}),n(v,{children:[t(te,{onClick:()=>$(e),style:{cursor:"pointer",marginRight:"10px"}}),t(ne,{onClick:()=>G(e),style:{cursor:"pointer"}})]})]},l))})})]}),t(f,{item:!0,xs:12,sm:8,md:8,lg:9,children:n(J,{children:[n(v,{p:2,children:[t("h6",{children:"Module Access"}),t(j,{children:N.map(e=>n(T,{children:[t(_,{primary:e.name}),t(Q,{control:t(I,{checked:r.includes(e.name),onChange:()=>V(e.name)})})]},e.id))})]}),n(X,{children:[t(Y,{children:n(O,{children:[t(c,{children:"Module Permission"}),["Read","Write","Create","Delete","Import","Export"].map((e,l)=>t(c,{align:"center",children:e},l))]})}),t(ee,{children:i.map(e=>n(O,{children:[t(c,{children:e.name}),["Read","Write","Create","Delete","Import","Export"].map((l,d)=>t(c,{align:"center",children:t(I,{defaultChecked:e.permissions.some(z=>z.name===l)})},d))]},e.id))})]})]})}),n(g,{open:q,onClose:u,children:[t(x,{children:"Add Role"}),t(D,{children:t("input",{type:"text",placeholder:"Role Name",value:b,onChange:e=>M(e.target.value)})}),n(S,{children:[t(s,{onClick:u,children:"Cancel"}),t(s,{variant:"contained",onClick:H,children:"Save"})]})]}),n(g,{open:w,onClose:R,children:[n(x,{children:["Edit Role: ",o.name]}),t(D,{children:t("input",{type:"text",placeholder:"Role Name",value:o.name,onChange:e=>m({...o,name:e.target.value})})}),n(S,{children:[t(s,{onClick:R,children:"Cancel"}),t(s,{variant:"contained",onClick:U,children:"Save"})]})]}),n(g,{open:B,onClose:C,children:[n(x,{children:["Delete Role: ",o.name,"?"]}),t(D,{children:"Are you sure you want to delete this role?"}),n(S,{children:[t(s,{onClick:C,children:"Cancel"}),t(s,{variant:"contained",color:"error",onClick:C,children:"Delete"})]})]})]})};export{ce as default};
