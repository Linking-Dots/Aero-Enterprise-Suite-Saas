import{j as $,R as A,J as N,r as n,g as B,b as e,a as l,Q as H,i as T,F as W}from"./app-DMbZ8egF.js";import{c as P,u as E,e as D,f as g,z as b,b as I,d as j,E as L,W as Y,X as f,I as v,B as y,T as z,A as O}from"./App-DBihHj7U.js";import{P as Q}from"./PageHeader-Dkz_rrRt.js";import{S as _}from"./StatsCards-B_piGP08.js";import G from"./TimeSheetTable-Dzg1snRZ.js";import{F as V}from"./CheckCircleIcon-CPp_yjo1.js";import{F as J}from"./XCircleIcon-b-Y9KmSO.js";import{F as U}from"./ExclamationTriangleIcon-BvVa33WY.js";import{F as X}from"./ChartBarIcon-BTm8n4vW.js";import{F as q}from"./UserIcon-D2DuDTuw.js";import{C as K}from"./CardHeader-c37JMDG-.js";import{P as Z}from"./PictureAsPdf-DfXxB1vq.js";import{R as ee}from"./Refresh-i2y8PpT9.js";import{C as te}from"./CardContent-B0Zh1gK5.js";import{F as ae}from"./DocumentArrowDownIcon-bgUsMNtg.js";import{F as re}from"./PresentationChartLineIcon-Cpmk3w7f.js";import{a as o}from"./colorManipulator-B4EFOkEC.js";import"./app-DbVQyYWD.js";import"./chunk-D5XJWRAV-C0iPUUQx.js";import"./dayjs.min-CjVTJRzo.js";import"./jspdf.es.min-B_lr8YdN.js";import"./jspdf.plugin.autotable-TLQB5wf7.js";import"./Button-CM9hwAIJ.js";import"./chunk-TLYTI3QM-BZq_GWk0.js";import"./chunk-F3UDT23P-DtFhl1MB.js";import"./useHasTabbableChild-BXtalMCB.js";import"./chunk-7F3ZLNJ6-CCnKMx8B.js";import"./chunk-O5I3QTYU-CsHrxnEj.js";import"./index-CokAva9Y.js";import"./chunk-R6AK6OQ4-7JPU21Vm.js";const oe=P($.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload"),se=A.memo(({title:d,totalWorkingDays:ne,presentDays:ie,absentDays:le,lateArrivals:ce})=>{const{auth:de}=N().props,a=E(),F=D(a.breakpoints.down("sm"));D(a.breakpoints.down("md"));const[w,m]=n.useState(new Date),[S,c]=n.useState(!1),[p,me]=n.useState(!1),[s,h]=n.useState({currentMonth:new Date().toISOString().slice(0,7)}),[r,k]=n.useState({totalWorkingDays:0,totalDaysInMonth:0,holidaysCount:0,weekendsCount:0,presentDays:0,absentDays:0,lateArrivals:0,attendancePercentage:0,averageWorkHours:0,overtimeHours:0,totalWorkHours:0,totalLeaveDays:0,leaveBreakdown:{},month:"",generated_at:null}),M=t=>{const u=t.target.value;m(new Date(u)),c(i=>!i)},R=n.useCallback((t,u)=>{h(i=>({...i,[t]:u})),c(i=>!i)},[]),x=n.useCallback(async()=>{try{const t=await B.get(route("attendance.myMonthlyStats"),{params:{currentYear:s.currentMonth?new Date(s.currentMonth).getFullYear():new Date().getFullYear(),currentMonth:s.currentMonth?String(new Date(s.currentMonth).getMonth()+1).padStart(2,"0"):String(new Date().getMonth()+1).padStart(2,"0")}});t.data.success&&k(t.data.data)}catch(t){console.error("Failed to fetch monthly stats:",t)}},[s.currentMonth]);n.useEffect(()=>{x()},[x]);const C=[{title:"Working Days",value:r.totalWorkingDays,icon:e(g,{}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:`Total for ${r.month||"this month"}`},{title:"Present Days",value:r.presentDays,icon:e(V,{}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Days attended this month"},{title:"Absent Days",value:r.absentDays,icon:e(J,{}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Days missed this month"},{title:"Late Arrivals",value:r.lateArrivals,icon:e(U,{}),color:"text-orange-400",iconBg:"bg-orange-500/20",description:"Times late this month"},{title:"Attendance Rate",value:`${r.attendancePercentage}%`,icon:e(X,{}),color:"text-emerald-400",iconBg:"bg-emerald-500/20",description:"Your monthly performance"},{title:"Avg Work Hours",value:`${r.averageWorkHours}h`,icon:e(b,{}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"Daily average this month"},{title:"Overtime",value:`${r.overtimeHours}h`,icon:e(b,{}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Extra hours this month"},{title:"Leave Days",value:r.totalLeaveDays,icon:e(q,{}),color:"text-amber-400",iconBg:"bg-amber-500/20",description:"Leaves taken this month"}];return l(W,{children:["            ",e(H,{title:d||"My Attendance"}),e(y,{sx:{display:"flex",justifyContent:"center",p:2},children:e(I,{in:!0,children:e(j,{children:e(Q,{title:"My Attendance",subtitle:"View your attendance records and timesheet details",icon:e(re,{className:"w-8 h-8"}),variant:"default",actionButtons:[{label:"Today",icon:e(g,{className:"w-4 h-4"}),onPress:()=>{m(new Date),h({currentMonth:new Date().toISOString().slice(0,7)}),c(t=>!t)},className:"bg-gradient-to-r from-[rgba(var(--theme-primary-rgb),0.2)] to-[rgba(var(--theme-secondary-rgb),0.2)] hover:from-[rgba(var(--theme-primary-rgb),0.3)] hover:to-[rgba(var(--theme-secondary-rgb),0.3)] border border-[rgba(var(--theme-primary-rgb),0.3)]"},{label:"Export",icon:e(ae,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-success-rgb),0.3)] bg-[rgba(var(--theme-success-rgb),0.05)] hover:bg-[rgba(var(--theme-success-rgb),0.1)]"}],children:l("div",{className:"p-6",children:[e(_,{stats:C,className:"mb-6"}),e("div",{className:"mb-6",children:e("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:e("div",{className:"w-full sm:w-auto sm:min-w-[200px]",children:e(L,{label:"Month/Year",type:"month",value:s.currentMonth,onChange:t=>R("currentMonth",t.target.value),startContent:e(g,{className:"w-4 h-4"}),variant:"bordered",classNames:{inputWrapper:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},size:F?"sm":"md"})})})}),l("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[e(K,{title:l(y,{className:"flex items-center gap-3",children:[e(b,{className:"w-6 h-6 text-primary"}),e(z,{variant:"h5",component:"h1",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem",md:"1.75rem"},fontWeight:600},children:"My Attendance Records"})]}),action:l(Y,{direction:"row",spacing:1,children:[e(f,{title:"Download as Excel",children:e(v,{disabled:p,sx:{background:o(a.palette.success.main,.1),backdropFilter:"blur(10px)",border:`1px solid ${o(a.palette.success.main,.2)}`,"&:hover":{background:o(a.palette.success.main,.2),transform:"scale(1.05)"},"&:disabled":{opacity:.5}},children:e(oe,{sx:{color:a.palette.success.main}})})}),e(f,{title:"Download as PDF",children:e(v,{disabled:p,sx:{background:o(a.palette.error.main,.1),backdropFilter:"blur(10px)",border:`1px solid ${o(a.palette.error.main,.2)}`,"&:hover":{background:o(a.palette.error.main,.2),transform:"scale(1.05)"},"&:disabled":{opacity:.5}},children:e(Z,{sx:{color:a.palette.error.main}})})}),e(f,{title:"Refresh Data",children:e(v,{onClick:()=>{m(new Date),h({currentMonth:new Date().toISOString().slice(0,7)}),c(t=>!t)},disabled:p,sx:{background:o(a.palette.primary.main,.1),backdropFilter:"blur(10px)",border:`1px solid ${o(a.palette.primary.main,.2)}`,"&:hover":{background:o(a.palette.primary.main,.2),transform:"scale(1.05)"},"&:disabled":{opacity:.5}},children:e(ee,{color:"primary"})})})]}),sx:{padding:"24px"}}),e(T,{}),e(te,{children:e(y,{sx:{maxHeight:"84vh",overflowY:"auto"},children:e(G,{selectedDate:w,handleDateChange:M,updateTimeSheet:S,externalFilterData:s},`${w}-${s.currentMonth}`)})})]})]})})})})})]})});se.layout=d=>e(O,{children:d});export{se as default};
