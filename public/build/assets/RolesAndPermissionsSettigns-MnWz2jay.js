import{r as J,j as n,a as t}from"./app-DL9yb4nK.js";import{K,L as U,r as l,G as f,f as s,$ as O,a0 as T,a1 as _,B as v,C as X,N as Q,O as j,j as Y,k as Z,l as I,m as c,n as ee,a2 as g,V as x,W as D,X as S}from"./vendor-C1M8BoQX.js";import{d as te}from"./Edit-TeKWPbmJ.js";import{d as ne}from"./Delete-TXjtQ3r4.js";var k={},ae=U;Object.defineProperty(k,"__esModule",{value:!0});var P=k.default=void 0,le=ae(J()),oe=K();P=k.default=(0,le.default)((0,oe.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");const ce=()=>{const[i,h]=l.useState([]),[N,L]=l.useState([]),[o,m]=l.useState({}),[q,A]=l.useState(!1),[w,y]=l.useState(!1),[B,E]=l.useState(!1),[b,M]=l.useState(""),[r,u]=l.useState([]);useEffect(()=>{axios.get("/api/roles-permissions").then(e=>{h(e.data.roles),L(e.data.permissions)}).catch(e=>console.error(e))},[]);const W=()=>A(!0),p=()=>A(!1),$=e=>{m(e),u(e.permissions.map(a=>a.name)),y(!0)},R=()=>y(!1),G=e=>{m(e),E(!0)},C=()=>E(!1),H=()=>{axios.post("/api/roles",{name:b,permissions:r}).then(e=>{h([...i,e.data.role]),p()}).catch(e=>console.error(e))},V=()=>{axios.put(`/api/roles/${o.id}`,{name:o.name,permissions:r}).then(e=>{const a=i.map(d=>d.id===o.id?e.data.role:d);h(a),R()}).catch(e=>console.error(e))},z=e=>{r.includes(e)?u(r.filter(a=>a!==e)):u([...r,e])};return n(f,{container:!0,spacing:2,children:[n(f,{item:!0,xs:12,sm:4,md:4,lg:3,children:[t(s,{variant:"contained",startIcon:t(P,{}),onClick:W,fullWidth:!0,children:"Add Roles"}),t(v,{mt:2,children:t(O,{children:i.map((e,a)=>n(T,{selected:a===0,button:!0,children:[t(_,{primary:e}),n(v,{children:[t(te,{onClick:()=>$(e),style:{cursor:"pointer",marginRight:"10px"}}),t(ne,{onClick:()=>G(e),style:{cursor:"pointer"}})]})]},a))})})]}),t(f,{item:!0,xs:12,sm:8,md:8,lg:9,children:n(X,{children:[n(v,{p:2,children:[t("h6",{children:"Module Access"}),t(O,{children:N.map(e=>n(T,{children:[t(_,{primary:e.name}),t(Q,{control:t(j,{checked:r.includes(e.name),onChange:()=>z(e.name)})})]},e.id))})]}),n(Y,{children:[t(Z,{children:n(I,{children:[t(c,{children:"Module Permission"}),["Read","Write","Create","Delete","Import","Export"].map((e,a)=>t(c,{align:"center",children:e},a))]})}),t(ee,{children:i.map(e=>n(I,{children:[t(c,{children:e.name}),["Read","Write","Create","Delete","Import","Export"].map((a,d)=>t(c,{align:"center",children:t(j,{defaultChecked:e.permissions.some(F=>F.name===a)})},d))]},e.id))})]})]})}),n(g,{open:q,onClose:p,children:[t(x,{children:"Add Role"}),t(D,{children:t("input",{type:"text",placeholder:"Role Name",value:b,onChange:e=>M(e.target.value)})}),n(S,{children:[t(s,{onClick:p,children:"Cancel"}),t(s,{variant:"contained",onClick:H,children:"Save"})]})]}),n(g,{open:w,onClose:R,children:[n(x,{children:["Edit Role: ",o.name]}),t(D,{children:t("input",{type:"text",placeholder:"Role Name",value:o.name,onChange:e=>m({...o,name:e.target.value})})}),n(S,{children:[t(s,{onClick:R,children:"Cancel"}),t(s,{variant:"contained",onClick:V,children:"Save"})]})]}),n(g,{open:B,onClose:C,children:[n(x,{children:["Delete Role: ",o.name,"?"]}),t(D,{children:"Are you sure you want to delete this role?"}),n(S,{children:[t(s,{onClick:C,children:"Cancel"}),t(s,{variant:"contained",color:"error",onClick:C,children:"Delete"})]})]})]})};export{ce as default};
