import{a as e,j as n,V as I,F as C,M as q}from"./app-COej-qut.js";import{T as B,u as L,r as d,w as H,c as U,G as D,b as S,y as P,z as M,h as E,a2 as V,f as T,g as $,D as j,a as z,B as O}from"./vendor-jz9Knmfr.js";import{B as G,G as R,A as Y}from"./App-Bh__gnbe.js";import{d as J}from"./Edit-CBeApzZb.js";import{d as Q}from"./Delete-B5iZMYbI.js";import{a as X,b as Z,c as K,d as ee,e as te,t as re}from"./chunk-F3UDT23P-B9Bbk0MH.js";import{t as w}from"./chunk-CSXHODZI-B_ju90Id.js";import{d as ae,G as W}from"./GlassDialog-Sauekw8K.js";import{L as le}from"./LoadingButton-Qj6wJM8B.js";import{A as oe}from"./Add-VfapyybU.js";import"./chunk-MZRCPRP2-CkCeC-Il.js";import"./chunk-SLABUSGS-yLyu-M1S.js";import"./chunk-7F3ZLNJ6-CJy-mc9r.js";const se=({holidaysData:c,handleClickOpen:u,setCurrentHoliday:g,openModal:o,setHolidaysData:t})=>{const a=(r,s)=>{const l=r[s];switch(s){case"title":return l;case"from_date":return new Date(l).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"});case"to_date":return new Date(l).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"});case"actions":return n("div",{className:"relative flex items-center gap-2",children:[e(w,{content:"Edit Holiday",children:e("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>{g(r),o("edit_holiday")},children:e(J,{})})}),e(w,{content:"Delete Holiday",color:"danger",children:e("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>u(r.id,"delete_holiday"),children:e(Q,{})})})]});default:return l}},h=[{name:"Title",uid:"title"},{name:"From Date",uid:"from_date"},{name:"To Date",uid:"to_date"},{name:"Actions",uid:"actions"}];return e("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:c.length===0?e(B,{variant:"h6",align:"center",sx:{mt:2},children:"No holidays"}):n(re,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Holiday Table",children:[e(X,{columns:h,children:r=>e(Z,{align:r.uid==="actions"?"center":"start",children:r.name},r.uid)}),e(K,{items:c,children:r=>e(ee,{children:s=>e(te,{style:{whiteSpace:"nowrap"},children:a(r,s)})},r.id)})]})})},A=({open:c,closeModal:u,holidaysData:g,setHolidaysData:o,currentHoliday:t})=>{I().props;const a=L(),[h,r]=d.useState((t==null?void 0:t.title)||""),[s,l]=d.useState((t==null?void 0:t.from_date)||""),[f,p]=d.useState((t==null?void 0:t.to_date)||""),[m,k]=d.useState({}),[F,_]=d.useState(!1);return n(W,{open:c,onClose:u,fullWidth:!0,maxWidth:"sm",children:[n(H,{sx:{display:"flex",alignItems:"center"},children:[e(B,{variant:"h6",children:"Add Holiday"}),e(U,{onClick:u,sx:{position:"absolute",top:8,right:16},children:e(ae,{})})]}),n("form",{onSubmit:async y=>{y.preventDefault(),_(!0);const N=new Promise(async(x,b)=>{try{const i={title:h,fromDate:s,toDate:f};t&&(i.id=t.id);const v=await axios.post(route("holiday-add"),i);v.status===200&&(o(v.data.holidays),x([v.data.message||"Holiday added successfully"]),u())}catch(i){_(!1),i.response?(i.response.status===422?(k(i.response.data.errors||{}),b(i.response.statusText||"Failed to add holiday")):b("An unexpected error occurred. Please try again later."),console.error(i.response)):i.request?(b("No response received from the server. Please check your internet connection."),console.error(i.request)):(b("An error occurred while setting up the request."),console.error("Error",i.message))}finally{_(!1)}});G.promise(N,{pending:{render(){return n("div",{style:{display:"flex",alignItems:"center"},children:[e(E,{}),e("span",{style:{marginLeft:"8px"},children:"Adding holiday..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:a.glassCard.background,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:x}){return e(C,{children:x.map((b,i)=>e("div",{children:b},i))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:a.glassCard.background,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:x}){return e(C,{children:x})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:a.glassCard.background,border:a.glassCard.border,color:a.palette.text.primary}}})},children:[e(P,{children:n(D,{container:!0,spacing:2,children:[e(D,{item:!0,xs:12,md:6,children:e(S,{label:"Title",type:"text",fullWidth:!0,value:h,onChange:y=>r(y.target.value),InputLabelProps:{shrink:!0},error:!!m.title,helperText:m.title})}),e(D,{item:!0,xs:12,md:6,children:e(S,{label:"From",type:"date",fullWidth:!0,value:s,onChange:y=>l(y.target.value),InputLabelProps:{shrink:!0},error:!!m.fromDate,helperText:m.fromDate})}),e(D,{item:!0,xs:12,md:6,children:e(S,{label:"To",type:"date",fullWidth:!0,value:f,onChange:y=>p(y.target.value),InputLabelProps:{shrink:!0},error:!!m.toDate,helperText:m.toDate})})]})}),e(M,{sx:{padding:"16px",justifyContent:"center"},children:e(le,{type:"submit",variant:"outlined",color:"primary",loading:F,disabled:F,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},ie=({open:c,handleClose:u,holidayIdToDelete:g,setHolidaysData:o})=>{const t=L();return n(W,{open:c,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(H,{id:"alert-dialog-title",children:"Confirm Deletion"}),e(P,{children:e(V,{id:"alert-dialog-description",children:"Are you sure you want to delete this holiday? This action cannot be undone."})}),n(M,{children:[e(T,{onClick:u,color:"primary",children:"Cancel"}),e(T,{onClick:()=>{const h=new Promise(async(r,s)=>{try{const l=await axios.delete(route("holiday-delete",{id:g,route:route().current()}));l.status===200&&(o(l.data.holidays),r("Holiday deleted successfully"))}catch(l){console.error("Error deleting task:",l),s(l.response.data.error||"Failed to delete holiday")}finally{u()}});G.promise(h,{pending:{render(){return n("div",{style:{display:"flex",alignItems:"center"},children:[e(E,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting holiday..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}},success:{render({data:r}){return e(C,{children:r})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}},error:{render({data:r}){return e(C,{children:r})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})},ne=({title:c})=>{const{auth:u,holidays:g}=I().props,[o,t]=d.useState({type:null,holidayId:null,currentHoliday:null}),[a,h]=d.useState(g),r=d.useCallback((p,m=null,k=null)=>{t({type:p,holidayId:m,currentHoliday:k})},[]),s=d.useCallback(()=>{t({type:null,holidayId:null,currentHoliday:null})},[]),l=d.useCallback(p=>{h(p)},[]),f=d.useMemo(()=>({open:!!o.type,closeModal:s,setHolidaysData:l,holidaysData:a,currentHoliday:o.currentHoliday}),[o.type,s,l,a,o.currentHoliday]);return n(C,{children:[e(q,{title:c}),o.type==="add_holiday"&&e(A,{...f}),o.type==="edit_holiday"&&e(A,{...f}),o.type==="delete_holiday"&&e(ie,{open:!0,holidayId:o.holidayId,setHolidaysData:l,closeModal:s,holidaysData:a}),e(O,{sx:{p:2},children:n(R,{children:[e($,{title:"Leaves",sx:{padding:"24px"},action:e(T,{title:"Add Leave",variant:"outlined",startIcon:e(oe,{}),onClick:()=>r("add_holiday"),children:"Add Holiday"})}),e(j,{}),e(z,{children:e(se,{holidaysData:a,onEdit:p=>r("edit_holiday",null,p),onDelete:p=>r("delete_holiday",p)})})]})})]})};ne.layout=c=>e(Y,{children:c});export{ne as default};
