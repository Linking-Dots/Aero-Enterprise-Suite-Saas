import{r as p,c as b,J as Ae,a as me,b as l,j as r,R as Ne}from"./app-MneRgble.js";import{x as Pe,y as Fe,n as ve,_ as ye,o as w,ab as $e,p as X,s as ce,a2 as S,q as Se,ag as Be,a3 as je,e as _,u as De,P as J,c as He,B as v,d,K as q,f as H,ae as K,S as Ee,T as fe,I as ke,M as Ue,aX as Ve}from"./App-BrsLpbpS.js";import{C as Ye}from"./CardContent-DJHqYYNL.js";import{A as ze}from"./Avatar-B8N6wOt3.js";import{C as Ge}from"./CircularProgress-yciCqxzj.js";import{B as we}from"./Button-BdQwlRYB.js";import{S as Ze}from"./Security-BCPqVhu5.js";import{A as _e}from"./Alert-DIFeJgRb.js";import{L as Je,a as qe}from"./List-C5mxN75U.js";import{L as Ke}from"./ListItem-BRkkKDOL.js";import{b as Xe}from"./listItemTextClasses-GWTfNWn8.js";import{L as Qe}from"./ListItemText-Du4uiynO.js";import{D as et}from"./Divider-VUbezB85.js";import{a as tt,b as rt,c as ot}from"./DialogContent-Dv6mkc8K.js";import{C as at}from"./CheckCircle-CWPHlAuo.js";import{A as nt}from"./AccessTime-BnC1Ktze.js";import{R as it}from"./Refresh-73WlEJeb.js";import{a as i}from"./colorManipulator-tjqRUFfg.js";import"./app-CPPT5dG3.js";import"./useSlot-C5BMByKB.js";import"./dividerClasses-BJbxS9sQ.js";const Le=e=>{const n=p.useRef({});return p.useEffect(()=>{n.current=e}),n.current};function st(e){const{badgeContent:n,invisible:t=!1,max:s=99,showZero:u=!1}=e,m=Le({badgeContent:n,max:s});let h=t;t===!1&&n===0&&!u&&(h=!0);const{badgeContent:c,max:C=s}=h?m:e,O=c&&Number(c)>C?`${C}+`:c;return{badgeContent:c,invisible:h,max:C,displayValue:O}}function lt(e){return Fe("MuiBadge",e)}const F=Pe("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),ct=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],xe=10,be=4,dt=e=>{const{color:n,anchorOrigin:t,invisible:s,overlap:u,variant:m,classes:h={}}=e,c={root:["root"],badge:["badge",m,s&&"invisible",`anchorOrigin${S(t.vertical)}${S(t.horizontal)}`,`anchorOrigin${S(t.vertical)}${S(t.horizontal)}${S(u)}`,`overlap${S(u)}`,n!=="default"&&`color${S(n)}`]};return Se(c,lt,h)},pt=ce("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,n)=>n.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),ut=ce("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.badge,n[t.variant],n[`anchorOrigin${S(t.anchorOrigin.vertical)}${S(t.anchorOrigin.horizontal)}${S(t.overlap)}`],t.color!=="default"&&n[`color${S(t.color)}`],t.invisible&&n.invisible]}})(({theme:e})=>{var n;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:xe*2,lineHeight:1,padding:"0 6px",height:xe*2,borderRadius:xe,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.keys(((n=e.vars)!=null?n:e).palette).filter(t=>{var s,u;return((s=e.vars)!=null?s:e).palette[t].main&&((u=e.vars)!=null?u:e).palette[t].contrastText}).map(t=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText}})),{props:{variant:"dot"},style:{borderRadius:be,height:be*2,minWidth:be*2,padding:0}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]}}),gt=p.forwardRef(function(n,t){var s,u,m,h,c,C;const O=ve({props:n,name:"MuiBadge"}),{anchorOrigin:N={vertical:"top",horizontal:"right"},className:E,component:I,components:y={},componentsProps:L={},children:g,overlap:Q="rectangular",color:ee="default",invisible:B=!1,max:te=99,badgeContent:re,slots:M,slotProps:j,showZero:R=!1,variant:W="standard"}=O,U=ye(O,ct),{badgeContent:oe,invisible:ae,max:V,displayValue:de}=st({max:te,invisible:B,badgeContent:re,showZero:R}),pe=Le({anchorOrigin:N,color:ee,overlap:Q,variant:W,badgeContent:re}),ne=ae||oe==null&&W!=="dot",{color:ue=ee,overlap:ge=Q,anchorOrigin:Y=N,variant:ie=W}=ne?pe:O,se=ie!=="dot"?de:void 0,D=w({},O,{badgeContent:oe,invisible:ne,max:V,displayValue:se,showZero:R,anchorOrigin:Y,color:ue,overlap:ge,variant:ie}),le=dt(D),G=(s=(u=M==null?void 0:M.root)!=null?u:y.Root)!=null?s:pt,o=(m=(h=M==null?void 0:M.badge)!=null?h:y.Badge)!=null?m:ut,a=(c=j==null?void 0:j.root)!=null?c:L.root,k=(C=j==null?void 0:j.badge)!=null?C:L.badge,z=$e({elementType:G,externalSlotProps:a,externalForwardedProps:U,additionalProps:{ref:t,as:I},ownerState:D,className:X(a==null?void 0:a.className,le.root,E)}),$=$e({elementType:o,externalSlotProps:k,ownerState:D,className:X(le.badge,k==null?void 0:k.className)});return b.jsxs(G,w({},z,{children:[g,b.jsx(o,w({},$,{children:se}))]}))});function ht(e){return Fe("MuiFab",e)}const Oe=Pe("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),mt=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],ft=e=>{const{color:n,variant:t,classes:s,size:u}=e,m={root:["root",t,`size${S(u)}`,n==="inherit"?"colorInherit":n]},h=Se(m,ht,s);return w({},s,h)},xt=ce(Be,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>je(e)||e==="classes",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.root,n[t.variant],n[`size${S(t.size)}`],t.color==="inherit"&&n.colorInherit,n[S(t.size)],n[t.color]]}})(({theme:e,ownerState:n})=>{var t,s;return w({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:(t=(s=e.palette).getContrastText)==null?void 0:t.call(s,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${Oe.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]}},n.size==="small"&&{width:40,height:40},n.size==="medium"&&{width:48,height:48},n.variant==="extended"&&{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},n.variant==="extended"&&n.size==="small"&&{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34},n.variant==="extended"&&n.size==="medium"&&{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40},n.color==="inherit"&&{color:"inherit"})},({theme:e,ownerState:n})=>w({},n.color!=="inherit"&&n.color!=="default"&&(e.vars||e).palette[n.color]!=null&&{color:(e.vars||e).palette[n.color].contrastText,backgroundColor:(e.vars||e).palette[n.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[n.color].main}}}),({theme:e})=>({[`&.${Oe.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}})),bt=p.forwardRef(function(n,t){const s=ve({props:n,name:"MuiFab"}),{children:u,className:m,color:h="default",component:c="button",disabled:C=!1,disableFocusRipple:O=!1,focusVisibleClassName:N,size:E="large",variant:I="circular"}=s,y=ye(s,mt),L=w({},s,{color:h,component:c,disabled:C,disableFocusRipple:O,size:E,variant:I}),g=ft(L);return b.jsx(xt,w({className:X(g.root,m),component:c,disabled:C,focusRipple:!O,focusVisibleClassName:X(g.focusVisible,N),ownerState:L,ref:t},y,{classes:g,children:u}))}),vt=["className"],yt=e=>{const{alignItems:n,classes:t}=e;return Se({root:["root",n==="flex-start"&&"alignItemsFlexStart"]},Xe,t)},St=ce("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.root,t.alignItems==="flex-start"&&n.alignItemsFlexStart]}})(({theme:e,ownerState:n})=>w({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex"},n.alignItems==="flex-start"&&{marginTop:8})),Ct=p.forwardRef(function(n,t){const s=ve({props:n,name:"MuiListItemIcon"}),{className:u}=s,m=ye(s,vt),h=p.useContext(Je),c=w({},s,{alignItems:h.alignItems}),C=yt(c);return b.jsx(St,w({className:X(C.root,u),ownerState:c,ref:t},m))}),$t=_(b.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess"),kt=_(b.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Ie=_(b.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"GpsFixed"),zt=_(b.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56M12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56m2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8M12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96M14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2m.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2z"}),"Language"),Re=_(b.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),wt=_([b.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),b.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"Schedule"),_t=_(b.jsx("path",{d:"M12.01 21.49 23.64 7c-.45-.34-4.93-4-11.64-4C5.28 3 .81 6.66.36 7l11.63 14.49.01.01z"}),"SignalWifi4Bar"),Te=_(b.jsx("path",{d:"M6 6h12v12H6z"}),"Stop"),Ot=_(b.jsx("path",{d:"M15 1H9v2h6zm-4 13h2V8h-2zm8.03-6.61 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"TimerOutlined"),It=_(b.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zM7 10h5v5H7z"}),"Today"),Rt=_(b.jsx("path",{fillRule:"evenodd",d:"M14 6V4h-4v2zM4 8v11h16V8zm16-2c1.11 0 2 .89 2 2v11c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2l.01-11c0-1.11.88-2 1.99-2h4V4c0-1.11.89-2 2-2h4c1.11 0 2 .89 2 2v2z"}),"WorkOutline"),Xt=()=>{var G;const e=De(),{auth:n}=Ae().props,t=n.user,[s,u]=p.useState(null),[m,h]=p.useState(!1),[c,C]=p.useState([]),[O,N]=p.useState("00:00:00"),[E,I]=p.useState("00:00:00"),[y,L]=p.useState(null),[g,Q]=p.useState(null),[ee,B]=p.useState(!1),[te,re]=p.useState(new Date),[M,j]=p.useState({punches:!1,rules:!1,validation:!1}),[R,W]=p.useState({location:!1,network:!0,device:!0}),[U,oe]=p.useState({ip:"Unknown",accuracy:"N/A",timestamp:null});p.useEffect(()=>{const o=setInterval(()=>{const a=new Date;re(a),s==="punched_in"&&c.length>0&&ae(a)},1e3);return()=>clearInterval(o)},[s,c]),p.useEffect(()=>{V(),de(),pe()},[]);const ae=o=>{let a=0;c.forEach((f,Ce)=>{if(f.punchin_time){let A;if(typeof f.punchin_time=="string"&&f.punchin_time.includes(":")&&!f.punchin_time.includes("T")){const x=new Date,[T,P,he]=f.punchin_time.split(":");A=new Date(x.getFullYear(),x.getMonth(),x.getDate(),parseInt(T),parseInt(P),parseInt(he||0))}else A=new Date(f.punchin_time);if(isNaN(A.getTime())){console.warn("Invalid punch in time:",f.punchin_time);return}if(f.punchout_time){let x;if(typeof f.punchout_time=="string"&&f.punchout_time.includes(":")&&!f.punchout_time.includes("T")){const P=new Date,[he,Me,We]=f.punchout_time.split(":");x=new Date(P.getFullYear(),P.getMonth(),P.getDate(),parseInt(he),parseInt(Me),parseInt(We||0))}else x=new Date(f.punchout_time);if(isNaN(x.getTime())){console.warn("Invalid punch out time:",f.punchout_time);return}const T=Math.floor((x-A)/1e3);T>0&&(a+=T)}else{const x=Math.floor((o-A)/1e3);x>0&&(a+=x)}}}),(isNaN(a)||a<0)&&(a=0);const k=Math.floor(a/3600),z=Math.floor(a%3600/60),$=a%60,Z=`${k.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}`;I(Z)},V=async()=>{try{const a=(await me.get(route("attendance.current-user-punch"))).data;if(C(a.punches||[]),N(a.total_production_time||"00:00:00"),L(a.isUserOnLeave),a.punches&&a.punches.length>0){const z=a.punches[a.punches.length-1].punchout_time?"punched_out":"punched_in";if(u(z),z==="punched_in")setTimeout(()=>{ae(new Date)},100);else if(a.total_production_time&&a.total_production_time!=="00:00:00")I(a.total_production_time);else{let $=0;a.punches.forEach(x=>{if(x.punchin_time&&x.punchout_time)try{const T=new Date(x.punchin_time),P=new Date(x.punchout_time);!isNaN(T.getTime())&&!isNaN(P.getTime())&&($+=Math.floor((P-T)/1e3))}catch(T){console.warn("Error calculating session time:",T)}});const Z=Math.floor($/3600),f=Math.floor($%3600/60),Ce=$%60,A=`${Z.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}:${Ce.toString().padStart(2,"0")}`;I(A)}}else u("not_punched"),I("00:00:00")}catch(o){console.error("Error fetching current status:",o),J.error("Failed to fetch attendance status"),I("00:00:00")}},de=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(o=>{Q({latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy}),W(a=>({...a,location:!0}))},o=>{console.error("Error getting location:",o),W(a=>({...a,location:!1}))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},pe=()=>{W(o=>({...o,network:navigator.onLine,device:!0}))},ne=()=>{const o=document.createElement("canvas"),a=o.getContext("2d");return a.textBaseline="top",a.font="14px Arial",a.fillText("Device fingerprint",2,2),{userAgent:navigator.userAgent,screen:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language,canvasFingerprint:o.toDataURL(),timestamp:Date.now()}},ue=async()=>{if(y){J.warning("You are on leave today. Cannot punch in/out.");return}h(!0);try{const o=ne();let a="Unknown";try{a=(await me.get(route("getClientIp"))).data.ip}catch($){console.warn("Could not fetch IP address:",$)}oe({ip:a,accuracy:g!=null&&g.accuracy?`${Math.round(g.accuracy)}m`:"N/A",timestamp:new Date().toLocaleString()});const k={lat:g==null?void 0:g.latitude,lng:g==null?void 0:g.longitude,accuracy:g==null?void 0:g.accuracy,ip:a,wifi_ssid:"Unknown",device_fingerprint:JSON.stringify(o),user_agent:navigator.userAgent,timestamp:new Date().toISOString()},z=await me.post(route("attendance.punch"),k);z.data.status==="success"?(J.success(z.data.message,{style:{backdropFilter:"blur(16px) saturate(200%)",background:i(e.palette.success.main,.1),border:`1px solid ${i(e.palette.success.main,.2)}`,color:e.palette.text.primary}}),B(!0),await V()):J.error(z.data.message)}catch(o){console.error("Error during punch operation:",o),J.error(o.response.data.message,{style:{backdropFilter:"blur(16px) saturate(200%)",background:i(e.palette.success.main,.1),border:`1px solid ${i(e.palette.success.main,.2)}`,color:e.palette.text.primary}})}finally{h(!1)}},ge=o=>{j(a=>({...a,[o]:!a[o]}))},Y=()=>{if(y)return"warning";switch(s){case"punched_in":return"success";case"punched_out":return"info";default:return"default"}},ie=()=>{if(y)return"On Leave";switch(s){case"punched_in":return"Checked In";case"punched_out":return"Checked Out";default:return"Ready to Check In"}},se=()=>y?"On Leave":s==="punched_in"?"Check Out":"Check In",D=o=>{if(!o)return"--:--";try{let a;if(typeof o=="string"&&o.includes(":")&&!o.includes("T")){const k=new Date,[z,$,Z]=o.split(":");a=new Date(k.getFullYear(),k.getMonth(),k.getDate(),z,$,Z||0)}else a=new Date(o);return isNaN(a.getTime())?o:a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(a){return console.warn("Error formatting time:",o,a),o}},le=o=>{if(!o)return"Location not available";try{if(typeof o=="object"&&o.lat&&o.lng)return o.address&&o.address.trim()?o.address.substring(0,30):`${o.lat.toFixed(4)}, ${o.lng.toFixed(4)}`;if(typeof o=="string")try{const a=JSON.parse(o);if(a.lat&&a.lng)return a.address&&a.address.trim()?a.address.substring(0,30):`${a.lat.toFixed(4)}, ${a.lng.toFixed(4)}`}catch{return o.substring(0,30)}return"Location not available"}catch(a){return console.warn("Error formatting location:",o,a),"Location not available"}};return l(v,{sx:{mx:"auto",p:2,display:"flex",flexDirection:"column"},children:[l(He,{children:[l(Ye,{sx:{p:2,textAlign:"center",position:"relative"},children:[l(v,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[l(v,{sx:{display:"flex",alignItems:"center",flex:1},children:[r(gt,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r(v,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:Y()==="success"?"success.main":Y()==="warning"?"warning.main":"grey.400",border:`2px solid ${e.palette.background.paper}`}}),children:r(ze,{sx:{width:48,height:48,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,fontSize:"1.2rem"},children:t!=null&&t.profile_image?r("img",{src:t.profile_image,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):(G=t==null?void 0:t.name)==null?void 0:G.charAt(0).toUpperCase()})}),l(v,{sx:{ml:2,textAlign:"left"},children:[r(d,{variant:"h6",sx:{fontWeight:600,fontSize:"1rem",lineHeight:1.2},children:t==null?void 0:t.name}),l(d,{variant:"caption",color:"text.secondary",children:["ID: ",(t==null?void 0:t.employee_id)||(t==null?void 0:t.id)]})]})]}),l(v,{sx:{textAlign:"right"},children:[r(d,{variant:"h5",sx:{fontWeight:300,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent",lineHeight:1},children:te.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}),r(d,{variant:"caption",color:"text.secondary",children:te.toLocaleDateString("en-US",{weekday:"short",day:"numeric"})})]})]}),r(q,{label:ie(),color:Y(),sx:{mb:2,fontSize:"0.8rem",py:1.5,px:2,height:32,borderRadius:2,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.3px"},icon:s==="punched_in"?r(Re,{sx:{fontSize:16}}):r(Te,{sx:{fontSize:16}})}),l(H,{container:!0,spacing:1,sx:{mb:2},children:[r(H,{item:!0,xs:6,children:l(K,{variant:"outlined",sx:{p:1.5,textAlign:"center",background:i(e.palette.primary.main,.05),border:`1px solid ${i(e.palette.primary.main,.1)}`,borderRadius:2},children:[r(Ot,{color:"primary",sx:{fontSize:20,mb:.5}}),r(d,{variant:"h6",color:"primary",sx:{fontWeight:700,fontSize:"1rem",fontFamily:"monospace",letterSpacing:"0.5px"},children:E}),r(d,{variant:"caption",color:"text.secondary",children:"Hours Today"})]})}),r(H,{item:!0,xs:6,children:l(K,{variant:"outlined",sx:{p:1.5,textAlign:"center",background:i(e.palette.secondary.main,.05),border:`1px solid ${i(e.palette.secondary.main,.1)}`,borderRadius:2},children:[r(Rt,{color:"secondary",sx:{fontSize:20,mb:.5}}),r(d,{variant:"h6",color:"secondary",sx:{fontWeight:700,fontSize:"1rem"},children:c.length}),r(d,{variant:"caption",color:"text.secondary",children:"Sessions"})]})})]}),r(we,{variant:"contained",size:"large",fullWidth:!0,onClick:ue,disabled:m||y,sx:{mb:2,height:48,borderRadius:3,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:"white",fontWeight:600,fontSize:"1rem",textTransform:"none",boxShadow:`0 6px 20px ${i(e.palette.primary.main,.3)}`,backdropFilter:"blur(16px) saturate(200%)",border:`1px solid ${i(e.palette.primary.main,.2)}`,"&:hover":{background:`linear-gradient(135deg, ${e.palette.primary.dark}, ${e.palette.secondary.dark})`,transform:"translateY(-1px)",boxShadow:`0 8px 25px ${i(e.palette.primary.main,.4)}`},"&:disabled":{background:i(e.palette.action.disabled,.1),color:e.palette.action.disabled,backdropFilter:"blur(16px) saturate(200%)"}},startIcon:m?r(Ge,{size:18,color:"inherit"}):s==="punched_in"?r(Te,{}):r(Re,{}),children:m?"Processing...":se()}),l(Ee,{direction:"row",spacing:.5,justifyContent:"center",children:[r(fe,{title:`GPS: ${R.location?"Connected":"Disconnected"}`,children:r(q,{size:"small",icon:r(Ie,{sx:{fontSize:14}}),label:"GPS",color:R.location?"success":"default",variant:R.location?"filled":"outlined",sx:{fontSize:"0.7rem",height:24}})}),r(fe,{title:`Network: ${R.network?"Online":"Offline"}`,children:r(q,{size:"small",icon:r(_t,{sx:{fontSize:14}}),label:"Net",color:R.network?"success":"default",variant:R.network?"filled":"outlined",sx:{fontSize:"0.7rem",height:24}})}),r(fe,{title:"Device Security",children:r(q,{size:"small",icon:r(Ze,{sx:{fontSize:14}}),label:"Secure",color:"success",variant:"filled",sx:{fontSize:"0.7rem",height:24}})})]})]}),y&&l(_e,{severity:"warning",sx:{mx:2,mb:2,borderRadius:2,background:i(e.palette.warning.main,.1),border:`1px solid ${i(e.palette.warning.main,.2)}`,backdropFilter:"blur(16px) saturate(200%)",fontSize:"0.8rem"},children:[l(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.8rem"},children:["On ",y.leave_type," Leave"]}),l(d,{variant:"caption",children:[new Date(y.from_date).toLocaleDateString()," - ",new Date(y.to_date).toLocaleDateString()]})]}),l(v,{sx:{borderTop:`1px solid ${i(e.palette.divider,.1)}`},children:[l(v,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer","&:hover":{background:i(e.palette.primary.main,.02)}},onClick:()=>ge("punches"),children:[l(v,{sx:{display:"flex",alignItems:"center"},children:[r(It,{color:"primary",sx:{mr:1,fontSize:20}}),r(d,{variant:"subtitle1",sx:{fontWeight:600,fontSize:"0.9rem"},children:"Today's Activity"})]}),r(ke,{size:"small",children:M.punches?r($t,{}):r(kt,{})})]}),r(Ue,{in:M.punches,children:r(v,{sx:{px:2,pb:2},children:c.length>0?r(qe,{sx:{p:0},children:c.map((o,a)=>l(Ne.Fragment,{children:[l(Ke,{sx:{px:0,py:1},children:[r(Ct,{sx:{minWidth:36},children:r(ze,{sx:{width:24,height:24,bgcolor:"primary.main"},children:r(wt,{sx:{fontSize:14}})})}),r(Qe,{primary:l(v,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[l(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.8rem"},children:["In: ",D(o.punchin_time||o.punch_in_time||o.time_in)]}),(o.punchout_time||o.punch_out_time||o.time_out)&&l(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.8rem"},children:["Out: ",D(o.punchout_time||o.punch_out_time||o.time_out)]}),o.duration&&r(q,{label:o.duration,size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.6rem",height:20}})]}),secondary:l(d,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:["📍 ",le(o.punchin_location||o.location),"..."]})})]}),a<c.length-1&&r(et,{})]},a))}):r(_e,{severity:"info",sx:{background:i(e.palette.info.main,.05),border:`1px solid ${i(e.palette.info.main,.1)}`,backdropFilter:"blur(16px) saturate(200%)",fontSize:"0.8rem"},children:r(d,{variant:"body2",sx:{fontSize:"0.8rem"},children:"No activity recorded today"})})})})]})]}),l(tt,{open:ee,onClose:()=>B(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backdropFilter:"blur(20px) saturate(180%)",background:`linear-gradient(135deg, ${i(e.palette.background.paper,.9)}, ${i(e.palette.primary.main,.05)})`,border:`1px solid ${i(e.palette.primary.main,.3)}`,borderRadius:4,boxShadow:`0 20px 40px ${i(e.palette.primary.main,.2)}`,m:1,overflow:"hidden"}},children:[l(v,{sx:{position:"relative",background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:"white",p:3,textAlign:"center"},children:[r(ke,{onClick:()=>B(!1),sx:{position:"absolute",top:8,right:8,color:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)","&:hover":{color:"white",background:i(e.palette.common.white,.1)}},children:r(Ve,{})}),r(at,{sx:{fontSize:48,mb:1,opacity:.9}}),r(d,{variant:"h5",sx:{fontWeight:700,mb:.5},children:"Attendance Recorded"}),r(d,{variant:"body2",sx:{opacity:.9},children:"Your attendance has been successfully captured"})]}),l(rt,{sx:{p:3},children:[l(H,{container:!0,spacing:2,children:[r(H,{item:!0,xs:12,sm:6,children:l(K,{sx:{p:2.5,textAlign:"center",background:`linear-gradient(135deg, ${i(e.palette.info.main,.1)}, ${i(e.palette.info.main,.05)})`,border:`1px solid ${i(e.palette.info.main,.2)}`,borderRadius:3,backdropFilter:"blur(10px)",transition:"transform 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${i(e.palette.info.main,.15)}`}},children:[r(v,{sx:{width:48,height:48,borderRadius:"50%",background:`linear-gradient(135deg, ${e.palette.info.main}, ${e.palette.info.dark})`,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:r(zt,{sx:{color:"white",fontSize:24}})}),r(d,{variant:"h6",color:"info.main",sx:{fontWeight:700,mb:.5},children:U.ip}),r(d,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"IP Address"})]})}),r(H,{item:!0,xs:12,sm:6,children:l(K,{sx:{p:2.5,textAlign:"center",background:`linear-gradient(135deg, ${i(e.palette.success.main,.1)}, ${i(e.palette.success.main,.05)})`,border:`1px solid ${i(e.palette.success.main,.2)}`,borderRadius:3,backdropFilter:"blur(10px)",transition:"transform 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${i(e.palette.success.main,.15)}`}},children:[r(v,{sx:{width:48,height:48,borderRadius:"50%",background:`linear-gradient(135deg, ${e.palette.success.main}, ${e.palette.success.dark})`,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:r(Ie,{sx:{color:"white",fontSize:24}})}),r(d,{variant:"h6",color:"success.main",sx:{fontWeight:700,mb:.5},children:U.accuracy}),r(d,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"GPS Accuracy"})]})})]}),r(K,{sx:{mt:2,p:2,background:i(e.palette.background.default,.5),border:`1px solid ${i(e.palette.divider,.2)}`,borderRadius:2,backdropFilter:"blur(10px)"},children:l(v,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[r(nt,{color:"primary",sx:{mr:1,fontSize:20}}),l(d,{variant:"body2",color:"text.secondary",sx:{fontWeight:600},children:["Recorded at: ",U.timestamp]})]})})]}),r(ot,{sx:{p:3,pt:0},children:r(we,{onClick:()=>B(!1),variant:"contained",fullWidth:!0,sx:{height:48,borderRadius:3,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backdropFilter:"blur(16px) saturate(200%)",fontWeight:600,textTransform:"none",boxShadow:`0 6px 20px ${i(e.palette.primary.main,.3)}`,"&:hover":{background:`linear-gradient(135deg, ${e.palette.primary.dark}, ${e.palette.secondary.dark})`,transform:"translateY(-1px)",boxShadow:`0 8px 25px ${i(e.palette.primary.main,.4)}`}},children:"Continue"})})]}),r(bt,{size:"small",onClick:V,sx:{position:"fixed",bottom:16,right:16,background:i(e.palette.background.paper,.8),backdropFilter:"blur(16px) saturate(200%)",border:`1px solid ${i(e.palette.divider,.2)}`,width:40,height:40,"&:hover":{background:i(e.palette.primary.main,.1)}},children:r(it,{sx:{fontSize:18}})})]})};export{Xt as default};
