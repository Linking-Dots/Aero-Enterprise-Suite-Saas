import{r as g,c as m,J as We,a as he,b as l,j as o,R as Ae}from"./app-gqB4O3VB.js";import{x as Te,y as Pe,n as be,_ as ve,o as _,ab as Ce,p as X,s as ne,a2 as k,q as ye,ag as Ne,a3 as Be,e as z,u as je,P as q,c as De,B as v,d,L as K,f as E,ae as Q,S as Ee,T as me,I as ke,M as He,b4 as Ve}from"./App-C15qU46z.js";import{C as Ue}from"./CardContent-D21gBAwL.js";import{A as $e}from"./Avatar-DHTg9E_n.js";import{C as Ye}from"./CircularProgress-DfbVc7jt.js";import{B as ze}from"./Button-CW-Us0kA.js";import{S as Ge}from"./Security-CBZI-lZo.js";import{A as we}from"./Alert-B1T1wzlz.js";import{L as Ze,a as Je}from"./List-BNzkm6Py.js";import{L as qe}from"./ListItem-BTRTqU4h.js";import{b as Ke}from"./listItemTextClasses-CmBPcOqS.js";import{L as Qe}from"./ListItemText-BRDl6tR8.js";import{D as Xe}from"./Divider-DpowUcC0.js";import{a as et,b as tt,c as rt}from"./DialogContent-Dt-14mXe.js";import{C as ot}from"./CheckCircle-DEGPqr3a.js";import{A as at}from"./AccessTime-D8Lpj_bW.js";import{R as nt}from"./Refresh-t-Rzob_y.js";import{a as i}from"./colorManipulator-CtUAgipW.js";import"./app-Ce0FNRT8.js";import"./useSlot-DW0lXzka.js";import"./dividerClasses-DAzeyDpQ.js";const Le=e=>{const a=g.useRef({});return g.useEffect(()=>{a.current=e}),a.current};function it(e){const{badgeContent:a,invisible:t=!1,max:s=99,showZero:u=!1}=e,f=Le({badgeContent:a,max:s});let h=t;t===!1&&a===0&&!u&&(h=!0);const{badgeContent:c,max:$=s}=h?f:e,O=c&&Number(c)>$?`${$}+`:c;return{badgeContent:c,invisible:h,max:$,displayValue:O}}function st(e){return Pe("MuiBadge",e)}const F=Te("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),lt=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],fe=10,xe=4,ct=e=>{const{color:a,anchorOrigin:t,invisible:s,overlap:u,variant:f,classes:h={}}=e,c={root:["root"],badge:["badge",f,s&&"invisible",`anchorOrigin${k(t.vertical)}${k(t.horizontal)}`,`anchorOrigin${k(t.vertical)}${k(t.horizontal)}${k(u)}`,`overlap${k(u)}`,a!=="default"&&`color${k(a)}`]};return ye(c,st,h)},dt=ne("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,a)=>a.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),pt=ne("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.badge,a[t.variant],a[`anchorOrigin${k(t.anchorOrigin.vertical)}${k(t.anchorOrigin.horizontal)}${k(t.overlap)}`],t.color!=="default"&&a[`color${k(t.color)}`],t.invisible&&a.invisible]}})(({theme:e})=>{var a;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:fe*2,lineHeight:1,padding:"0 6px",height:fe*2,borderRadius:fe,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.keys(((a=e.vars)!=null?a:e).palette).filter(t=>{var s,u;return((s=e.vars)!=null?s:e).palette[t].main&&((u=e.vars)!=null?u:e).palette[t].contrastText}).map(t=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText}})),{props:{variant:"dot"},style:{borderRadius:xe,height:xe*2,minWidth:xe*2,padding:0}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${F.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]}}),ut=g.forwardRef(function(a,t){var s,u,f,h,c,$;const O=be({props:a,name:"MuiBadge"}),{anchorOrigin:B={vertical:"top",horizontal:"right"},className:H,component:R,components:y={},componentsProps:M={},children:W,overlap:A="rectangular",color:V="default",invisible:ie=!1,max:ee=99,badgeContent:te,slots:w,slotProps:T,showZero:j=!1,variant:U="standard"}=O,re=ve(O,lt),{badgeContent:D,invisible:se,max:le,displayValue:ce}=it({max:ee,invisible:ie,badgeContent:te,showZero:j}),de=Le({anchorOrigin:B,color:V,overlap:A,variant:U,badgeContent:te}),oe=se||D==null&&U!=="dot",{color:pe=V,overlap:Y=A,anchorOrigin:ue=B,variant:ae=U}=oe?de:O,G=ae!=="dot"?ce:void 0,Z=_({},O,{badgeContent:D,invisible:oe,max:le,displayValue:G,showZero:j,anchorOrigin:ue,color:pe,overlap:Y,variant:ae}),J=ct(Z),r=(s=(u=w==null?void 0:w.root)!=null?u:y.Root)!=null?s:dt,n=(f=(h=w==null?void 0:w.badge)!=null?h:y.Badge)!=null?f:pt,p=(c=T==null?void 0:T.root)!=null?c:M.root,S=($=T==null?void 0:T.badge)!=null?$:M.badge,C=Ce({elementType:r,externalSlotProps:p,externalForwardedProps:re,additionalProps:{ref:t,as:R},ownerState:Z,className:X(p==null?void 0:p.className,J.root,H)}),I=Ce({elementType:n,externalSlotProps:S,ownerState:Z,className:X(J.badge,S==null?void 0:S.className)});return m.jsxs(r,_({},C,{children:[W,m.jsx(n,_({},I,{children:G}))]}))});function gt(e){return Pe("MuiFab",e)}const _e=Te("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),ht=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],mt=e=>{const{color:a,variant:t,classes:s,size:u}=e,f={root:["root",t,`size${k(u)}`,a==="inherit"?"colorInherit":a]},h=ye(f,gt,s);return _({},s,h)},ft=ne(Ne,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>Be(e)||e==="classes",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,a[t.variant],a[`size${k(t.size)}`],t.color==="inherit"&&a.colorInherit,a[k(t.size)],a[t.color]]}})(({theme:e,ownerState:a})=>{var t,s;return _({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:(t=(s=e.palette).getContrastText)==null?void 0:t.call(s,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${_e.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]}},a.size==="small"&&{width:40,height:40},a.size==="medium"&&{width:48,height:48},a.variant==="extended"&&{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},a.variant==="extended"&&a.size==="small"&&{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34},a.variant==="extended"&&a.size==="medium"&&{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40},a.color==="inherit"&&{color:"inherit"})},({theme:e,ownerState:a})=>_({},a.color!=="inherit"&&a.color!=="default"&&(e.vars||e).palette[a.color]!=null&&{color:(e.vars||e).palette[a.color].contrastText,backgroundColor:(e.vars||e).palette[a.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[a.color].main}}}),({theme:e})=>({[`&.${_e.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}})),xt=g.forwardRef(function(a,t){const s=be({props:a,name:"MuiFab"}),{children:u,className:f,color:h="default",component:c="button",disabled:$=!1,disableFocusRipple:O=!1,focusVisibleClassName:B,size:H="large",variant:R="circular"}=s,y=ve(s,ht),M=_({},s,{color:h,component:c,disabled:$,disableFocusRipple:O,size:H,variant:R}),W=mt(M);return m.jsx(ft,_({className:X(W.root,f),component:c,disabled:$,focusRipple:!O,focusVisibleClassName:X(W.focusVisible,B),ownerState:M,ref:t},y,{classes:W,children:u}))}),bt=["className"],vt=e=>{const{alignItems:a,classes:t}=e;return ye({root:["root",a==="flex-start"&&"alignItemsFlexStart"]},Ke,t)},yt=ne("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,t.alignItems==="flex-start"&&a.alignItemsFlexStart]}})(({theme:e,ownerState:a})=>_({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex"},a.alignItems==="flex-start"&&{marginTop:8})),St=g.forwardRef(function(a,t){const s=be({props:a,name:"MuiListItemIcon"}),{className:u}=s,f=ve(s,bt),h=g.useContext(Ze),c=_({},s,{alignItems:h.alignItems}),$=vt(c);return m.jsx(yt,_({className:X($.root,u),ownerState:c,ref:t},f))}),Ct=z(m.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error"),kt=z(m.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess"),$t=z(m.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Oe=z(m.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"GpsFixed"),zt=z(m.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56M12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56m2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8M12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96M14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2m.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2z"}),"Language"),Ie=z(m.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),wt=z([m.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),m.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"Schedule"),_t=z(m.jsx("path",{d:"M12.01 21.49 23.64 7c-.45-.34-4.93-4-11.64-4C5.28 3 .81 6.66.36 7l11.63 14.49.01.01z"}),"SignalWifi4Bar"),Re=z(m.jsx("path",{d:"M6 6h12v12H6z"}),"Stop"),Ot=z(m.jsx("path",{d:"M15 1H9v2h6zm-4 13h2V8h-2zm8.03-6.61 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"TimerOutlined"),It=z(m.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zM7 10h5v5H7z"}),"Today"),Rt=z(m.jsx("path",{fillRule:"evenodd",d:"M14 6V4h-4v2zM4 8v11h16V8zm16-2c1.11 0 2 .89 2 2v11c0 1.11-.89 2-2 2H4c-1.11 0-2-.89-2-2l.01-11c0-1.11.88-2 1.99-2h4V4c0-1.11.89-2 2-2h4c1.11 0 2 .89 2 2v2z"}),"WorkOutline"),Qt=()=>{var J;const e=je(),{auth:a}=We().props,t=a.user,[s,u]=g.useState(null),[f,h]=g.useState(!1),[c,$]=g.useState([]),[O,B]=g.useState("00:00:00"),[H,R]=g.useState("00:00:00"),[y,M]=g.useState(null),[W,A]=g.useState(!1),[V,ie]=g.useState(new Date),[ee,te]=g.useState({punches:!1,rules:!1,validation:!1}),[w,T]=g.useState({location:!1,network:!0,device:!0}),[j,U]=g.useState({ip:"Unknown",accuracy:"N/A",timestamp:null});g.useEffect(()=>{const r=setInterval(()=>{const n=new Date;ie(n),s==="punched_in"&&c.length>0&&re(n)},1e3);return()=>clearInterval(r)},[s,c]),g.useEffect(()=>{D(),se(),ce()},[]);const re=r=>{let n=0;c.forEach((x,Se)=>{if(x.punchin_time){let N;if(typeof x.punchin_time=="string"&&x.punchin_time.includes(":")&&!x.punchin_time.includes("T")){const b=new Date,[P,L,ge]=x.punchin_time.split(":");N=new Date(b.getFullYear(),b.getMonth(),b.getDate(),parseInt(P),parseInt(L),parseInt(ge||0))}else N=new Date(x.punchin_time);if(isNaN(N.getTime())){console.warn("Invalid punch in time:",x.punchin_time);return}if(x.punchout_time){let b;if(typeof x.punchout_time=="string"&&x.punchout_time.includes(":")&&!x.punchout_time.includes("T")){const L=new Date,[ge,Fe,Me]=x.punchout_time.split(":");b=new Date(L.getFullYear(),L.getMonth(),L.getDate(),parseInt(ge),parseInt(Fe),parseInt(Me||0))}else b=new Date(x.punchout_time);if(isNaN(b.getTime())){console.warn("Invalid punch out time:",x.punchout_time);return}const P=Math.floor((b-N)/1e3);P>0&&(n+=P)}else{const b=Math.floor((r-N)/1e3);b>0&&(n+=b)}}}),(isNaN(n)||n<0)&&(n=0);const p=Math.floor(n/3600),S=Math.floor(n%3600/60),C=n%60,I=`${p.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`;R(I)},D=async()=>{try{const n=(await he.get(route("attendance.current-user-punch"))).data;if($(n.punches||[]),B(n.total_production_time||"00:00:00"),M(n.isUserOnLeave),n.punches&&n.punches.length>0){const S=n.punches[n.punches.length-1].punchout_time?"punched_out":"punched_in";if(u(S),S==="punched_in")setTimeout(()=>{re(new Date)},100);else if(n.total_production_time&&n.total_production_time!=="00:00:00")R(n.total_production_time);else{let C=0;n.punches.forEach(b=>{if(b.punchin_time&&b.punchout_time)try{const P=new Date(b.punchin_time),L=new Date(b.punchout_time);!isNaN(P.getTime())&&!isNaN(L.getTime())&&(C+=Math.floor((L-P)/1e3))}catch(P){console.warn("Error calculating session time:",P)}});const I=Math.floor(C/3600),x=Math.floor(C%3600/60),Se=C%60,N=`${I.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}:${Se.toString().padStart(2,"0")}`;R(N)}}else u("not_punched"),R("00:00:00")}catch(r){console.error("Error fetching current status:",r),q.error("Failed to fetch attendance status"),R("00:00:00")}},se=()=>{if(!navigator.geolocation){T(r=>({...r,location:!1}));return}navigator.geolocation.getCurrentPosition(()=>{T(r=>({...r,location:!0}))},r=>{console.error("Error checking location connection:",r),T(n=>({...n,location:!1}))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},le=()=>{if(!navigator.geolocation)throw new Ct("Geolocation is not supported by this browser");return new Promise((r,n)=>{navigator.geolocation.getCurrentPosition(p=>{const S={latitude:p.coords.latitude,longitude:p.coords.longitude,accuracy:p.coords.accuracy};r(S)},p=>{console.error("Error getting location data:",p),n(p)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})},ce=()=>{T(r=>({...r,network:navigator.onLine,device:!0}))},de=()=>{const r=document.createElement("canvas"),n=r.getContext("2d");return n.textBaseline="top",n.font="14px Arial",n.fillText("Device fingerprint",2,2),{userAgent:navigator.userAgent,screen:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language,canvasFingerprint:r.toDataURL(),timestamp:Date.now()}},oe=async()=>{if(y){q.warning("You are on leave today. Cannot punch in/out.");return}h(!0);try{const r=await le(),n=de();let p="Unknown";try{p=(await he.get(route("getClientIp"))).data.ip}catch(I){console.warn("Could not fetch IP address:",I)}U({ip:p,accuracy:r!=null&&r.accuracy?`${Math.round(r.accuracy)}m`:"N/A",timestamp:new Date().toLocaleString()});const S={lat:r==null?void 0:r.latitude,lng:r==null?void 0:r.longitude,accuracy:r==null?void 0:r.accuracy,ip:p,wifi_ssid:"Unknown",device_fingerprint:JSON.stringify(n),user_agent:navigator.userAgent,timestamp:new Date().toISOString()},C=await he.post(route("attendance.punch"),S);C.data.status==="success"?(q.success(C.data.message,{style:{backdropFilter:"blur(16px) saturate(200%)",background:i(e.palette.success.main,.1),border:`1px solid ${i(e.palette.success.main,.2)}`,color:e.palette.text.primary}}),A(!0),await D()):q.error(C.data.message)}catch(r){console.error("Error during punch operation:",r),q.error(r.response.data.message,{style:{backdropFilter:"blur(16px) saturate(200%)",background:i(e.palette.success.main,.1),border:`1px solid ${i(e.palette.success.main,.2)}`,color:e.palette.text.primary}})}finally{h(!1)}},pe=r=>{te(n=>({...n,[r]:!n[r]}))},Y=()=>{if(y)return"warning";switch(s){case"punched_in":return"success";case"punched_out":return"info";default:return"default"}},ue=()=>{if(y)return"On Leave";switch(s){case"punched_in":return"Checked In";case"punched_out":return"Checked Out";default:return"Ready to Check In"}},ae=()=>y?"On Leave":s==="punched_in"?"Check Out":"Check In",G=r=>{if(!r)return"--:--";try{let n;if(typeof r=="string"&&r.includes(":")&&!r.includes("T")){const p=new Date,[S,C,I]=r.split(":");n=new Date(p.getFullYear(),p.getMonth(),p.getDate(),S,C,I||0)}else n=new Date(r);return isNaN(n.getTime())?r:n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(n){return console.warn("Error formatting time:",r,n),r}},Z=r=>{if(!r)return"Location not available";try{if(typeof r=="object"&&r.lat&&r.lng)return r.address&&r.address.trim()?r.address.substring(0,30):`${r.lat.toFixed(4)}, ${r.lng.toFixed(4)}`;if(typeof r=="string")try{const n=JSON.parse(r);if(n.lat&&n.lng)return n.address&&n.address.trim()?n.address.substring(0,30):`${n.lat.toFixed(4)}, ${n.lng.toFixed(4)}`}catch{return r.substring(0,30)}return"Location not available"}catch(n){return console.warn("Error formatting location:",r,n),"Location not available"}};return l(v,{sx:{mx:"auto",p:2,display:"flex",flexDirection:"column"},children:[l(De,{children:[l(Ue,{sx:{p:2,textAlign:"center",position:"relative"},children:[l(v,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[l(v,{sx:{display:"flex",alignItems:"center",flex:1},children:[o(ut,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:o(v,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:Y()==="success"?"success.main":Y()==="warning"?"warning.main":"grey.400",border:`2px solid ${e.palette.background.paper}`}}),children:o($e,{sx:{width:48,height:48,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,fontSize:"1.2rem"},children:t!=null&&t.profile_image?o("img",{src:t.profile_image,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):(J=t==null?void 0:t.name)==null?void 0:J.charAt(0).toUpperCase()})}),l(v,{sx:{ml:2,textAlign:"left"},children:[o(d,{variant:"h6",sx:{fontWeight:600,fontSize:"1rem",lineHeight:1.2},children:t==null?void 0:t.name}),l(d,{variant:"caption",color:"text.secondary",children:["ID: ",(t==null?void 0:t.employee_id)||(t==null?void 0:t.id)]})]})]}),l(v,{sx:{textAlign:"right"},children:[o(d,{variant:"h5",sx:{fontWeight:300,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent",lineHeight:1},children:V.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}),o(d,{variant:"caption",color:"text.secondary",children:V.toLocaleDateString("en-US",{weekday:"short",day:"numeric"})})]})]}),o(K,{label:ue(),color:Y(),sx:{mb:2,fontSize:"0.8rem",py:1.5,px:2,height:32,borderRadius:2,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.3px"},icon:s==="punched_in"?o(Ie,{sx:{fontSize:16}}):o(Re,{sx:{fontSize:16}})}),l(E,{container:!0,spacing:1,sx:{mb:2},children:[o(E,{item:!0,xs:6,children:l(Q,{variant:"outlined",sx:{p:1.5,textAlign:"center",background:i(e.palette.primary.main,.05),border:`1px solid ${i(e.palette.primary.main,.1)}`,borderRadius:2},children:[o(Ot,{color:"primary",sx:{fontSize:20,mb:.5}}),o(d,{variant:"h6",color:"primary",sx:{fontWeight:700,fontSize:"1rem",fontFamily:"monospace",letterSpacing:"0.5px"},children:H}),o(d,{variant:"caption",color:"text.secondary",children:"Hours Today"})]})}),o(E,{item:!0,xs:6,children:l(Q,{variant:"outlined",sx:{p:1.5,textAlign:"center",background:i(e.palette.secondary.main,.05),border:`1px solid ${i(e.palette.secondary.main,.1)}`,borderRadius:2},children:[o(Rt,{color:"secondary",sx:{fontSize:20,mb:.5}}),o(d,{variant:"h6",color:"secondary",sx:{fontWeight:700,fontSize:"1rem"},children:c.length}),o(d,{variant:"caption",color:"text.secondary",children:"Sessions"})]})})]}),o(ze,{variant:"contained",size:"large",fullWidth:!0,onClick:oe,disabled:f||y,sx:{mb:2,height:48,borderRadius:3,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:"white",fontWeight:600,fontSize:"1rem",textTransform:"none",boxShadow:`0 6px 20px ${i(e.palette.primary.main,.3)}`,backdropFilter:"blur(16px) saturate(200%)",border:`1px solid ${i(e.palette.primary.main,.2)}`,"&:hover":{background:`linear-gradient(135deg, ${e.palette.primary.dark}, ${e.palette.secondary.dark})`,transform:"translateY(-1px)",boxShadow:`0 8px 25px ${i(e.palette.primary.main,.4)}`},"&:disabled":{background:i(e.palette.action.disabled,.1),color:e.palette.action.disabled,backdropFilter:"blur(16px) saturate(200%)"}},startIcon:f?o(Ye,{size:18,color:"inherit"}):s==="punched_in"?o(Re,{}):o(Ie,{}),children:f?"Processing...":ae()}),l(Ee,{direction:"row",spacing:.5,justifyContent:"center",children:[o(me,{title:`GPS: ${w.location?"Connected":"Disconnected"}`,children:o(K,{size:"small",icon:o(Oe,{sx:{fontSize:14}}),label:"GPS",color:w.location?"success":"default",variant:w.location?"filled":"outlined",sx:{fontSize:"0.7rem",height:24}})}),o(me,{title:`Network: ${w.network?"Online":"Offline"}`,children:o(K,{size:"small",icon:o(_t,{sx:{fontSize:14}}),label:"Net",color:w.network?"success":"default",variant:w.network?"filled":"outlined",sx:{fontSize:"0.7rem",height:24}})}),o(me,{title:"Device Security",children:o(K,{size:"small",icon:o(Ge,{sx:{fontSize:14}}),label:"Secure",color:"success",variant:"filled",sx:{fontSize:"0.7rem",height:24}})})]})]}),y&&l(we,{severity:"warning",sx:{mx:2,mb:2,borderRadius:2,background:i(e.palette.warning.main,.1),border:`1px solid ${i(e.palette.warning.main,.2)}`,backdropFilter:"blur(16px) saturate(200%)",fontSize:"0.8rem"},children:[l(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.8rem"},children:["On ",y.leave_type," Leave"]}),l(d,{variant:"caption",children:[new Date(y.from_date).toLocaleDateString()," - ",new Date(y.to_date).toLocaleDateString()]})]}),l(v,{sx:{borderTop:`1px solid ${i(e.palette.divider,.1)}`},children:[l(v,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer","&:hover":{background:i(e.palette.primary.main,.02)}},onClick:()=>pe("punches"),children:[l(v,{sx:{display:"flex",alignItems:"center"},children:[o(It,{color:"primary",sx:{mr:1,fontSize:20}}),o(d,{variant:"subtitle1",sx:{fontWeight:600,fontSize:"0.9rem"},children:"Today's Activity"})]}),o(ke,{size:"small",children:ee.punches?o(kt,{}):o($t,{})})]}),o(He,{in:ee.punches,children:o(v,{sx:{px:2,pb:2},children:c.length>0?o(Je,{sx:{p:0},children:c.map((r,n)=>l(Ae.Fragment,{children:[l(qe,{sx:{px:0,py:1},children:[o(St,{sx:{minWidth:36},children:o($e,{sx:{width:24,height:24,bgcolor:"primary.main"},children:o(wt,{sx:{fontSize:14}})})}),o(Qe,{primary:l(v,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[l(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.8rem"},children:["In: ",G(r.punchin_time||r.punch_in_time||r.time_in)]}),(r.punchout_time||r.punch_out_time||r.time_out)&&l(d,{variant:"body2",sx:{fontWeight:600,fontSize:"0.8rem"},children:["Out: ",G(r.punchout_time||r.punch_out_time||r.time_out)]}),r.duration&&o(K,{label:r.duration,size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.6rem",height:20}})]}),secondary:l(d,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:["📍 ",Z(r.punchin_location||r.location),"..."]})})]}),n<c.length-1&&o(Xe,{})]},n))}):o(we,{severity:"info",sx:{background:i(e.palette.info.main,.05),border:`1px solid ${i(e.palette.info.main,.1)}`,backdropFilter:"blur(16px) saturate(200%)",fontSize:"0.8rem"},children:o(d,{variant:"body2",sx:{fontSize:"0.8rem"},children:"No activity recorded today"})})})})]})]}),l(et,{open:W,onClose:()=>A(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{backdropFilter:"blur(20px) saturate(180%)",background:`linear-gradient(135deg, ${i(e.palette.background.paper,.9)}, ${i(e.palette.primary.main,.05)})`,border:`1px solid ${i(e.palette.primary.main,.3)}`,borderRadius:4,boxShadow:`0 20px 40px ${i(e.palette.primary.main,.2)}`,m:1,overflow:"hidden"}},children:[l(v,{sx:{position:"relative",background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:"white",p:3,textAlign:"center"},children:[o(ke,{onClick:()=>A(!1),sx:{position:"absolute",top:8,right:8,color:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)","&:hover":{color:"white",background:i(e.palette.common.white,.1)}},children:o(Ve,{})}),o(ot,{sx:{fontSize:48,mb:1,opacity:.9}}),o(d,{variant:"h5",sx:{fontWeight:700,mb:.5},children:"Attendance Recorded"}),o(d,{variant:"body2",sx:{opacity:.9},children:"Your attendance has been successfully captured"})]}),l(tt,{sx:{p:3},children:[l(E,{container:!0,spacing:2,children:[o(E,{item:!0,xs:12,sm:6,children:l(Q,{sx:{p:2.5,textAlign:"center",background:`linear-gradient(135deg, ${i(e.palette.info.main,.1)}, ${i(e.palette.info.main,.05)})`,border:`1px solid ${i(e.palette.info.main,.2)}`,borderRadius:3,backdropFilter:"blur(10px)",transition:"transform 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${i(e.palette.info.main,.15)}`}},children:[o(v,{sx:{width:48,height:48,borderRadius:"50%",background:`linear-gradient(135deg, ${e.palette.info.main}, ${e.palette.info.dark})`,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:o(zt,{sx:{color:"white",fontSize:24}})}),o(d,{variant:"h6",color:"info.main",sx:{fontWeight:700,mb:.5},children:j.ip}),o(d,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"IP Address"})]})}),o(E,{item:!0,xs:12,sm:6,children:l(Q,{sx:{p:2.5,textAlign:"center",background:`linear-gradient(135deg, ${i(e.palette.success.main,.1)}, ${i(e.palette.success.main,.05)})`,border:`1px solid ${i(e.palette.success.main,.2)}`,borderRadius:3,backdropFilter:"blur(10px)",transition:"transform 0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${i(e.palette.success.main,.15)}`}},children:[o(v,{sx:{width:48,height:48,borderRadius:"50%",background:`linear-gradient(135deg, ${e.palette.success.main}, ${e.palette.success.dark})`,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:o(Oe,{sx:{color:"white",fontSize:24}})}),o(d,{variant:"h6",color:"success.main",sx:{fontWeight:700,mb:.5},children:j.accuracy}),o(d,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"GPS Accuracy"})]})})]}),o(Q,{sx:{mt:2,p:2,background:i(e.palette.background.default,.5),border:`1px solid ${i(e.palette.divider,.2)}`,borderRadius:2,backdropFilter:"blur(10px)"},children:l(v,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[o(at,{color:"primary",sx:{mr:1,fontSize:20}}),l(d,{variant:"body2",color:"text.secondary",sx:{fontWeight:600},children:["Recorded at: ",j.timestamp]})]})})]}),o(rt,{sx:{p:3,pt:0},children:o(ze,{onClick:()=>A(!1),variant:"contained",fullWidth:!0,sx:{height:48,borderRadius:3,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backdropFilter:"blur(16px) saturate(200%)",fontWeight:600,textTransform:"none",boxShadow:`0 6px 20px ${i(e.palette.primary.main,.3)}`,"&:hover":{background:`linear-gradient(135deg, ${e.palette.primary.dark}, ${e.palette.secondary.dark})`,transform:"translateY(-1px)",boxShadow:`0 8px 25px ${i(e.palette.primary.main,.4)}`}},children:"Continue"})})]}),o(xt,{size:"small",onClick:D,sx:{position:"fixed",bottom:16,right:16,background:i(e.palette.background.paper,.8),backdropFilter:"blur(16px) saturate(200%)",border:`1px solid ${i(e.palette.divider,.2)}`,width:40,height:40,"&:hover":{background:i(e.palette.primary.main,.1)}},children:o(nt,{sx:{fontSize:18}})})]})};export{Qt as default};
