import{j as n,a as e,M as D}from"./app-Blpamcva.js";import{i as w,j as k,u as Q,t as q,r as d,B as l,T as o,c as K,w as y,f as h,a9 as X,G as s,a as m,h as A,C as M,y as b}from"./vendor-Dz0S-B-S.js";import{G as x,A as C}from"./App-DaWfJDeQ.js";import{R as J}from"./Refresh-CRq7m_6F.js";import{D as Y}from"./Download-DOhEiHFB.js";import{C as Z}from"./CheckCircle-CibEscyb.js";const ee=w(k.jsx("path",{d:"m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83"}),"Speed"),te=w(k.jsx("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp"),re=w(k.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),ne=({auth:p,title:u="Performance Dashboard"})=>{var P,S,L,F,R,W;const g=Q();q(g.breakpoints.down("md"));const[E,G]=d.useState(!0),[O,T]=d.useState(!1),[i,N]=d.useState(null),[U,j]=d.useState([]);d.useState("24h");const f=async()=>{try{T(!0);const r=await fetch("/storage/app/performance/baseline.json");let a=null;r.ok&&(a=await r.json());const t=await fetch("/storage/app/performance/comparison.json");let c=null;t.ok&&(c=await t.json());const B=await fetch("/storage/app/reports/performance-export.json");let z=null;B.ok&&(z=await B.json()),N({baseline:a,comparison:c,report:z,lastUpdated:new Date});const v=[];a&&(a.overall.performanceScore<70&&v.push({type:"error",message:`Performance score is below threshold: ${a.overall.performanceScore}/100`}),a.overall.totalIssues>0&&v.push({type:"warning",message:`${a.overall.totalIssues} performance issues detected`})),c&&c.summary.regressions.length>0&&v.push({type:"error",message:`${c.summary.regressions.length} performance regressions detected`}),j(v)}catch(r){console.error("Failed to fetch performance data:",r),j([{type:"error",message:"Failed to load performance data. Please check if performance monitoring is running."}])}finally{T(!1),G(!1)}};d.useEffect(()=>{f();const r=setInterval(f,5*60*1e3);return()=>clearInterval(r)},[]);const V=async()=>{var r;try{(await fetch("/api/performance/generate-report",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content")}})).ok&&await f()}catch(a){console.error("Failed to generate report:",a)}},I=()=>{const r=document.createElement("a");r.href="/storage/app/reports/performance-export.json",r.download=`glass-erp-performance-${new Date().toISOString().split("T")[0]}.json`,r.click()},$=({score:r,size:a=120})=>{const t=c=>c>=90?g.palette.success.main:c>=70?g.palette.warning.main:g.palette.error.main;return n(l,{position:"relative",display:"inline-flex",children:[e(A,{variant:"determinate",value:r,size:a,thickness:4,sx:{color:t(r)}}),n(l,{position:"absolute",top:0,left:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[e(o,{variant:"h4",component:"div",color:t(r),fontWeight:"bold",children:r}),e(o,{variant:"caption",color:"text.secondary",children:"/100"})]})]})},_=({vitals:r})=>{if(!r)return null;const a=[{name:"FCP",value:r.FCP,unit:"ms",threshold:1800,label:"First Contentful Paint"},{name:"LCP",value:r.LCP,unit:"ms",threshold:2500,label:"Largest Contentful Paint"},{name:"FID",value:r.FID,unit:"ms",threshold:100,label:"First Input Delay"},{name:"INP",value:r.INP||0,unit:"ms",threshold:200,label:"Interaction to Next Paint"},{name:"CLS",value:r.CLS,unit:"",threshold:.1,label:"Cumulative Layout Shift"},{name:"TTFB",value:r.TTFB,unit:"ms",threshold:800,label:"Time to First Byte"}];return e(s,{container:!0,spacing:2,children:a.map(t=>e(s,{item:!0,xs:12,sm:6,md:2,children:e(M,{children:n(m,{sx:{textAlign:"center",py:2},children:[e(o,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:t.name}),n(o,{variant:"h4",component:"div",sx:{color:t.value<=t.threshold?"success.main":"error.main",fontWeight:"bold"},children:[t.name==="CLS"?t.value.toFixed(3):Math.round(t.value),e(o,{variant:"caption",component:"span",sx:{ml:.5},children:t.unit})]}),e(o,{variant:"caption",color:"text.secondary",children:t.label}),e("br",{}),e(b,{size:"small",label:t.value<=t.threshold?"Good":"Needs Work",color:t.value<=t.threshold?"success":"error",sx:{mt:1}})]})})},t.name))})},H=({features:r})=>r?e(s,{container:!0,spacing:2,children:Object.entries(r).map(([a,t])=>e(s,{item:!0,xs:12,sm:6,md:4,children:e(M,{children:n(m,{children:[n(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e(o,{variant:"h6",children:a}),e(b,{size:"small",label:t.priority,color:t.priority==="high"?"error":t.priority==="medium"?"warning":"default"})]}),n(o,{variant:"h4",sx:{color:t.averageLoadTime<=t.target?"success.main":"warning.main",fontWeight:"bold"},children:[Math.round(t.averageLoadTime),"ms"]}),n(o,{variant:"body2",color:"text.secondary",children:["Target: ",t.target,"ms | Routes: ",Object.keys(t.routes).length]}),e(l,{mt:1,children:e(b,{size:"small",icon:t.averageLoadTime<=t.target?e(Z,{}):e(re,{}),label:t.averageLoadTime<=t.target?"Meeting Target":"Exceeds Target",color:t.averageLoadTime<=t.target?"success":"warning"})})]})})},a))}):null;return E?n(C,{title:u,auth:p,children:[e(D,{title:u}),e(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e(A,{size:60})})]}):n(C,{title:u,auth:p,children:[e(D,{title:u}),n(l,{sx:{p:{xs:2,md:3}},children:[n(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[n(l,{children:[e(o,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"ðŸš€ Performance Monitor"}),e(o,{variant:"body1",color:"text.secondary",children:"Real-time performance monitoring and optimization insights"})]}),n(l,{display:"flex",gap:1,children:[e(y,{title:"Refresh Data",children:e(K,{onClick:f,disabled:O,color:"primary",children:e(J,{})})}),e(y,{title:"Generate Report",children:e(h,{variant:"outlined",startIcon:e(te,{}),onClick:V,size:"small",children:"Generate Report"})}),e(y,{title:"Download Data",children:e(h,{variant:"outlined",startIcon:e(Y,{}),onClick:I,size:"small",children:"Export"})})]})]}),U.map((r,a)=>e(X,{severity:r.type,sx:{mb:2},children:r.message},a)),n(s,{container:!0,spacing:3,mb:3,children:[e(s,{item:!0,xs:12,md:3,children:e(x,{children:n(m,{sx:{textAlign:"center",py:4},children:[e(o,{variant:"h6",gutterBottom:!0,children:"Overall Performance"}),e($,{score:((S=(P=i==null?void 0:i.baseline)==null?void 0:P.overall)==null?void 0:S.performanceScore)||0}),n(o,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block"},children:["Last Updated: ",(L=i==null?void 0:i.lastUpdated)==null?void 0:L.toLocaleTimeString()]})]})})}),e(s,{item:!0,xs:12,md:9,children:e(x,{children:n(m,{children:[e(o,{variant:"h6",gutterBottom:!0,children:"ðŸ“Š Core Web Vitals"}),e(_,{vitals:(R=(F=i==null?void 0:i.baseline)==null?void 0:F.overall)==null?void 0:R.coreWebVitals})]})})})]}),e(x,{sx:{mb:3},children:n(m,{children:[e(o,{variant:"h6",gutterBottom:!0,children:"ðŸ“¦ Feature Module Performance"}),e(H,{features:(W=i==null?void 0:i.baseline)==null?void 0:W.features})]})}),e(x,{children:n(m,{children:[e(o,{variant:"h6",gutterBottom:!0,children:"ðŸ”§ Quick Actions"}),n(s,{container:!0,spacing:2,children:[e(s,{item:!0,xs:12,sm:6,md:3,children:e(h,{fullWidth:!0,variant:"outlined",startIcon:e(ee,{}),onClick:()=>window.open("/storage/app/reports/performance-dashboard.html","_blank"),children:"View Full Dashboard"})}),e(s,{item:!0,xs:12,sm:6,md:3,children:e(h,{fullWidth:!0,variant:"outlined",onClick:()=>window.open("/storage/app/reports/technical-report.md","_blank"),children:"Technical Report"})}),e(s,{item:!0,xs:12,sm:6,md:3,children:e(h,{fullWidth:!0,variant:"outlined",onClick:()=>window.open("/storage/app/reports/executive-summary.md","_blank"),children:"Executive Summary"})}),e(s,{item:!0,xs:12,sm:6,md:3,children:e(h,{fullWidth:!0,variant:"outlined",onClick:I,children:"Download Data"})})]})]})})]})]})};ne.layout=p=>e(C,{children:p});export{ne as default};
