import{a as e,j as t,F as I,q as Y,Y as Q}from"./app-XDT0crAB.js";import{s as V,j as $,u as z,h as J,i as F,k as s,l as K,f as W,T as w,A as U,V as X,c as _,n as Z,o as ee,r as l,O as ae,G as p,F as re,m as te,S as ne,M as E,W as se,b,P as oe,Q as le,p as ie,e as de,q as ce,B as C,a as L}from"./vendor-CrYfq8AM.js";import{r as pe,B as ue,G as P,A as he}from"./App-DRAveRzv.js";import{E as me,D as ye}from"./Edit-CuMxeTGO.js";import{d as ve,G as fe}from"./GlassDialog-5W3KlEBR.js";import{L as xe}from"./LoadingButton-Y-VpjT4P.js";import{A as ge}from"./Add-pfpLCbp3.js";var k={},be=V;Object.defineProperty(k,"__esModule",{value:!0});var j=k.default=void 0,we=be(pe()),Ce=$;j=k.default=(0,we.default)((0,Ce.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"RadioButtonChecked");const Se=({allLeaves:x,allUsers:d})=>{const y=z();return e(ee,{style:{maxHeight:"84vh",overflowY:"auto"},children:t(Z,{"aria-label":"leave employee table",children:[e(J,{children:t(F,{children:[e(s,{sx:{whiteSpace:"nowrap"},children:"Leave Type"}),e(s,{sx:{whiteSpace:"nowrap"},children:"From"}),e(s,{sx:{whiteSpace:"nowrap"},children:"To"}),e(s,{sx:{whiteSpace:"nowrap"},children:"No of Days"}),e(s,{sx:{whiteSpace:"nowrap"},children:"Reason"}),e(s,{sx:{whiteSpace:"nowrap"},children:"Status"}),e(s,{sx:{whiteSpace:"nowrap"},children:"Approved by"}),e(s,{sx:{whiteSpace:"nowrap"},align:"center",children:"Actions"})]})}),e(K,{children:x.map(n=>t(F,{children:[e(s,{sx:{whiteSpace:"nowrap"},children:n.leave_type}),e(s,{sx:{whiteSpace:"nowrap"},children:new Date(n.from_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(s,{sx:{whiteSpace:"nowrap"},children:new Date(n.to_date).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}),e(s,{sx:{whiteSpace:"nowrap"},children:n.no_of_days}),e(s,{sx:{whiteSpace:"nowrap"},children:n.reason}),e(s,{sx:{whiteSpace:"nowrap"},children:t(W,{variant:"outlined",color:"primary",sx:{borderRadius:"50px"},children:[e(j,{})," ",n.status]})}),e(s,{sx:{whiteSpace:"nowrap"},children:n.approved_by?t(w,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(U,{src:d.find(o=>o.id===n.approved_by).avatar,alt:d.find(o=>o.id===n.approved_by).name}),e(w,{sx:{marginLeft:"10px"},children:e(X,{href:"#",sx:{textDecoration:"none",color:y.palette.text.primary,fontWeight:"bold"},children:d.find(o=>o.id===n.approved_by).name})})]}):null}),t(s,{sx:{whiteSpace:"nowrap"},align:"center",children:[e(_,{href:"#",onClick:()=>{},children:e(me,{})}),e(_,{href:"#",onClick:()=>{},children:e(ye,{})})]})]},n.id))})]})})},De=({open:x,closeModal:d,leaveTypes:y,leaveCounts:n,setLeavesData:o})=>{const[h,S]=l.useState("Casual"),[v,D]=l.useState(""),[g,m]=l.useState(""),[B,q]=l.useState(""),[M,G]=l.useState(""),[R,O]=l.useState(""),[i,H]=l.useState({}),[A,T]=l.useState(!1);return l.useEffect(()=>{console.log(h);const a=n.find(f=>f.leave_type===h);console.log(a),G(a.remaining_days)},[h]),l.useEffect(()=>{q(((f,u)=>{if(!f||!u)return"";const c=new Date(f),r=new Date(u);if(c>r)return"";const N=r.getTime()-c.getTime();return Math.ceil(N/(1e3*3600*24))+1})(v,g))},[v,g]),t(fe,{open:x,onClose:d,fullWidth:!0,maxWidth:"sm",children:[t(ae,{sx:{display:"flex",alignItems:"center"},children:[e(w,{variant:"h6",children:"Add Leave"}),e(_,{onClick:d,sx:{position:"absolute",top:8,right:16},children:e(ve,{})})]}),t("form",{onSubmit:async a=>{a.preventDefault(),T(!0);const f=new Promise(async(u,c)=>{try{const r=await axios.post(route("leave-add"),{leaveType:h,fromDate:v,toDate:g,daysCount:B,leaveReason:R});r.status===200&&(o(r.data.leavesData),u([r.data.messages||"Leave application submitted successfully"]),d())}catch(r){T(!1),r.response?(r.response.status===422?(H(r.response.data.errors||{}),c(r.response.data.error||"Failed to submit leave application")):c("An unexpected error occurred. Please try again later."),console.error(r.response.data),console.error(r.response||{})):r.request?(c("No response received from the server. Please check your internet connection."),console.error(r.request)):(c("An error occurred while setting up the request."),console.error("Error",r.message))}finally{T(!1)}});ue.promise(f,{pending:{render(){return t("div",{style:{display:"flex",alignItems:"center"},children:[e(ie,{}),e("span",{style:{marginLeft:"8px"},children:"Submitting leave application..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.backgroundColor,border:theme.glassCard.border,color:theme.palette.text.primary}},success:{render({data:u}){return e(I,{children:u.map((c,r)=>e("div",{children:c},r))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.backgroundColor,border:theme.glassCard.border,color:theme.palette.text.primary}},error:{render({data:u}){return e(I,{children:u})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:theme.glassCard.backgroundColor,border:theme.glassCard.border,color:theme.palette.text.primary}}})},children:[e(oe,{children:t(p,{container:!0,spacing:2,children:[e(p,{item:!0,xs:12,md:6,children:t(re,{fullWidth:!0,children:[e(te,{id:"leave-type-label",children:"Leave Type"}),t(ne,{labelId:"leave-type-label",value:h,onChange:a=>S(a.target.value),label:"Leave Type",error:!!i.leaveType,children:[e(E,{value:"",disabled:!0,children:"Select Leave Type"}),y.map(a=>t(E,{value:a.type,children:[a.type," ",a.days," Days"]},a.id))]}),e(se,{children:i.leaveType})]})}),e(p,{item:!0,xs:12,md:6,children:e(b,{label:"From",type:"date",fullWidth:!0,value:v,onChange:a=>D(a.target.value),InputLabelProps:{shrink:!0},error:!!i.fromDate,helperText:i.fromDate})}),e(p,{item:!0,xs:12,md:6,children:e(b,{label:"To",type:"date",fullWidth:!0,value:g,onChange:a=>m(a.target.value),InputLabelProps:{shrink:!0},error:!!i.toDate,helperText:i.toDate})}),e(p,{item:!0,xs:12,md:6,children:e(b,{label:"Number of days",type:"text",fullWidth:!0,value:B,InputProps:{readOnly:!0},error:!!i.daysCount,helperText:i.daysCount})}),e(p,{item:!0,xs:12,md:6,children:e(b,{label:"Remaining Leaves",type:"text",fullWidth:!0,value:M,InputProps:{readOnly:!0},error:!!i.remainingLeaves,helperText:i.remainingLeaves})}),e(p,{item:!0,xs:12,children:e(b,{label:"Leave Reason",multiline:!0,rows:4,fullWidth:!0,value:R,onChange:a=>O(a.target.value),error:!!i.leaveReason,helperText:i.leaveReason})})]})}),e(le,{sx:{padding:"16px",justifyContent:"center"},children:e(xe,{type:"submit",variant:"outlined",color:"primary",loading:A,disabled:A,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},Ee=({title:x,allUsers:d})=>{const[y,n]=l.useState(null),[o,h]=l.useState(Y().props.leavesData),[S,v]=l.useState(o.allLeaves);l.useEffect(()=>{v(o.allLeaves)},[o]),console.log(o);const D=m=>{n(m)};return t(he,{children:[e(Q,{title:x}),y==="leave"&&e(De,{open:y==="leave",setLeavesData:h,closeModal:()=>{n(null)},leaveTypes:o.leaveTypes,leaveCounts:o.leaveCounts}),e(C,{sx:{display:"flex",justifyContent:"center",p:2},children:e(de,{in:!0,children:t(P,{children:[e(ce,{title:"Leaves",sx:{padding:"24px"},action:e(C,{display:"flex",gap:2,children:e(W,{title:"Add Leave",variant:"outlined",color:"success",startIcon:e(ge,{}),onClick:()=>D("leave"),children:"Add Leave"})})}),e(L,{children:e(p,{container:!0,spacing:2,children:o.leaveCounts.map(m=>e(p,{item:!0,xs:12,sm:6,md:3,children:e(P,{children:e(L,{children:e(C,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",textAlign:"center",children:t(C,{children:[e(w,{variant:"h6",children:m.leave_type}),e(w,{variant:"h4",children:m.days_used})]})})})})},m.leave_type))})}),e(L,{children:e(Se,{allLeaves:S,allUsers:d})})]})})})]})};export{Ee as default};
