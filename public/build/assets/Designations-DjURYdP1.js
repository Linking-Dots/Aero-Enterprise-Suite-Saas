import{J as le,r as i,a as e,j as o,M as Ce,h as $,F as Ne,b as k,Q as Pe}from"./app-DDhVNfvV.js";import{u as ce,G as Se}from"./GlassCard-B8deHOrc.js";import{P as Te}from"./PageHeader-qfMvUU9K.js";import{S as Fe}from"./StatsCards-CaEaffu4.js";import{n as Ee,o as Ie,p as W,q as Ae,a as de,b as Me,u as Q,I as me,i as M,j as ke,z as Re,D as Be,B as N,c as $e,G as je,d as ze,A as Le}from"./App-CULBC9Jb.js";import"./dayjs.min-Dao2E2MD.js";import{N as Oe}from"./NoDataMessage-DUtrP5yS.js";import{a as q,F as Ge}from"./UserGroupIcon-CFQYzcyB.js";import{F as ae}from"./EyeIcon-B-1DdV8E.js";import{F as re}from"./PencilIcon-BtapQh-d.js";import{F as se}from"./TrashIcon-rGR8b_v2.js";import{F as We}from"./EllipsisVerticalIcon-0SYcdA89.js";import{F as ue}from"./CheckCircleIcon-BkPxWqsz.js";import{a as Ve,b as Qe,c as qe,d as He,e as Ue,t as Ye}from"./chunk-F3UDT23P-Bon0qFEG.js";import{p as Je}from"./chunk-O5I3QTYU-BlPqa12Y.js";import{t as V}from"./chunk-7ZZXWEXF-D8xxaoD-.js";import{c as Xe}from"./chunk-J7I6W5JF-Dj4B-Czi.js";import{G as Ze}from"./GlassDialog-BbPdd5-L.js";import{D as he}from"./DialogTitle-DVsFppiK.js";import{T as E,B as H}from"./logo-DoLGM3I0.js";import{F as pe}from"./XMarkIcon-CRGrHH6E.js";import{D as j}from"./Divider-anknaL5v.js";import{T as Ke,I as et,F as oe}from"./TextField-DHyBbceL.js";import{S as tt,M as ne}from"./Select-G4UAMmZq.js";import{D as fe,a as ge}from"./DialogContent-DzqEob6e.js";import{B as z}from"./Button-PH-Yt16S.js";import{F as at}from"./ExclamationTriangleIcon-3tpAB86s.js";import{A as ie}from"./Alert-CzNvw6o_.js";import{C as be}from"./CircularProgress-ukpRde3Q.js";import{D as rt}from"./Dialog-B0tTkTVF.js";import{i as st}from"./chunk-6MDMHKHV-DNEscIMF.js";import"./app-CYwLuuRk.js";import"./create-visual-element-DIA5r6xh.js";import"./chunk-D5XJWRAV-BEd1Mod5.js";import"./DocumentTextIcon-QwzC9WoH.js";import"./EnvelopeIcon-jGHS91X9.js";import"./UserIcon-BZDmR83e.js";import"./CreditCardIcon-nnu7lg95.js";import"./ShieldCheckIcon-B8pnYfIx.js";import"./ClockIcon-UBQM4q2z.js";import"./QuestionMarkCircleIcon-ClI4UiU9.js";import"./BuildingOfficeIcon-BXNAJj1w.js";import"./KeyIcon-CAZJdP6I.js";import"./InformationCircleIcon-D0VUrEF1.js";import"./StarIcon-CB497gpk.js";import"./GlobeAltIcon-BeSAdHAC.js";import"./LockClosedIcon-CNT0kaEE.js";import"./chunk-LGMZDQT5-CF5HrKbt.js";import"./number-DfkVkf0F.js";import"./index-I7bPq2YP.js";import"./chunk-A6PX3NG3-DZLS-1Gt.js";import"./useLabels-Blg_QI1U.js";import"./chunk-MZRCPRP2-4Sm2aTj8.js";import"./useHasTabbableChild-BMncZCCk.js";import"./chunk-7F3ZLNJ6-CHfbZssJ.js";import"./index-CokAva9Y.js";import"./chunk-M3MASYO7-DaLySJZS.js";import"./useFormReset-Dv_1w4_q.js";import"./Popover-DGnHN2Gx.js";import"./useSlot-vNKPmkVG.js";import"./useLabel-C1JBDqVQ.js";const ot=({designations:l,onEdit:n,onDelete:P,onView:s,loading:d,isMobile:x,isTablet:m,pagination:r,onPageChange:D,onRowsPerPageChange:u,canEditDesignation:v=!1,canDeleteDesignation:g=!1})=>{var _,w;const{auth:f}=le().props,h=v||((_=f.permissions)==null?void 0:_.includes("designations.update"))||!1,c=g||((w=f.permissions)==null?void 0:w.includes("designations.delete"))||!1,F=i.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),y=(a,T)=>{switch(T){case"title":return e("span",{className:"font-semibold text-foreground",children:a.title});case"department_name":return e("span",{className:"text-default-500",children:a.department_name||"-"});case"employee_count":return o("div",{className:"flex items-center gap-2",children:[e(Me,{className:"w-4 h-4 text-default-400"}),e("span",{children:a.employee_count||0})]});case"status":return e(Xe,{size:"sm",variant:a.is_active?"solid":"bordered",color:a.is_active?"success":"danger",startContent:a.is_active?e(ue,{className:"w-3 h-3"}):e(de,{className:"w-3 h-3"}),children:a.is_active?"Active":"Inactive"});case"actions":return e("div",{className:"flex justify-end items-center",children:x?o(Ae,{children:[e(Ee,{children:e($,{isIconOnly:!0,size:"sm",variant:"light",children:e(We,{className:"w-4 h-4"})})}),o(Ie,{"aria-label":"Designation actions",children:[e(W,{startContent:e(ae,{className:"w-4 h-4"}),onPress:()=>s(a),children:"View Details"},"view"),h&&e(W,{startContent:e(re,{className:"w-4 h-4"}),onPress:()=>n(a),children:"Edit Designation"},"edit"),c&&e(W,{className:"text-danger",color:"danger",startContent:e(se,{className:"w-4 h-4"}),isDisabled:a.employee_count>0,onPress:()=>P(a),children:"Delete Designation"},"delete")]})]}):o(Ne,{children:[e(V,{content:"View Designation",children:e($,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>s(a),children:e(ae,{className:"w-4 h-4"})})}),h&&e(V,{content:"Edit Designation",children:e($,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>n(a),children:e(re,{className:"w-4 h-4"})})}),c&&e(V,{content:a.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e($,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:a.employee_count>0,onPress:()=>P(a),children:e(se,{className:"w-4 h-4"})})})]})});default:return e("span",{children:a[T]})}},b=()=>!l||!l.data||d?null:o("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[o("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(r.currentPage-1)*r.perPage+1," to ",Math.min(r.currentPage*r.perPage,l.total)," of ",l.total," designations"]}),e(Je,{total:Math.ceil(l.total/r.perPage),initialPage:r.currentPage,page:r.currentPage,onChange:D,size:x?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!d&&(!l||!l.data||l.data.length===0)?e("div",{className:"w-full",children:e(Oe,{message:"No designations found",icon:e(q,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e("div",{className:"w-full",children:o(Ye,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:b(),children:[e(Ve,{columns:F,children:a=>e(Qe,{children:a.name},a.uid)}),e(qe,{items:l.data||[],emptyContent:!d&&"No designations found",loadingContent:e(Ce,{}),isLoading:d,children:a=>e(He,{children:T=>e(Ue,{children:y(a,T)})},a.id)})]})})},nt=({open:l,onClose:n,onSuccess:P,designation:s=null,departments:d=[]})=>{var y;const x=ce(),m=Q(x.breakpoints.down("md")),[r,D]=i.useState(!1),[u,v]=i.useState({}),g={title:"",department_id:"",is_active:!0},[f,h]=i.useState(g);i.useEffect(()=>{h(s?{title:s.title||"",department_id:s.department_id||"",is_active:s.is_active??!0}:g),v({})},[s,l]);const c=b=>{const{name:_,value:w,type:a,checked:T}=b.target;h(S=>({...S,[_]:a==="checkbox"?T:w})),u[_]&&v(S=>({...S,[_]:null}))},F=async()=>{var b,_;D(!0),v({});try{const w={...f};let a;s!=null&&s.id?(a=await k.put(`/designations/${s.id}`,w),N.success("Designation updated successfully")):(a=await k.post("/designations",w),N.success("Designation created successfully")),P(a.data.designation),n()}catch(w){if((_=(b=w.response)==null?void 0:b.data)!=null&&_.errors){v(w.response.data.errors);const a=Object.values(w.response.data.errors)[0];a&&N.error(a[0])}else N.error("An error occurred while saving the designation")}finally{D(!1)}};return o(Ze,{open:l,onClose:r?void 0:n,maxWidth:"sm",fullWidth:!0,fullScreen:m,"aria-labelledby":"designation-form-dialog",children:[o(he,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e(E,{variant:"h6",component:"div",children:s?"Edit Designation":"Create New Designation"}),e(me,{edge:"end",color:"inherit",onClick:n,disabled:r,"aria-label":"close",children:e(pe,{className:"w-5 h-5"})})]}),e(j,{}),e(fe,{sx:{pt:2},children:o(M,{container:!0,spacing:3,children:[e(M,{item:!0,xs:12,children:e(E,{variant:"subtitle1",color:"primary",gutterBottom:!0,children:"Designation Information"})}),e(M,{item:!0,xs:12,md:6,children:e(Ke,{name:"title",label:"Designation Title",fullWidth:!0,required:!0,value:f.title,onChange:c,error:!!u.title,helperText:((y=u.title)==null?void 0:y[0])||"",disabled:r})}),e(M,{item:!0,xs:12,md:6,children:o(ke,{fullWidth:!0,error:!!u.department_id,children:[e(et,{id:"department-label",children:"Department"}),o(tt,{labelId:"department-label",name:"department_id",value:f.department_id,onChange:c,label:"Department",disabled:r,children:[e(ne,{value:"",children:e("em",{children:"Select Department"})}),d.map(b=>e(ne,{value:b.id,children:b.name},b.id))]}),u.department_id&&e(oe,{children:u.department_id[0]})]})}),o(M,{item:!0,xs:12,children:[e(Re,{control:e(Be,{checked:f.is_active,onChange:c,name:"is_active",color:"success",disabled:r}),label:"Designation is active"}),u.is_active&&e(oe,{error:!0,children:u.is_active[0]})]})]})}),e(j,{}),o(ge,{sx:{px:3,py:2},children:[e(z,{onClick:n,disabled:r,color:"inherit",children:"Cancel"}),e(z,{onClick:F,variant:"contained",color:"primary",disabled:r,children:r?"Saving...":s?"Update Designation":"Create Designation"})]})]})},it=({open:l,onClose:n,onSuccess:P,designation:s})=>{const[d,x]=i.useState(!1),[m,r]=i.useState(null),D=async()=>{var u,v,g,f;if(s){x(!0),r(null);try{await k.delete(`/hr/designations/${s.id}`),N.success("Designation deleted successfully"),P(),n()}catch(h){if((v=(u=h.response)==null?void 0:u.data)!=null&&v.message)r(h.response.data.message),N.error(h.response.data.message);else if((f=(g=h.response)==null?void 0:g.data)!=null&&f.errors){const c=Object.values(h.response.data.errors)[0];r(c),N.error(c)}else r("An error occurred while deleting the designation"),N.error("An error occurred while deleting the designation")}finally{x(!1)}}};return s?o(rt,{open:l,onClose:d?void 0:n,maxWidth:"sm",fullWidth:!0,"aria-labelledby":"delete-designation-dialog",children:[o(he,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e(E,{variant:"h6",children:"Delete Designation"}),e(me,{edge:"end",color:"inherit",onClick:n,disabled:d,"aria-label":"close",children:e(pe,{className:"w-5 h-5"})})]}),e(j,{}),e(fe,{children:o(H,{sx:{display:"flex",flexDirection:"column",gap:2},children:[o(H,{sx:{display:"flex",alignItems:"center",gap:2},children:[e(at,{className:"w-8 h-8 text-yellow-500"}),o(E,{variant:"body1",children:["Are you sure you want to delete the designation ",e("strong",{children:s.title}),"?"]})]}),s.employee_count>0&&o(ie,{severity:"warning",sx:{mt:2},children:["This designation has ",s.employee_count," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]}),m&&e(ie,{severity:"error",sx:{mt:2},children:m}),e(E,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e(j,{}),o(ge,{sx:{px:3,py:2},children:[e(z,{onClick:n,disabled:d,color:"inherit",children:"Cancel"}),e(z,{onClick:D,variant:"contained",color:"error",disabled:d||s.employee_count>0,startIcon:d&&e(be,{size:20,color:"inherit"}),children:d?"Deleting...":"Delete Designation"})]})]}):null},fa=({title:l,initialDesignations:n,departments:P,managers:s,parentDesignations:d,stats:x,filters:m})=>{var K,ee,te;const{auth:r}=le().props,D=ce(),u=Q(D.breakpoints.down("sm"));Q(D.breakpoints.down("md"));const[v,g]=i.useState(n||{data:[]}),[f,h]=i.useState(!1),[c,F]=i.useState({type:null,designation:null}),[y,b]=i.useState({search:(m==null?void 0:m.search)||"",status:(m==null?void 0:m.status)||"all",parentDesignation:(m==null?void 0:m.parentDesignation)||"all"}),[_,w]=i.useState(!1),[a,T]=i.useState("table"),[S,L]=i.useState({currentPage:(n==null?void 0:n.current_page)||1,perPage:(n==null?void 0:n.per_page)||10}),[I,we]=i.useState(x||{total:0,active:0,inactive:0,parent_designations:0}),U=((K=r.permissions)==null?void 0:K.includes("designations.create"))||!1,Y=((ee=r.permissions)==null?void 0:ee.includes("designations.update"))||!1,J=((te=r.permissions)==null?void 0:te.includes("designations.delete"))||!1,O=i.useCallback(async()=>{h(!0);try{const t=await k.get(route("designations.json"),{params:{page:S.currentPage,per_page:S.perPage,search:y.search,status:y.status,parent_designation:y.parentDesignation}});g(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),N.error("Failed to load designations data")}finally{h(!1)}},[S,y]),G=i.useCallback(async()=>{try{const t=await k.get(route("designations.stats"));t.status===200&&we(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);i.useEffect(()=>{O(),G()},[O,G]);const ve=(t,C)=>{b(p=>({...p,[t]:C})),L(p=>({...p,currentPage:1}))},ye=t=>{L(C=>({...C,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},_e=t=>{L({currentPage:1,perPage:t})},R=(t,C=null)=>{F({type:t,designation:C})},X=()=>{F({type:null,designation:null})},Z=(t=null,C=null)=>{C==="add"&&t?g(p=>{const A=[t,...p.data];return{...p,data:A,total:(p.total||0)+1}}):C==="edit"&&t?g(p=>{const A=p.data.map(B=>B.id===t.id?t:B);return{...p,data:A}}):C==="delete"&&t?g(p=>{const A=p.data.filter(B=>B.id!==t.id);return{...p,data:A,total:(p.total||1)-1}}):(O(),G())},xe=i.useMemo(()=>[{title:"Total Designations",value:I.total,icon:e(q,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:I.active,icon:e(ue,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:I.inactive,icon:e(de,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:I.parent_designations,icon:e(Ge,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[I]),De=i.useMemo(()=>{const t=[];return U&&t.push({label:u?"Add":"Add Designation",icon:e($e,{className:"w-4 h-4"}),onPress:()=>R("add_designation"),className:"bg-gradient-to-r from-[var(--theme-primary)] to-[var(--theme-secondary)] text-white font-medium hover:opacity-90"}),t},[U,u]);return o(Le,{children:[e(Pe,{title:l}),e(H,{sx:{display:"flex",justifyContent:"center",p:2},children:e(je,{in:!0,timeout:800,children:e(Se,{children:e(Te,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e(q,{className:"w-8 h-8"}),variant:"default",actionButtons:De,children:o("div",{className:"p-4 sm:p-6",children:[e(Fe,{stats:xe,className:"mb-6"}),e("div",{className:"mb-6",children:e(st,{label:"Search",placeholder:"Search designations...",value:y.search,onValueChange:t=>ve("search",t),startContent:e(ze,{className:"w-4 h-4"}),size:"md"})}),e("div",{children:f?o("div",{className:"text-center py-6",children:[e(be,{size:40}),e(E,{className:"mt-4",children:"Loading..."})]}):e(ot,{designations:v,loading:f,onEdit:Y?t=>R("edit_designation",t):void 0,onDelete:J?t=>R("delete_designation",t):void 0,onView:t=>R("view_designation",t),pagination:S,onPageChange:ye,onRowsPerPageChange:_e,canEditDesignation:Y,canDeleteDesignation:J})})]})})})})}),(c.type==="add_designation"||c.type==="edit_designation")&&e(nt,{open:!0,departments:P,onClose:X,onSuccess:t=>Z(t,c.type==="add_designation"?"add":"edit"),designation:c.designation,managers:s,parentDesignations:d}),c.type==="delete_designation"&&e(it,{open:!0,onClose:X,onSuccess:t=>Z(t,"delete"),designation:c.designation})]})};export{fa as default};
