import{q as rt,j as g,a as n,F as L,Y as tt}from"./app-D9Wd_NfH.js";import{g as me,j as Y,i as Oe,s as nt,v as ie,y as at,B as z,Q as F,S as Z,R as vr,a2 as Se,b as K,c as U,r as m,D as Ie,T as pe,G as M,F as we,P as _e,W as ot,K as Pe,L as je,t as Re,X as it,f as Fe,z as lt,A as st,E as xr,H as ke,J as ct,x as ut,ak as w,M as dt,N as pt,e as ft,O as mt,a as Cr,I as gt}from"./vendor-N08UupYT.js";import{r as We,B as ee,G as ht,A as bt}from"./App-CRTO4RcG.js";import{X as yt,D as Ye,u as Ue,w as vt,d as Q,m as xt,a as Ct,A as kt,L as Dt,b as wt}from"./xlsx-mDc-c6oP.js";import{d as _t}from"./CheckCircle-DsNbmYGL.js";import{d as St}from"./Edit-kClFhQZ2.js";import{d as Ft}from"./Delete-C5k6UL8C.js";import{d as tr,G as ze}from"./GlassDialog-Dm9IIKlc.js";import{L as nr}from"./LoadingButton-QHHPzujN.js";import{C as At}from"./Clear-DSlIcD3B.js";const Et=me(Y.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),Tt=me(Y.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),Ot=me(Y.jsx("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm7 7V3.5L18.5 9z"}),"InsertDriveFile"),It=me(Y.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf"),Xe=me(Y.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");var ar={},Pt=Oe;Object.defineProperty(ar,"__esModule",{value:!0});var Rr=ar.default=void 0,jt=Pt(We()),Rt=Y;Rr=ar.default=(0,jt.default)((0,Rt.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2M8.5 15H7.3l-2.55-3.5V15H3.5V9h1.25l2.5 3.5V9H8.5zm5-4.74H11v1.12h2.5v1.26H11v1.11h2.5V15h-4V9h4zm7 3.74c0 .55-.45 1-1 1h-4c-.55 0-1-.45-1-1V9h1.25v4.51h1.13V9.99h1.25v3.51h1.12V9h1.25z"}),"FiberNew");var or={},Wt=Oe;Object.defineProperty(or,"__esModule",{value:!0});var Wr=or.default=void 0,zt=Wt(We()),Mt=Y;Wr=or.default=(0,zt.default)((0,Mt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");var ir={},Lt=Oe;Object.defineProperty(ir,"__esModule",{value:!0});var zr=ir.default=void 0,Ht=Lt(We()),$t=Y;zr=ir.default=(0,Ht.default)((0,$t.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error");var lr={},Bt=Oe;Object.defineProperty(lr,"__esModule",{value:!0});var Mr=lr.default=void 0,Kt=Bt(We()),Nt=Y;Mr=lr.default=(0,Kt.default)((0,Nt.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");const Vt=nt(yt)(({theme:e})=>({"& .rdt_Table":{backgroundColor:"transparent","& .rdt_TableHead":{"& .rdt_TableHeadRow":{backgroundColor:"transparent",color:e.palette.text.primary},top:0,zIndex:1},"& .rdt_TableBody":{overflowY:"auto",maxHeight:"52vh","& .rdt_TableRow":{minHeight:"auto",backgroundColor:"transparent",color:e.palette.text.primary,"& .rdt_TableCol":{backgroundColor:"transparent",borderBottom:`1px solid ${e.palette.divider}`,width:"auto",whiteSpace:"nowrap"}},"& .rdt_TableRow:hover":{backgroundColor:e.palette.action.hover}}}})),qt=({handleClickOpen:e,allInCharges:r,setDailyWorks:t,reports:i,juniors:a,reports_with_daily_works:o,openModal:u,setCurrentRow:c,filteredData:y,setFilteredData:d})=>{const{auth:h}=rt().props,f=ie(),k=h.roles.includes("admin"),_=h.roles.includes("se"),R=[{name:"Date",selector:l=>l.date,sortable:"true",center:"true",width:"100px"},{name:"RFI NO",selector:l=>l.number,sortable:"true",center:"true",width:"140px",cell:l=>g(L,{children:[l.number,l.reports&&l.reports.map(p=>n("div",{children:g("span",{children:[n("i",{className:"mdi mdi-circle-medium"})," ",p.ref_no]})},p.ref_no))]})},{name:"Status",selector:l=>l.status,sortable:"true",center:"true",width:"220px",cell:l=>g(Z,{variant:"outlined",size:"small",fullWidth:!0,value:l.status,onChange:p=>D(l.id,"status",p.target.value),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,borderRadius:2,boxShadow:f.glassCard.boxShadow}}},children:[n(F,{value:"new",children:g(z,{sx:{display:"flex"},children:[n(Rr,{style:{marginRight:8,color:T("new")}})," New"]})}),n(F,{value:"resubmission",children:g(z,{sx:{display:"flex"},children:[n(Wr,{style:{marginRight:8,color:T("resubmission")}})," Resubmission"]})}),n(F,{value:"completed",children:g(z,{sx:{display:"flex"},children:[n(_t,{style:{marginRight:8,color:T("completed")}})," Completed"]})}),n(F,{value:"emergency",children:g(z,{sx:{display:"flex"},children:[n(zr,{style:{marginRight:8,color:T("emergency")}})," Emergency"]})})]})},..._?[{name:"Assigned",selector:l=>l.assigned,sortable:"true",center:"true",cell:l=>g(Z,{variant:"outlined",fullWidth:!0,size:"small",value:l.assigned||"na",onChange:p=>D(l.id,"assigned",p.target.value),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,borderRadius:2,boxShadow:f.glassCard.boxShadow}}},children:[n(F,{value:"na",disabled:!0,children:"Please select"}),a.map(p=>n(F,{value:p.id,children:g(z,{sx:{display:"flex"},children:[n(vr,{src:`/assets/images/users/${p.user_name||"user-dummy-img"}.jpg`,alt:p.name||"Not assigned",sx:{borderRadius:"50%",width:23,height:23,display:"flex",mr:1}}),p.name]})},p.id))]})}]:[],{name:"Type",selector:l=>l.type,sortable:"true",center:"true",width:"140px"},{name:"Description",selector:l=>l.description,sortable:"true",left:"true",width:"260px",cell:l=>n(z,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:l.description})},{name:"Location",selector:l=>l.location,sortable:"true",center:"true",width:"200px",cell:l=>n(z,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:l.location})},{name:"Results",selector:l=>l.inspection_details,sortable:"true",width:"200px",center:"true",cell:l=>{const[p,x]=Se.useState(!1),[C,P]=Se.useState(l.inspection_details||"");return n(z,{sx:{whiteSpace:"normal",wordWrap:"break-word",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",cursor:"pointer"},onClick:p?void 0:()=>{x(!0)},children:p?n(K,{fullWidth:!0,value:C,onChange:N=>{P(N.target.value)},onBlur:()=>{x(!1),D(l.id,"inspection_details",C)},autoFocus:!0,variant:"standard",InputProps:{style:{marginBottom:0,border:"none",outline:"none",backgroundColor:"transparent",textAlign:"center"}}}):n(L,{children:l.inspection_details||"N/A"})})}},{name:"Road Type",selector:l=>l.side,sortable:"true",center:"true",width:"120px"},{name:"Quantity/Layer No.",selector:l=>l.qty_layer,sortable:"true",center:"true",width:"150px"},...k?[{name:"In charge",selector:l=>l.incharge,sortable:"true",center:"true",cell:l=>g(Z,{variant:"outlined",fullWidth:!0,size:"small",value:l.incharge||"na",onChange:p=>D(l.id,"incharge",p.target.value),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,borderRadius:2,boxShadow:f.glassCard.boxShadow}}},children:[n(F,{value:"na",disabled:!0,children:"Please select"}),r.map(p=>n(F,{value:p.id,children:g(z,{sx:{display:"flex"},children:[n(vr,{src:`/assets/images/users/${p.user_name||"user-dummy-img"}.jpg`,alt:p.name||"Not assigned",sx:{borderRadius:"50%",width:23,height:23,display:"flex",mr:1}}),p.name]})},p.id))]})}]:[],{name:"Planned Time",selector:l=>l.planned_time,sortable:"true",center:"true",width:"130px"},{name:"Completion Time",selector:l=>l.completion_time,sortable:"true",center:"true",width:"250px",cell:l=>n(K,{fullWidth:!0,size:"small",type:"datetime-local",value:l.completion_time?new Date(l.completion_time).toISOString().slice(0,16):"",onChange:p=>D(l.id,"completion_time",p.target.value),style:{border:"none",outline:"none",backgroundColor:"transparent"},inputProps:{placeholder:"YYYY-MM-DDTHH:MM"}})},{name:"Resubmission Count",selector:l=>l.resubmission_count,sortable:"true",center:"true",width:"160px",cell:l=>n(L,{children:l.resubmission_count?`${l.resubmission_count} ${l.resubmission_count>1?"times":"time"}`:""})},...k?[{name:"RFI Submission Date",selector:l=>l.rfi_submission_date,sortable:"true",center:"true",width:"180px",cell:l=>n(K,{fullWidth:!0,size:"small",type:"date",onChange:p=>D(l.id,"rfi_submission_date",p.target.value),value:l.rfi_submission_date?new Date(l.rfi_submission_date).toISOString().slice(0,10):"",style:{border:"none",outline:"none",backgroundColor:"transparent"},inputProps:{placeholder:"yyyy-MM-dd"}})}]:[],...k?[{name:"Actions",center:"true",width:"150px",cell:l=>g(z,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[n(U,{sx:{m:1},variant:"outlined",color:"success",size:"small",onClick:()=>{c(l),u("editDailyWork")},children:n(St,{})}),n(U,{sx:{m:1},variant:"outlined",color:"error",size:"small",onClick:()=>e(l.id,"deleteDailyWork"),children:n(Ft,{})})]})}]:[]],T=l=>{switch(l){case"new":return"blue";case"resubmission":return"orange";case"completed":return"green";case"emergency":return"red";default:return""}},D=async(l,p,x)=>{var C,P;try{const A=await axios.post(route("dailyWorks.update"),{id:l,[p]:x});console.log(A),A.status===200?(t(H=>H.map(j=>j.id===l?{...j,[p]:x}:j)),d(H=>H.map(j=>j.id===l?{...j,[p]:x}:j)),ee.success(...A.data.messages||"Task updated successfully",{icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,color:f.palette.text.primary}})):ee.error(A.data.error||`Failed to update task ${[p]}.`,{icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,color:f.palette.text.primary}})}catch(A){ee.error(((P=(C=A.response)==null?void 0:C.data)==null?void 0:P.message)||"An unexpected error occurred.",{icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:f.glassCard.backgroundColor,border:f.glassCard.border,color:f.palette.text.primary}})}};return g(L,{children:[n(at,{styles:{"& .cgTKyH":{backgroundColor:"transparent !important",color:f.palette.text.primary}}}),n(Vt,{columns:R,data:y,defaultSortField:"date",defaultSortFieldId:1,defaultSortAsc:!1,pagination:!0,highlightOnHover:!0,responsive:!0,dense:!0})]})},Ut=({open:e,closeModal:r,currentRow:t,setDailyWorks:i})=>{const a=ie(),[o,u]=m.useState({id:t.id||"",date:t.date||"",number:t.number||"",planned_time:t.planned_time||"",type:t.type||"Structure",location:t.location||"",description:t.description||"",side:t.side||"SR-R",qty_layer:t.qty_layer||""});console.log(o);const[c,y]=m.useState({}),[d,h]=m.useState(!1),[f,k]=m.useState(!1);m.useEffect(()=>{const T=Object.values(o).some(D=>D!=="");k(T)},[o]);const _=T=>{const{name:D,value:l}=T.target;u(p=>({...p,[D]:l}))};async function R(T){T.preventDefault(),h(!0);const D=new Promise(async(l,p)=>{try{const x=await fetch(route("dailyWorks.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({ruleSet:"details",...o})}),C=await x.json();x.ok?(i(P=>P.map(A=>A.id===o.id?{...A,...o}:A)),r(),l(C.message?[C.message]:C.messages),h(!1),r(),console.log(C.message?[C.message]:C.messages)):(h(!1),y(C.errors),p(C.errors),console.error(C.errors))}catch(x){h(!1),r(),console.log(x),p(["An unexpected error occurred."])}});ee.promise(D,{pending:{render(){return g("div",{style:{display:"flex",alignItems:"center"},children:[n(Re,{}),n("span",{style:{marginLeft:"8px"},children:"Updating daily work ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:l}){return n(L,{children:l.map((p,x)=>n("div",{children:p},x))})},icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:l}){return n(L,{children:l.map((p,x)=>n("div",{children:p},x))})},icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}return g(ze,{open:e,onClose:r,children:[g(Ie,{style:{cursor:"move"},id:"draggable-dialog-title",children:[n(pe,{children:"Add Task"}),n(U,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16},children:n(tr,{})})]}),g("form",{onSubmit:R,children:[n(Pe,{children:g(M,{container:!0,spacing:2,children:[n(M,{item:!0,xs:12,md:6,children:n(K,{label:"RFI Date",type:"date",name:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:o.date,onChange:_,error:!!c.date,helperText:c.date})}),n(M,{item:!0,xs:12,md:6,children:n(K,{label:"RFI Number",name:"number",fullWidth:!0,value:o.number,onChange:_,error:!!c.number,helperText:c.number})}),n(M,{item:!0,xs:12,md:6,children:n(K,{label:"Planned Time",name:"planned_time",fullWidth:!0,InputLabelProps:{shrink:!0},value:o.planned_time,onChange:_,error:!!c.planned_time,helperText:c.planned_time})}),n(M,{item:!0,xs:12,md:6,children:g(we,{fullWidth:!0,children:[n(_e,{id:"type-label",children:"Type"}),g(Z,{select:!0,label:"Type",name:"type",fullWidth:!0,value:o.type,onChange:_,error:!!c.type,helperText:c.type,labelId:"type-label",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[n(F,{value:"Structure",children:"Structure"}),n(F,{value:"Embankment",children:"Embankment"}),n(F,{value:"Pavement",children:"Pavement"})]}),n(ot,{children:c.type})]})}),n(M,{item:!0,xs:12,md:6,children:n(K,{label:"Location",name:"location",fullWidth:!0,value:o.location,onChange:_,error:!!c.location,helperText:c.location})}),n(M,{item:!0,xs:12,md:6,children:n(K,{label:"Description",name:"description",fullWidth:!0,value:o.description,onChange:_,error:!!c.description,helperText:c.description})}),n(M,{item:!0,xs:12,md:6,children:g(K,{select:!0,label:"Road Type",name:"side",fullWidth:!0,value:o.side,onChange:_,error:!!c.side,helperText:c.side,children:[n(F,{value:"SR-R",children:"SR-R"}),n(F,{value:"SR-L",children:"SR-L"}),n(F,{value:"TR-R",children:"TR-R"}),n(F,{value:"TR-L",children:"TR-L"})]})}),n(M,{item:!0,xs:12,md:6,children:n(K,{label:"Quantity/Layer No.",name:"qty_layer",fullWidth:!0,value:o.qty_layer,onChange:_,error:!!c.qty_layer,helperText:c.qty_layer})})]})}),n(je,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"16px"},children:n(nr,{disabled:!f,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",loading:d,children:"Submit"})})]})]})},Gt=({open:e,handleClose:r,taskIdToDelete:t,setDailyWorks:i,setFilteredData:a})=>{const o=ie();return g(ze,{open:e,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[n(Ie,{id:"alert-dialog-title",children:"Confirm Deletion"}),n(Pe,{children:n(it,{id:"alert-dialog-description",children:"Are you sure you want to delete this task? This action cannot be undone."})}),g(je,{children:[n(Fe,{onClick:r,color:"primary",children:"Cancel"}),n(Fe,{onClick:()=>{const c=new Promise(async(y,d)=>{try{const h=await fetch("/delete-daily-work",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:t})}),f=await h.json();h.ok?(i(k=>k.filter(_=>_.id!==t)),a(k=>k.filter(_=>_.id!==t)),y("Task deleted successfully")):d(f.error||"Failed to delete task")}catch(h){console.error("Error deleting task:",h),d("An error occurred while deleting the task")}finally{r()}});ee.promise(c,{pending:{render(){return g("div",{style:{display:"flex",alignItems:"center"},children:[n(Re,{}),n("span",{style:{marginLeft:"8px"},children:"Deleting task..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:o.glassCard.backgroundColor,border:o.glassCard.border,color:o.palette.text.primary}},success:{render({data:y}){return n(L,{children:y})},icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:o.glassCard.backgroundColor,border:o.glassCard.border,color:o.palette.text.primary}},error:{render({data:y}){return n(L,{children:y})},icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:o.glassCard.backgroundColor,border:o.glassCard.border,color:o.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})},Yt=({open:e,closeModal:r,filteredData:t,users:i})=>{console.log(i),m.useState(!1);const a=ie(),o=[{label:"Date",key:"date"},{label:"RFI No.",key:"number"},{label:"Status",key:"status"},{label:"Assigned",key:"assigned"},{label:"In charge",key:"incharge"},{label:"Type",key:"type"},{label:"Description",key:"description"},{label:"Location",key:"location"},{label:"Side",key:"side"},{label:"Quantity/Layer",key:"qty_layer"},{label:"Planned Time",key:"planned_time"},{label:"Completion Time",key:"completion_time"},{label:"Results",key:"inspection_details"},{label:"Resubmission Count",key:"resubmission_count"},{label:"RFI Submission Date",key:"rfi_submission_date"}],[u,c]=m.useState(o.map(h=>({...h,checked:!0}))),y=h=>{const f=[...u];f[h].checked=!f[h].checked,c(f)},d=async h=>{const f=new Promise((k,_)=>{try{const R=t.map(l=>{const p={};return h.forEach(x=>{if(x.checked)if(x.key==="incharge"||x.key==="assigned"){const C=i.find(P=>P.id===l[x.key]);p[x.label]=C?C.name:"N/A"}else if(x.key==="status"){const C=l[x.key];p[x.label]=C.charAt(0).toUpperCase()+C.slice(1)}else p[x.label]=l[x.key]}),p}),T=Ue.json_to_sheet(R),D=Ue.book_new();Ue.book_append_sheet(D,T,"Daily Works"),vt(D,"DailyWorks.xlsx"),k("Export successful!"),r()}catch(R){_("Failed to export data. Please try again."),console.error("Error exporting data to Excel:",R)}});ee.promise(f,{pending:{render(){return g("div",{style:{display:"flex",alignItems:"center"},children:[n(Re,{}),n("span",{style:{marginLeft:"8px"},children:"Exporting data to Excel ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:k}){return n(L,{children:k})},icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:k}){return n(L,{children:k})},icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})};return g(ze,{open:e,onClose:r,children:[g(Ie,{style:{cursor:"move"},id:"draggable-dialog-title",children:[n(pe,{children:"Export Daily Works"}),n(U,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16},children:n(tr,{})})]}),n(Pe,{children:g(lt,{size:"small",sx:{"& .MuiTableCell-root":{padding:"4px 8px"},"& .MuiCheckbox-root":{padding:"0px"}},children:[n(st,{children:g(xr,{children:[n(ke,{children:"Column Label"}),n(ke,{align:"center",children:"Include in Export"})]})}),n(ct,{children:u.map((h,f)=>g(xr,{children:[n(ke,{children:h.label}),n(ke,{align:"center",children:n(ut,{checked:h.checked,onChange:()=>y(f)})})]},h.key))})]})}),n(je,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:n(nr,{sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",onClick:()=>d(u),startIcon:n(Ye,{}),children:"Download"})})]})};function le(e,r,t,i){function a(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function c(h){try{d(i.next(h))}catch(f){u(f)}}function y(h){try{d(i.throw(h))}catch(f){u(f)}}function d(h){h.done?o(h.value):a(h.value).then(c,y)}d((i=i.apply(e,r||[])).next())})}function se(e,r){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,a,o,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(d){return function(h){return y([d,h])}}function y(d){if(i)throw new TypeError("Generator is already executing.");for(;u&&(u=0,d[0]&&(t=0)),t;)try{if(i=1,a&&(o=d[0]&2?a.return:d[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,d[1])).done)return o;switch(a=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,a=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){t.label=d[1];break}if(d[0]===6&&t.label<o[1]){t.label=o[1],o=d;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(d);break}o[2]&&t.ops.pop(),t.trys.pop();continue}d=r.call(e,t)}catch(h){d=[6,h],a=0}finally{i=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function kr(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var i=t.call(e),a,o=[],u;try{for(;(r===void 0||r-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(c){u={error:c}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(u)throw u.error}}return o}function Dr(e,r,t){if(t||arguments.length===2)for(var i=0,a=r.length,o;i<a;i++)(o||!(i in r))&&(o||(o=Array.prototype.slice.call(r,0,i)),o[i]=r[i]);return e.concat(o||Array.prototype.slice.call(r))}var Xt=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ge(e,r){var t=Qt(e);if(typeof t.path!="string"){var i=e.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof r=="string"?r:typeof i=="string"&&i.length>0?i:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function Qt(e){var r=e.name,t=r&&r.lastIndexOf(".")!==-1;if(t&&!e.type){var i=r.split(".").pop().toLowerCase(),a=Xt.get(i);a&&Object.defineProperty(e,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return e}var Jt=[".DS_Store","Thumbs.db"];function Zt(e){return le(this,void 0,void 0,function(){return se(this,function(r){return Ae(e)&&en(e.dataTransfer)?[2,an(e.dataTransfer,e.type)]:rn(e)?[2,tn(e)]:Array.isArray(e)&&e.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,nn(e)]:[2,[]]})})}function en(e){return Ae(e)}function rn(e){return Ae(e)&&Ae(e.target)}function Ae(e){return typeof e=="object"&&e!==null}function tn(e){return Qe(e.target.files).map(function(r){return ge(r)})}function nn(e){return le(this,void 0,void 0,function(){var r;return se(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(i){return i.getFile()}))];case 1:return r=t.sent(),[2,r.map(function(i){return ge(i)})]}})})}function an(e,r){return le(this,void 0,void 0,function(){var t,i;return se(this,function(a){switch(a.label){case 0:return e.items?(t=Qe(e.items).filter(function(o){return o.kind==="file"}),r!=="drop"?[2,t]:[4,Promise.all(t.map(on))]):[3,2];case 1:return i=a.sent(),[2,wr(Lr(i))];case 2:return[2,wr(Qe(e.files).map(function(o){return ge(o)}))]}})})}function wr(e){return e.filter(function(r){return Jt.indexOf(r.name)===-1})}function Qe(e){if(e===null)return[];for(var r=[],t=0;t<e.length;t++){var i=e[t];r.push(i)}return r}function on(e){if(typeof e.webkitGetAsEntry!="function")return _r(e);var r=e.webkitGetAsEntry();return r&&r.isDirectory?Hr(r):_r(e)}function Lr(e){return e.reduce(function(r,t){return Dr(Dr([],kr(r),!1),kr(Array.isArray(t)?Lr(t):[t]),!1)},[])}function _r(e){var r=e.getAsFile();if(!r)return Promise.reject("".concat(e," is not a File"));var t=ge(r);return Promise.resolve(t)}function ln(e){return le(this,void 0,void 0,function(){return se(this,function(r){return[2,e.isDirectory?Hr(e):sn(e)]})})}function Hr(e){var r=e.createReader();return new Promise(function(t,i){var a=[];function o(){var u=this;r.readEntries(function(c){return le(u,void 0,void 0,function(){var y,d,h;return se(this,function(f){switch(f.label){case 0:if(c.length)return[3,5];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Promise.all(a)];case 2:return y=f.sent(),t(y),[3,4];case 3:return d=f.sent(),i(d),[3,4];case 4:return[3,6];case 5:h=Promise.all(c.map(ln)),a.push(h),o(),f.label=6;case 6:return[2]}})})},function(c){i(c)})}o()})}function sn(e){return le(this,void 0,void 0,function(){return se(this,function(r){return[2,new Promise(function(t,i){e.file(function(a){var o=ge(a,e.fullPath);t(o)},function(a){i(a)})})]})})}var cn=function(e,r){if(e&&r){var t=Array.isArray(r)?r:r.split(","),i=e.name||"",a=(e.type||"").toLowerCase(),o=a.replace(/\/.*$/,"");return t.some(function(u){var c=u.trim().toLowerCase();return c.charAt(0)==="."?i.toLowerCase().endsWith(c):c.endsWith("/*")?o===c.replace(/\/.*$/,""):a===c})}return!0};function Sr(e){return pn(e)||dn(e)||Br(e)||un()}function un(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pn(e){if(Array.isArray(e))return Je(e)}function Fr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function Ar(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Fr(Object(t),!0).forEach(function(i){$r(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Fr(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function $r(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function fe(e,r){return gn(e)||mn(e,r)||Br(e,r)||fn()}function fn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Br(e,r){if(e){if(typeof e=="string")return Je(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Je(e,r)}}function Je(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function mn(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i=[],a=!0,o=!1,u,c;try{for(t=t.call(e);!(a=(u=t.next()).done)&&(i.push(u.value),!(r&&i.length===r));a=!0);}catch(y){o=!0,c=y}finally{try{!a&&t.return!=null&&t.return()}finally{if(o)throw c}}return i}}function gn(e){if(Array.isArray(e))return e}var hn="file-invalid-type",bn="file-too-large",yn="file-too-small",vn="too-many-files",xn=function(r){r=Array.isArray(r)&&r.length===1?r[0]:r;var t=Array.isArray(r)?"one of ".concat(r.join(", ")):r;return{code:hn,message:"File type must be ".concat(t)}},Er=function(r){return{code:bn,message:"File is larger than ".concat(r," ").concat(r===1?"byte":"bytes")}},Tr=function(r){return{code:yn,message:"File is smaller than ".concat(r," ").concat(r===1?"byte":"bytes")}},Cn={code:vn,message:"Too many files"};function Kr(e,r){var t=e.type==="application/x-moz-file"||cn(e,r);return[t,t?null:xn(r)]}function Nr(e,r,t){if(J(e.size))if(J(r)&&J(t)){if(e.size>t)return[!1,Er(t)];if(e.size<r)return[!1,Tr(r)]}else{if(J(r)&&e.size<r)return[!1,Tr(r)];if(J(t)&&e.size>t)return[!1,Er(t)]}return[!0,null]}function J(e){return e!=null}function kn(e){var r=e.files,t=e.accept,i=e.minSize,a=e.maxSize,o=e.multiple,u=e.maxFiles,c=e.validator;return!o&&r.length>1||o&&u>=1&&r.length>u?!1:r.every(function(y){var d=Kr(y,t),h=fe(d,1),f=h[0],k=Nr(y,i,a),_=fe(k,1),R=_[0],T=c?c(y):null;return f&&R&&!T})}function Ee(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function De(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(r){return r==="Files"||r==="application/x-moz-file"}):!!e.target&&!!e.target.files}function Or(e){e.preventDefault()}function Dn(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function wn(e){return e.indexOf("Edge/")!==-1}function _n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Dn(e)||wn(e)}function q(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(i){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r.some(function(c){return!Ee(i)&&c&&c.apply(void 0,[i].concat(o)),Ee(i)})}}function Sn(){return"showOpenFilePicker"in window}function Fn(e){if(J(e)){var r=Object.entries(e).filter(function(t){var i=fe(t,2),a=i[0],o=i[1],u=!0;return Vr(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),u=!1),(!Array.isArray(o)||!o.every(qr))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),u=!1),u}).reduce(function(t,i){var a=fe(i,2),o=a[0],u=a[1];return Ar(Ar({},t),{},$r({},o,u))},{});return[{description:"Files",accept:r}]}return e}function An(e){if(J(e))return Object.entries(e).reduce(function(r,t){var i=fe(t,2),a=i[0],o=i[1];return[].concat(Sr(r),[a],Sr(o))},[]).filter(function(r){return Vr(r)||qr(r)}).join(",")}function En(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function Tn(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Vr(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function qr(e){return/^.*\.[\w]+$/.test(e)}var On=["children"],In=["open"],Pn=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],jn=["refKey","onChange","onClick"];function Rn(e){return Mn(e)||zn(e)||Ur(e)||Wn()}function Wn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mn(e){if(Array.isArray(e))return Ze(e)}function Ge(e,r){return $n(e)||Hn(e,r)||Ur(e,r)||Ln()}function Ln(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ur(e,r){if(e){if(typeof e=="string")return Ze(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ze(e,r)}}function Ze(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function Hn(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i=[],a=!0,o=!1,u,c;try{for(t=t.call(e);!(a=(u=t.next()).done)&&(i.push(u.value),!(r&&i.length===r));a=!0);}catch(y){o=!0,c=y}finally{try{!a&&t.return!=null&&t.return()}finally{if(o)throw c}}return i}}function $n(e){if(Array.isArray(e))return e}function Ir(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function S(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ir(Object(t),!0).forEach(function(i){er(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ir(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function er(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Te(e,r){if(e==null)return{};var t=Bn(e,r),i,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)i=o[a],!(r.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}function Bn(e,r){if(e==null)return{};var t={},i=Object.keys(e),a,o;for(o=0;o<i.length;o++)a=i[o],!(r.indexOf(a)>=0)&&(t[a]=e[a]);return t}var sr=m.forwardRef(function(e,r){var t=e.children,i=Te(e,On),a=Yr(i),o=a.open,u=Te(a,In);return m.useImperativeHandle(r,function(){return{open:o}},[o]),Se.createElement(m.Fragment,null,t(S(S({},u),{},{open:o})))});sr.displayName="Dropzone";var Gr={disabled:!1,getFilesFromEvent:Zt,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};sr.defaultProps=Gr;sr.propTypes={children:w.func,accept:w.objectOf(w.arrayOf(w.string)),multiple:w.bool,preventDropOnDocument:w.bool,noClick:w.bool,noKeyboard:w.bool,noDrag:w.bool,noDragEventsBubbling:w.bool,minSize:w.number,maxSize:w.number,maxFiles:w.number,disabled:w.bool,getFilesFromEvent:w.func,onFileDialogCancel:w.func,onFileDialogOpen:w.func,useFsAccessApi:w.bool,autoFocus:w.bool,onDragEnter:w.func,onDragLeave:w.func,onDragOver:w.func,onDrop:w.func,onDropAccepted:w.func,onDropRejected:w.func,onError:w.func,validator:w.func};var rr={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Yr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=S(S({},Gr),e),t=r.accept,i=r.disabled,a=r.getFilesFromEvent,o=r.maxSize,u=r.minSize,c=r.multiple,y=r.maxFiles,d=r.onDragEnter,h=r.onDragLeave,f=r.onDragOver,k=r.onDrop,_=r.onDropAccepted,R=r.onDropRejected,T=r.onFileDialogCancel,D=r.onFileDialogOpen,l=r.useFsAccessApi,p=r.autoFocus,x=r.preventDropOnDocument,C=r.noClick,P=r.noKeyboard,A=r.noDrag,H=r.noDragEventsBubbling,j=r.onError,N=r.validator,E=m.useMemo(function(){return An(t)},[t]),ce=m.useMemo(function(){return Fn(t)},[t]),G=m.useMemo(function(){return typeof D=="function"?D:Pr},[D]),re=m.useMemo(function(){return typeof T=="function"?T:Pr},[T]),v=m.useRef(null),O=m.useRef(null),V=m.useReducer(Kn,rr),ue=Ge(V,2),Me=ue[0],$=ue[1],Xr=Me.isFocused,cr=Me.isFileDialogActive,he=m.useRef(typeof window<"u"&&window.isSecureContext&&l&&Sn()),ur=function(){!he.current&&cr&&setTimeout(function(){if(O.current){var b=O.current.files;b.length||($({type:"closeDialog"}),re())}},300)};m.useEffect(function(){return window.addEventListener("focus",ur,!1),function(){window.removeEventListener("focus",ur,!1)}},[O,cr,re,he]);var te=m.useRef([]),dr=function(b){v.current&&v.current.contains(b.target)||(b.preventDefault(),te.current=[])};m.useEffect(function(){return x&&(document.addEventListener("dragover",Or,!1),document.addEventListener("drop",dr,!1)),function(){x&&(document.removeEventListener("dragover",Or),document.removeEventListener("drop",dr))}},[v,x]),m.useEffect(function(){return!i&&p&&v.current&&v.current.focus(),function(){}},[v,p,i]);var X=m.useCallback(function(s){j?j(s):console.error(s)},[j]),pr=m.useCallback(function(s){s.preventDefault(),s.persist(),xe(s),te.current=[].concat(Rn(te.current),[s.target]),De(s)&&Promise.resolve(a(s)).then(function(b){if(!(Ee(s)&&!H)){var I=b.length,W=I>0&&kn({files:b,accept:E,minSize:u,maxSize:o,multiple:c,maxFiles:y,validator:N}),B=I>0&&!W;$({isDragAccept:W,isDragReject:B,isDragActive:!0,type:"setDraggedFiles"}),d&&d(s)}}).catch(function(b){return X(b)})},[a,d,X,H,E,u,o,c,y,N]),fr=m.useCallback(function(s){s.preventDefault(),s.persist(),xe(s);var b=De(s);if(b&&s.dataTransfer)try{s.dataTransfer.dropEffect="copy"}catch{}return b&&f&&f(s),!1},[f,H]),mr=m.useCallback(function(s){s.preventDefault(),s.persist(),xe(s);var b=te.current.filter(function(W){return v.current&&v.current.contains(W)}),I=b.indexOf(s.target);I!==-1&&b.splice(I,1),te.current=b,!(b.length>0)&&($({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),De(s)&&h&&h(s))},[v,h,H]),be=m.useCallback(function(s,b){var I=[],W=[];s.forEach(function(B){var de=Kr(B,E),oe=Ge(de,2),He=oe[0],$e=oe[1],Be=Nr(B,u,o),Ce=Ge(Be,2),Ke=Ce[0],Ne=Ce[1],Ve=N?N(B):null;if(He&&Ke&&!Ve)I.push(B);else{var qe=[$e,Ne];Ve&&(qe=qe.concat(Ve)),W.push({file:B,errors:qe.filter(function(et){return et})})}}),(!c&&I.length>1||c&&y>=1&&I.length>y)&&(I.forEach(function(B){W.push({file:B,errors:[Cn]})}),I.splice(0)),$({acceptedFiles:I,fileRejections:W,type:"setFiles"}),k&&k(I,W,b),W.length>0&&R&&R(W,b),I.length>0&&_&&_(I,b)},[$,c,E,u,o,y,k,_,R,N]),ye=m.useCallback(function(s){s.preventDefault(),s.persist(),xe(s),te.current=[],De(s)&&Promise.resolve(a(s)).then(function(b){Ee(s)&&!H||be(b,s)}).catch(function(b){return X(b)}),$({type:"reset"})},[a,be,X,H]),ne=m.useCallback(function(){if(he.current){$({type:"openDialog"}),G();var s={multiple:c,types:ce};window.showOpenFilePicker(s).then(function(b){return a(b)}).then(function(b){be(b,null),$({type:"closeDialog"})}).catch(function(b){En(b)?(re(b),$({type:"closeDialog"})):Tn(b)?(he.current=!1,O.current?(O.current.value=null,O.current.click()):X(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):X(b)});return}O.current&&($({type:"openDialog"}),G(),O.current.value=null,O.current.click())},[$,G,re,l,be,X,ce,c]),gr=m.useCallback(function(s){!v.current||!v.current.isEqualNode(s.target)||(s.key===" "||s.key==="Enter"||s.keyCode===32||s.keyCode===13)&&(s.preventDefault(),ne())},[v,ne]),hr=m.useCallback(function(){$({type:"focus"})},[]),br=m.useCallback(function(){$({type:"blur"})},[]),yr=m.useCallback(function(){C||(_n()?setTimeout(ne,0):ne())},[C,ne]),ae=function(b){return i?null:b},Le=function(b){return P?null:ae(b)},ve=function(b){return A?null:ae(b)},xe=function(b){H&&b.stopPropagation()},Qr=m.useMemo(function(){return function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=s.refKey,I=b===void 0?"ref":b,W=s.role,B=s.onKeyDown,de=s.onFocus,oe=s.onBlur,He=s.onClick,$e=s.onDragEnter,Be=s.onDragOver,Ce=s.onDragLeave,Ke=s.onDrop,Ne=Te(s,Pn);return S(S(er({onKeyDown:Le(q(B,gr)),onFocus:Le(q(de,hr)),onBlur:Le(q(oe,br)),onClick:ae(q(He,yr)),onDragEnter:ve(q($e,pr)),onDragOver:ve(q(Be,fr)),onDragLeave:ve(q(Ce,mr)),onDrop:ve(q(Ke,ye)),role:typeof W=="string"&&W!==""?W:"presentation"},I,v),!i&&!P?{tabIndex:0}:{}),Ne)}},[v,gr,hr,br,yr,pr,fr,mr,ye,P,A,i]),Jr=m.useCallback(function(s){s.stopPropagation()},[]),Zr=m.useMemo(function(){return function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=s.refKey,I=b===void 0?"ref":b,W=s.onChange,B=s.onClick,de=Te(s,jn),oe=er({accept:E,multiple:c,type:"file",style:{display:"none"},onChange:ae(q(W,ye)),onClick:ae(q(B,Jr)),tabIndex:-1},I,O);return S(S({},oe),de)}},[O,t,c,ye,i]);return S(S({},Me),{},{isFocused:Xr&&!i,getRootProps:Qr,getInputProps:Zr,rootRef:v,inputRef:O,open:ae(ne)})}function Kn(e,r){switch(r.type){case"focus":return S(S({},e),{},{isFocused:!0});case"blur":return S(S({},e),{},{isFocused:!1});case"openDialog":return S(S({},rr),{},{isFileDialogActive:!0});case"closeDialog":return S(S({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return S(S({},e),{},{isDragActive:r.isDragActive,isDragAccept:r.isDragAccept,isDragReject:r.isDragReject});case"setFiles":return S(S({},e),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections});case"reset":return S({},rr);default:return e}}function Pr(){}const Nn=({open:e,closeModal:r,setFilteredData:t,setDailyWorks:i})=>{const[a,o]=m.useState(null),[u,c]=m.useState(!1),y=ie(),d=D=>{o(D[0])},h=()=>{o(null)},{getRootProps:f,getInputProps:k,isDragActive:_}=Yr({onDrop:d,noClick:!!a,noKeyboard:!!a}),R=D=>{if(!D)return n(Et,{fontSize:"large"});const l=D.type;return l.startsWith("image/")?n(Image,{fontSize:"large"}):l==="application/pdf"?n(It,{fontSize:"large"}):l==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?n(Tt,{fontSize:"large"}):n(Ot,{fontSize:"large"})};return g(ze,{open:e,onClose:r,children:[g(Ie,{style:{cursor:"move"},id:"draggable-dialog-title",children:[n(pe,{children:"Import Daily Works"}),n(U,{variant:"outlined",color:"primary",onClick:r,sx:{position:"absolute",top:8,right:16,zIndex:0},children:n(tr,{})})]}),g("form",{onSubmit:async D=>{console.log(a),D.preventDefault(),c(!0);const l=new FormData;l.append("file",a);for(let[x,C]of l.entries())console.log(`${x}: ${C.name}`);const p=new Promise(async(x,C)=>{try{const P=await fetch(route("dailyWorks.import"),{method:"POST",body:l,headers:{"X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content}}),A=await P.json();P.ok?(t(A.updatedDailyWorks.dailyWorks),i(A.updatedDailyWorks.dailyWorks),x(A.message),r()):(console.error(A.errors||A.error),C("Failed to import data."))}catch(P){C(`Error: ${P.message||"An unexpected error occurred."}`)}finally{c(!1)}});ee.promise(p,{pending:{render(){return g("div",{style:{display:"flex",alignItems:"center"},children:[n(Re,{}),n("span",{style:{marginLeft:"8px"},children:"Uploading file ..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}},success:{render({data:x}){return n(L,{children:x})},icon:"ğŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}},error:{render({data:x}){return n(L,{children:x})},icon:"ğŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:y.glassCard.backgroundColor,border:y.glassCard.border,color:y.palette.text.primary}}})},children:[n(Pe,{children:n(M,{container:!0,spacing:2,children:n(M,{item:!0,xs:12,children:g(z,{...f(),sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"2px dashed #ccc",borderRadius:"8px",padding:"20px",cursor:a?"not-allowed":"pointer","&:hover":{borderColor:a?"#ccc":"#aaa"}},children:[n("input",{...k()}),n(U,{sx:{borderRadius:"50%",backgroundColor:"#f0f0f0","&:hover":{backgroundColor:a?"#f0f0f0":"#e0e0e0",cursor:a?"not-allowed":"pointer"}},disabled:!!a,children:R(a)}),a?g(L,{children:[g(pe,{variant:"body1",sx:{marginTop:"10px"},children:[a.name," (",(a.size/1024).toFixed(2)," KB)"]}),n(U,{onClick:h,sx:{marginTop:"10px",backgroundColor:"#f0f0f0","&:hover":{backgroundColor:"#e0e0e0"}},children:n(At,{})})]}):n(pe,{variant:"body1",sx:{marginTop:"10px"},children:"Drag & drop files here, or click to select files"})]})})})}),n(je,{sx:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:n(nr,{disabled:!a,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",loading:u,startIcon:n(Xe,{}),children:"Upload"})})]})]})};Q.extend(xt);const jr=dt(Ct)(({theme:e})=>({"& .MuiPaper-root":{backgroundColor:e.glassCard.backgroundColor},"& .MuiInputBase-root":{color:e.palette.text.primary,borderColor:e.palette.divider},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:e.palette.divider},"&:hover fieldset":{borderColor:e.palette.primary.main},"&.Mui-focused fieldset":{borderColor:e.palette.primary.main}},"& .MuiSvgIcon-root":{color:e.palette.text.secondary},"& .MuiPickersDay-root":{color:e.palette.text.primary,"&.Mui-selected":{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},"&.MuiPickersDay-today":{borderColor:e.palette.primary.main}}})),ra=Se.memo(({auth:e,title:r,allData:t,jurisdictions:i,users:a,reports:o,reports_with_daily_works:u})=>{const c=ie(),[y,d]=m.useState(t.dailyWorks),[h,f]=m.useState(t.dailyWorks),k=m.useMemo(()=>y.map(v=>Q(v.date)),[y]),[_,R]=m.useState(),[T,D]=m.useState(null),[l,p]=m.useState(null),[x,C]=m.useState(""),P=pt(c.breakpoints.down("md")),A=m.useCallback((v,O)=>{D(v),p(O)},[]),H=m.useCallback(()=>{p(null),D(null)},[]),j=m.useCallback(v=>{p(v)},[]),N=m.useCallback(()=>{p(null)},[]),[E,ce]=m.useState({startDate:Q.min(...k),endDate:Q.max(...k),status:"all",incharge:"all",report:""}),G=m.useCallback((v,O)=>{ce(V=>({...V,[v]:O}))},[]),re=v=>{const O=v.target.value.toLowerCase();C(O)};return m.useEffect(()=>{ce(v=>({...v,startDate:Q.min(...k),endDate:Q.max(...k)}))},[k]),m.useEffect(()=>{const O=y.filter(V=>Object.values(V).some(ue=>String(ue).toLowerCase().includes(x))).filter(V=>Q(V.date).isBetween(E.startDate,E.endDate,null,"[]")&&(E.status==="all"||!E.status||V.status===E.status)&&(E.incharge==="all"||!E.incharge||V.incharge===E.incharge)&&(E.report?V.report===E.report:!0));f(O)},[E,x,y]),g(bt,{children:[n(tt,{title:r}),l==="editDailyWork"&&n(Ut,{open:l==="editDailyWork",currentRow:_,setDailyWorks:d,closeModal:N}),l==="deleteDailyWork"&&n(Gt,{open:l==="deleteDailyWork",handleClose:H,taskIdToDelete:T,setDailyWorks:d,setFilteredData:f}),l==="importDailyWorks"&&n(Nn,{open:l==="importDailyWorks",closeModal:N,setDailyWorks:d,setFilteredData:f}),l==="exportDailyWorks"&&n(Yt,{open:l==="exportDailyWorks",closeModal:N,filteredData:h,users:a}),n(z,{sx:{display:"flex",justifyContent:"center",p:2},children:n(ft,{in:!0,children:g(ht,{children:[n(mt,{title:r,sx:{padding:"24px"},action:g(z,{display:"flex",gap:2,children:[e.permissions.includes("addTask")&&n(U,{title:"Add Task",color:"primary",id:"showAddModalBtn",children:n(kt,{})}),e.roles.includes("admin")&&n(L,{children:P?g(L,{children:[n(U,{title:"Import Daily Works",color:"warning",onClick:()=>j("importDailyWorks"),children:n(Xe,{})}),n(U,{title:"Export Daily Works",color:"success",onClick:()=>j("exportDailyWorks"),children:n(Ye,{})})]}):g(L,{children:[n(Fe,{title:"Import Daily Works",variant:"outlined",color:"warning",startIcon:n(Xe,{}),onClick:()=>j("importDailyWorks"),children:"Import"}),n(Fe,{title:"Export Daily Works",variant:"outlined",color:"success",startIcon:n(Ye,{}),onClick:()=>j("exportDailyWorks"),children:"Export"})]})})]})}),n(Cr,{children:n(z,{children:g(M,{container:!0,spacing:3,children:[n(M,{item:!0,xs:12,sm:6,md:3,sx:{paddingTop:"8px !important"},children:n(Dt,{dateAdapter:wt,children:g(z,{display:"flex",alignItems:"center",children:[n(jr,{label:"Start date",value:E.startDate,onChange:v=>G("startDate",v),textField:v=>n(K,{...v,fullWidth:!0,size:"small"})}),n(z,{sx:{mx:1},children:" to "}),n(jr,{label:"End date",value:E.endDate,onChange:v=>G("endDate",v),textField:v=>n(K,{...v,fullWidth:!0,size:"small"})})]})})}),n(M,{item:!0,xs:6,sm:4,md:3,sx:{paddingTop:"8px !important"},children:g(we,{fullWidth:!0,children:[n(_e,{id:"status-label",children:"Status"}),g(Z,{variant:"outlined",labelId:"status-label",label:"Status",name:"status",value:E.status,onChange:v=>G("status",v.target.value),children:[n(F,{value:"all",children:"All"}),n(F,{value:"completed",children:"Completed"}),n(F,{value:"new",children:"New"}),n(F,{value:"resubmission",children:"Resubmission"}),n(F,{value:"emergency",children:"Emergency"})]})]})}),e.roles.includes("admin")&&n(M,{item:!0,xs:6,sm:4,md:3,sx:{paddingTop:"8px !important"},children:g(we,{fullWidth:!0,children:[n(_e,{id:"incharge-label",children:"Incharge"}),g(Z,{variant:"outlined",labelId:"incharge-label",label:"Incharge",name:"incharge",value:E.incharge,onChange:v=>G("incharge",v.target.value),children:[n(F,{value:"all",children:"All"}),t.allInCharges.map(v=>n(F,{value:v.id,children:v.name},v.id))]})]})}),n(M,{item:!0,xs:6,sm:4,md:3,sx:{paddingTop:"8px !important"},children:g(we,{fullWidth:!0,children:[n(_e,{children:"Select Report"}),n(Z,{variant:"outlined",name:"qc_report",value:E.report,onChange:v=>G("report",v.target.value),children:n(F,{value:"",disabled:!0,children:"Select Report"})})]})})]})})}),g(Cr,{children:[n(K,{label:"Search",fullWidth:!0,variant:"outlined",placeholder:"Search...",value:x,onChange:re,InputProps:{startAdornment:n(gt,{position:"start",children:n(Mr,{})})}}),n(qt,{setDailyWorks:d,filteredData:h,setFilteredData:f,reports:o,setCurrentRow:R,handleClickOpen:A,openModal:j,juniors:t.juniors,allInCharges:t.allInCharges,jurisdictions:i,users:a,reports_with_daily_works:u})]})]})})})]})});export{ra as default};
