import{j as e,r as k,a as g,Y as L}from"./app-DTrPBSoR.js";import{j as N,y as R,z as _,T as B,M as b,I as y,D as H,E,A as O,B as v,c as J,H as U,J as V,d as W,b as $}from"./App-Dutmtrz7.js";import{T as q}from"./TableContainer-BMztS1zw.js";import{T as G,a as K,b as A,c as t,d as X}from"./TableRow-Bbuakf62.js";import{F as T,I as D,S as F}from"./Select-Yuz76bzx.js";import{C as I}from"./CircularProgress-6_dTmZQ_.js";import{A as Y}from"./Add-Ch2tNbFC.js";const Q=N(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),Z=N(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),ee=({allUsers:u,departments:j,designations:c})=>{const[p,f]=k.useState(u);console.log(p);const a=R();console.log(a);const[re,P]=k.useState({});async function w(r,l,s){const d=new Promise(async(o,i)=>{try{const n=s.target.value,x=await fetch(route("profile.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:l,[r]:n})}),h=await x.json();x.ok?(f(z=>z.map(m=>{if(m.id===l){const C={...m};return r==="department"&&m.department!==n&&(C.designation=null),C[r]=n,C}return m})),o([...h.messages]),console.log(h.messages)):(i(h.messages),console.error(h.messages))}catch(n){console.log(n),i(["An unexpected error occurred."])}});E.promise(d,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(I,{}),e.jsxs("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:o}){return e.jsx(e.Fragment,{children:o.map((i,n)=>e.jsx("div",{children:i},n))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:o}){return e.jsx(e.Fragment,{children:o.map((i,n)=>e.jsx("div",{children:i},n))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}const M=async r=>{const l=new Promise(async(s,d)=>{try{const o=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),i=await o.json();o.ok?(f(n=>n.filter(x=>x.id!==r)),s([i.message])):d([i.message])}catch(o){console.error("Error deleting user:",o),d(["An error occurred while deleting user. Please try again."])}});E.promise(l,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(I,{}),e.jsx("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:s}){return e.jsx(e.Fragment,{children:s.map((d,o)=>e.jsx("div",{children:d},o))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:s}){return e.jsx(e.Fragment,{children:s.map((d,o)=>e.jsx("div",{children:d},o))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},S=r=>{P(l=>({...l,[r]:null}))};return e.jsx(q,{style:{maxHeight:"70vh",overflowY:"auto"},children:e.jsxs(G,{"aria-label":"employee table",children:[e.jsx(K,{children:e.jsxs(A,{children:[e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Employee ID"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Name"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Email"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Mobile"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Join Date"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Department"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:"Role"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},align:"right",children:"Action"})]})}),e.jsx(X,{children:p.map(r=>{var l;return e.jsxs(A,{children:[e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.employee_id||"N/A"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e.jsx(_,{src:`assets/images/users/${r.user_name}.jpg`,alt:r.first_name}),e.jsxs(B,{sx:{marginLeft:"10px"},children:[e.jsx(g,{style:{textDecoration:"none",color:a.palette.text.primary,fontWeight:"bold"},href:route("profile",{user:r.id}),children:r.name||"N/A"}),e.jsx("br",{}),((l=c.find(s=>s.id===r.designation))==null?void 0:l.title)||"N/A"]})]}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.phone||"N/A"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.email||"N/A"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:r.date_of_joining||"N/A"}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:e.jsxs(T,{size:"small",fullWidth:!0,children:[e.jsx(D,{id:"department",children:"Department"}),e.jsxs(F,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:s=>w("department",r.id,s),label:"Department",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e.jsx(b,{value:"na",disabled:!0,children:"Select Department"}),j.map(s=>e.jsx(b,{value:s.id,children:s.name},s.id))]})]})}),e.jsx(t,{sx:{whiteSpace:"nowrap"},children:e.jsxs(T,{size:"small",fullWidth:!0,children:[e.jsx(D,{id:"designation",children:"Designation"}),e.jsxs(F,{labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:s=>w("designation",r.id,s),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e.jsx(b,{value:"na",disabled:!0,children:"Select Designation"}),c.filter(s=>s.department_id===r.department).map(s=>e.jsx(b,{value:s.id,children:s.title},s.id))]})]})}),e.jsxs(t,{sx:{whiteSpace:"nowrap"},align:"right",children:[e.jsx(y,{component:g,href:route("profile",{user:r.id}),onClick:()=>{S(r.id)},children:e.jsx(H,{})}),e.jsx(y,{component:g,href:route("profile",{user:r.id}),onClick:()=>{S(r.id)},children:e.jsx(Z,{})}),e.jsxs(y,{component:g,href:route("profile",{user:r.id}),onClick:()=>{M(r.id)},children:[e.jsx(Q,{})," "]})]})]},r.id)})})]})})},de=({title:u,allUsers:j,departments:c,designations:p})=>e.jsxs(O,{children:[e.jsx(L,{title:u}),e.jsx(v,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(J,{in:!0,children:e.jsxs(U,{children:[e.jsx(V,{title:"Employees",sx:{padding:"24px"},action:e.jsx(v,{display:"flex",gap:2,children:e.jsx(W,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e.jsx(Y,{}),children:"Add Employee"})})}),e.jsx($,{children:e.jsx(ee,{allUsers:j,departments:c,designations:p})})]})})})]});export{de as default};
