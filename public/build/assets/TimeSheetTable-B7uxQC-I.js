import{V as q,a as e,j as s,F as J}from"./app-BVVWMDiD.js";import{r,s as X,t as Z,G as i,e as ee,g as te,T as x,a as V,B as b,a0 as re,a1 as ve,f as ye}from"./vendor-aMbn8-Jn.js";import{t as Se,u as _e,m as Ce,o as we,c as G,e as Me,f as Ae,G as ae}from"./App-C0Pi6_rf.js";import{d as O}from"./dayjs.min-BZ3s2SPr.js";import{d as ke}from"./Search-BJKE4Yh2.js";import{s as Pe}from"./chunk-4EXC76WE-BZh5Gwh2.js";import{a as Le,u as Ne}from"./chunk-R6AK6OQ4-CwZ7Jr5Y.js";import{i as Y}from"./chunk-HJTJQZF3-BWM8bIpo.js";import{t as Te,a as ze,b as Ue,c as Ee,d as je,e as v}from"./chunk-F3UDT23P-CwVqHeRK.js";import{p as De}from"./chunk-YHY32LNM-CBhfKAcA.js";var ne=Se({slots:{base:["group","relative","overflow-hidden","bg-content3 dark:bg-content2","pointer-events-none","before:opacity-100","before:absolute","before:inset-0","before:-translate-x-full","before:animate-[shimmer_2s_infinite]","before:border-t","before:border-content4/30","before:bg-gradient-to-r","before:from-transparent","before:via-content4","dark:before:via-default-700/10","before:to-transparent","after:opacity-100","after:absolute","after:inset-0","after:-z-10","after:bg-content3","dark:after:bg-content2","data-[loaded=true]:pointer-events-auto","data-[loaded=true]:overflow-visible","data-[loaded=true]:!bg-transparent","data-[loaded=true]:before:opacity-0 data-[loaded=true]:before:-z-10 data-[loaded=true]:before:animate-none","data-[loaded=true]:after:opacity-0"],content:["opacity-0","group-data-[loaded=true]:opacity-100"]},variants:{disableAnimation:{true:{base:"before:animate-none before:transition-none after:transition-none",content:"transition-none"},false:{base:"transition-background !duration-300",content:"transition-opacity motion-reduce:transition-none !duration-300"}}},defaultVariants:{}});function He(y){var c,u;const d=_e(),[l,S]=Ce(y,ne.variantKeys),{as:T,children:M,isLoaded:z=!1,className:U,classNames:h,...p}=l,A=T||"div",C=(u=(c=y.disableAnimation)!=null?c:d==null?void 0:d.disableAnimation)!=null?u:!1,_=r.useMemo(()=>ne({...S,disableAnimation:C}),[we(S),C,M]),E=G(h==null?void 0:h.base,U);return{Component:A,children:M,slots:_,classNames:h,getSkeletonProps:(f={})=>({"data-loaded":Me(z),className:_.base({class:G(E,f==null?void 0:f.className)}),...p}),getContentProps:(f={})=>({className:_.content({class:G(h==null?void 0:h.content,f==null?void 0:f.className)})})}}var se=Ae((y,c)=>{const{Component:u,children:d,getSkeletonProps:l,getContentProps:S}=He({...y});return X.jsx(u,{ref:c,...l(),children:X.jsx("div",{...S(),children:d})})});se.displayName="HeroUI.Skeleton";var Re=se;const qe=({handleDateChange:y,selectedDate:c,updateTimeSheet:u})=>{const{auth:d}=q().props,{url:l}=q(),S=Z("(min-width: 1025px)"),T=Z("(min-width: 641px) and (max-width: 1024px)"),[M,z]=r.useState([]),[U,h]=r.useState([]),[p,A]=r.useState([]),[C,_]=r.useState(""),[E,B]=r.useState(0),[W,f]=r.useState(0),[K,Ie]=r.useState(10),[j,oe]=r.useState(1),[D,ie]=r.useState(""),[le,ce]=r.useState(!1),[k,de]=r.useState({currentMonth:O().format("YYYY-MM")}),[H,R]=r.useState(2),I=r.useRef(null),$=r.useRef(null),me=async(t,n,a,m,g)=>{var L,F,w,N;const Q=l!=="/attendance-employee"?route("getAllUsersAttendanceForDate"):route("getCurrentUserAttendanceForDate");try{const o=await axios.get(Q,{params:{page:n,perPage:a,employee:m,date:t,currentYear:g.currentMonth?O(g.currentMonth).year():"",currentMonth:g.currentMonth?O(g.currentMonth).format("MM"):""}});o.status===200&&(console.log(o.data),z(o.data.attendances),h(o.data.leaves),A(o.data.absent_users),B(o.data.total),f(o.data.last_page),_(""),ce(!0))}catch(o){_(((F=(L=o.response)==null?void 0:L.data)==null?void 0:F.message)||"An error occurred while retrieving attendance data."),A(((N=(w=o.response)==null?void 0:w.data)==null?void 0:N.absent_users)||[])}},P=r.useCallback(()=>{if(I.current&&$.current){const t=I.current.clientHeight,n=$.current.clientHeight,a=t-150,m=Math.max(1,Math.floor(a/n));R(m)}},[]);r.useEffect(()=>{R(2);const t=setTimeout(()=>{P()},100);return window.addEventListener("resize",P),()=>{clearTimeout(t),window.removeEventListener("resize",P)}},[p,u,P]),r.useEffect(()=>{me(c,j,K,D,k)},[c,j,K,D,k,u]);const ue=t=>{ie(t.target.value.toLowerCase())},he=t=>{oe(t)},pe=r.useCallback((t,n)=>{de(a=>({...a,[t]:n}))},[]),fe=()=>{R(t=>t+2)},ge=t=>U.find(n=>String(n.user_id)===String(t)),xe=[{name:"Date",uid:"date"},...d.roles.includes("Administrator")&&l!=="/attendance-employee"?[{name:"Employee",uid:"employee"}]:[],{name:"Clockin Time",uid:"clockin_time"},{name:"Clockout Time",uid:"clockout_time"},{name:"Production Time",uid:"production_time"}],be=(t,n)=>{var a,m,g;switch(n){case"date":return e(v,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:new Date(t.date).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})});case"employee":return e(v,{className:"whitespace-nowrap text-xs sm:text-sm md:text-base lg:text-lg",children:e(Ne,{avatarProps:{radius:"lg",size:S||T?"md":"sm",src:(a=t.user)==null?void 0:a.profile_image},description:(m=t.user)==null?void 0:m.phone,name:(g=t.user)==null?void 0:g.name})});case"clockin_time":return e(v,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:t.punchin_time?new Date(`2024-06-04T${t.punchin_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"N/A"});case"clockout_time":return e(v,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:t.punchout_time?new Date(`2024-06-04T${t.punchout_time}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"N/A"});case"production_time":if(t.punchin_time&&t.punchout_time){const L=new Date(`2024-06-04T${t.punchin_time}`),w=new Date(`2024-06-04T${t.punchout_time}`)-L,N=Math.floor(w/(1e3*60*60)),o=Math.floor(w%(1e3*60*60)/(1e3*60));return e(v,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:`${N}h ${o}m`})}return e(v,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:"N/A"});default:return e(v,{className:"text-xs sm:text-sm md:text-base lg:text-lg",children:"N/A"})}};return e(b,{sx:{display:"flex",justifyContent:"center",p:2},children:s(i,{container:!0,spacing:2,children:[e(i,{item:!0,xs:12,md:l!=="/attendance-employee"?9:12,children:e(ee,{in:!0,children:s(ae,{children:[e(te,{title:e(x,{sx:{fontSize:{xs:"1.0rem",sm:"1.4rem",md:"1.8rem"}},children:l==="/attendance-employee"?"Timesheet for the month of "+new Date(k.currentMonth).toLocaleString("en-US",{month:"long",year:"numeric"}):"Timesheet of "+new Date(c).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}),sx:{padding:"24px"}}),e(V,{children:e(b,{children:s(i,{container:!0,spacing:2,children:[d.roles.includes("Administrator")&&l!=="/attendance-employee"&&s(J,{children:[e(i,{item:!0,xs:12,sm:6,md:4,children:e(Y,{label:"Search",type:"text",fullWidth:!0,variant:"bordered",placeholder:"Employee...",value:D,onChange:ue,endContent:e(ke,{})})}),e(i,{item:!0,xs:12,sm:6,md:4,children:e(Y,{label:"Select Date",type:"date",variant:"bordered",onChange:y,value:new Date(c).toISOString().slice(0,10)||""})})]}),d.roles.includes("Employee")&&l==="/attendance-employee"&&e(i,{item:!0,xs:12,sm:6,md:4,children:e(Y,{label:"Current Month",type:"month",fullWidth:!0,variant:"bordered",placeholder:"Month...",value:k.currentMonth,onChange:t=>pe("currentMonth",t.target.value)})})]})})}),e(V,{children:C?e(x,{color:"error",children:C}):s("div",{style:{maxHeight:"84vh"},children:[e(Pe,{orientation:"horizontal",className:"overflow-y-hidden",children:e(Re,{className:"rounded-lg",isLoaded:le,children:s(Te,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isCompact:!0,removeWrapper:!0,"aria-label":"Attendance Table",isHeaderSticky:!0,children:[e(ze,{columns:xe,children:t=>e(Ue,{align:"start",children:t.name},t.uid)}),e(Ee,{items:M,children:t=>e(je,{children:n=>be(t,n)},t.id)})]})})}),E>10&&e("div",{className:"py-2 px-2 flex justify-center items-end",style:{height:"100%"},children:e(De,{initialPage:1,isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",page:j,total:W,onChange:he})})]})})]})})}),d.roles.includes("Administrator")&&l!=="/attendance-employee"&&p.length>0&&e(i,{item:!0,xs:12,md:3,children:e(ee,{in:!0,children:s(ae,{ref:I,children:[e(te,{title:s(b,{sx:{display:"flex",alignItems:"center"},children:[e(x,{sx:{fontSize:{xs:"1.0rem",sm:"1.4rem",md:"1.8rem"}},children:"Absent on "+new Date(c).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}),e(re,{sx:{ml:1,fontSize:{xs:"0.8rem",sm:"1.1rem",md:"1.4rem"}},label:p.length,variant:"outlined",color:"error",size:"small"})]})}),e(V,{children:s(b,{children:[p.slice(0,H).map((t,n)=>{const a=ge(t.id),m=n===0?$:null;return e(ve,{in:n<H,timeout:"auto",unmountOnExit:!0,children:e(b,{ref:m,sx:{mb:2,p:2,border:"1px solid #e0e0e0",borderRadius:2},children:s(i,{container:!0,alignItems:"center",children:[e(i,{item:!0,xs:12,children:s(b,{sx:{display:"flex",alignItems:"center"},children:[e(Le,{src:t.profile_image,alt:t.name}),e(x,{sx:{m:2,fontSize:{xs:"1.0rem",sm:"1.2rem",md:"1.4rem"}},children:t.name})]})}),a?s(J,{children:[s(i,{item:!0,xs:6,children:[e(x,{sx:{fontSize:{xs:"1.0rem",sm:"1.2rem",md:"1.4rem"}},children:a.from_date===a.to_date?a.from_date:`${a.from_date} to ${a.to_date}`}),e(x,{sx:{fontSize:{xs:"0.8rem",sm:"1.0rem",md:"1.2rem"}},color:"textSecondary",children:"On "+a.leave_type+" Leave"})]}),e(i,{item:!0,xs:6,sx:{textAlign:"right"},children:e(re,{label:a.status,variant:"outlined",color:a.status==="Pending"?"error":"success",size:"small"})})]}):e(i,{item:!0,xs:12,children:e(x,{color:"error",sx:{fontSize:{xs:"1.0rem",sm:"1.2rem",md:"1.4rem"}},children:"Absent without Leave"})})]})},t.id)},t.id)}),H<p.length&&e(b,{textAlign:"center",children:e(ye,{variant:"outlined",onClick:fe,children:"Load More"})})]})})]})})})]})})};export{qe as T,Re as s};
