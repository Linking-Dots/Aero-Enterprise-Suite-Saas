import{a as e,j as l,U as S,F as p,M as O}from"./app-D0Y9sbTW.js";import{r as D,u as U,c as y,k as w,S as F,M as g,F as P,t as A,e as R,h as W,B as N,f as z,a as G}from"./vendor-B2Sl_-DV.js";import{a as H,B as I,A as J,G as V}from"./App-Iuu9R2fg.js";import{t as v}from"./chunk-KQ7OR4H5-CKLs8cQQ.js";import{E as q,D as X}from"./Edit-ChakzkM4.js";import{a as $,b as K,c as Y,d as Q,e as Z,t as ee}from"./chunk-YRZGWF2W-4Asf0_q8.js";import{u as re}from"./chunk-TLBGAR4N-CUidbdGR.js";import{A as ae}from"./Add-Y_71Dp7Z.js";import"./chunk-KBN3H6OQ-CYLW9cfV.js";import"./useFormValidationState-CB0_Dbas.js";import"./DOMLayoutDelegate-DUAkROy_.js";const te=({allUsers:c,departments:b,designations:h})=>{const[m,k]=D.useState(c),a=U(),[oe,T]=D.useState({});async function _(r,i,o){const t=new Promise(async(n,s)=>{try{const d=o,x=r==="department"?"user.updateDepartment":"user.updateDesignation",E=await fetch(route(x,{id:i}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({[r]:d})}),f=await E.json();E.ok?(k(B=>B.map(u=>{if(String(u.id)===String(i)){const C={...u};return r==="department"&&u.department!==d&&(C.designation=null),C[r]=d,C}return u})),n(f.messages)):(s([f.messages||"Failed to update profile information."]),console.error(f.errors))}catch(d){console.log(d),s(["An unexpected error occurred."])}});I.promise(t,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(A,{}),l("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:n}){return e(p,{children:n.map((s,d)=>e("div",{children:s},d))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:n}){return e(p,{children:n.map((s,d)=>e("div",{children:s},d))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}const j=async r=>{const i=new Promise(async(o,t)=>{try{const n=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),s=await n.json();n.ok?(k(d=>d.filter(x=>x.id!==r)),o([s.message])):t([s.message])}catch(n){console.error("Error deleting user:",n),t(["An error occurred while deleting user. Please try again."])}});I.promise(i,{pending:{render(){return l("div",{style:{display:"flex",alignItems:"center"},children:[e(A,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:o}){return e(p,{children:o.map((t,n)=>e("div",{children:t},n))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:o}){return e(p,{children:o.map((t,n)=>e("div",{children:t},n))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},L=r=>{T(i=>({...i,[r]:null}))},M=(r,i)=>{const o=r[i];switch(i){case"employee_id":return o;case"name":return e(re,{avatarProps:{radius:"lg",src:r==null?void 0:r.profile_image},name:r==null?void 0:r.name,children:r==null?void 0:r.email});case"phone":return o;case"email":return o;case"date_of_joining":return o;case"department":return l(P,{size:"small",fullWidth:!0,children:[e(w,{id:"department",children:"Department"}),l(F,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:t=>_("department",r.id,t.target.value),label:"Department",variant:"outlined",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(g,{value:"na",disabled:!0,children:"Select Department"}),b.map(t=>e(g,{value:t.id,children:t.name},t.id))]})]});case"designation":return l(P,{size:"small",fullWidth:!0,sx:{zIndex:0},children:[e(w,{id:"designation",children:"Designation"}),l(F,{variant:"outlined",labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:t=>_("designation",r.id,t.target.value),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(g,{value:"na",disabled:!0,children:"Select Designation"}),h.filter(t=>t.department_id===r.department).map(t=>e(g,{value:t.id,children:t.title},t.id))]})]});case"actions":return l("div",{className:"relative flex items-center gap-2",children:[e(v,{content:"View Profile",children:e(y,{className:"text-lg text-default-400 cursor-pointer active:opacity-50",component:S,href:route("profile",{user:r.id}),children:e(H,{})})}),e(v,{content:"Edit Leave",children:e(y,{className:"text-lg text-default-400 cursor-pointer active:opacity-50",component:S,href:route("profile",{user:r.id}),onClick:()=>{L(r.id)},children:e(q,{})})}),e(v,{content:"Delete Leave",color:"danger",children:l(y,{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>{j(r.id)},children:[e(X,{})," "]})})]});default:return"N/A"}};return e("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:l(ee,{fullWidth:!0,isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Employees Table",children:[e($,{columns:[{name:"Employee ID",uid:"employee_id"},{name:"Name",uid:"name"},{name:"Mobile",uid:"phone"},{name:"Email",uid:"email"},{name:"Join Date",uid:"date_of_joining"},{name:"Department",uid:"department"},{name:"Designation",uid:"designation"},{name:"Action",uid:"actions"}],children:r=>e(K,{align:r.uid==="actions"?"center":"start",children:r.name},r.uid)}),e(Y,{items:m,children:r=>e(Q,{children:i=>e(Z,{style:{whiteSpace:"nowrap"},children:M(r,i)})},r.id)})]},m)})},ne=({title:c,allUsers:b,departments:h,designations:m})=>l(p,{children:[e(O,{title:c}),e(N,{sx:{display:"flex",justifyContent:"center",p:2},children:e(R,{in:!0,children:l(V,{children:[e(W,{title:"Employees",sx:{padding:"24px"},action:e(N,{display:"flex",gap:2,children:e(z,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e(ae,{}),children:"Add Employee"})})}),e(G,{children:e(te,{allUsers:b,departments:h,designations:m})})]})})})]});ne.layout=c=>e(J,{children:c});export{ne as default};
