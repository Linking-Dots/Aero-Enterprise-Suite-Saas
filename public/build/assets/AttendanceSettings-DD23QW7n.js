import{r as g,b as o,j as e,Q as pe,F as M,a as S}from"./app-CFP6hyYs.js";import{u as ue,f as i,G as ge,e as P,T as d,Q as me,B as p,R as be,I as j,n as f,A as he}from"./App-D6An07Kr.js";import{C as E}from"./CardHeader-KMGBGer1.js";import{C as $}from"./CardContent-BA1RRosM.js";import{T as m,F as fe}from"./TextField-BXsOYBjR.js";import{I as xe}from"./InputLabel-iYTjAW9D.js";import{S as ye,O as ke}from"./Select-Du8X2Jnk.js";import{M as _e}from"./MenuItem-CGyUvAUg.js";import{C as Ce}from"./CardActions-B06JB2sn.js";import{L as G}from"./LoadingButton-11nymGf5.js";import{F as ve}from"./PencilSquareIcon-BUDILrf-.js";import{a as z,b as N,c as Q}from"./DialogContent-BtQ3vICj.js";import{D as H}from"./DialogTitle-CuQhO8kb.js";import{B as _}from"./Button-MN0ZW-Kq.js";import{F as U}from"./MapPinIcon-C6KMrMWq.js";import{D as q}from"./Divider-BZcpBGrc.js";import{F as we}from"./TrashIcon-BZfJHKgb.js";import{F as We}from"./PlusIcon-vwTHQno-.js";import"./app-CA3O2NZp.js";import"./Popover-D8TPN1sn.js";import"./List-D9MzT9Av.js";import"./listItemTextClasses-BZGV-Gs5.js";import"./dividerClasses-BZroorQj.js";import"./CircularProgress-CFRIP969.js";const Te=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Fe=({title:C,attendanceSettings:J,attendanceTypes:V})=>{const t=ue(),[n,K]=g.useState(J||{}),[v,D]=g.useState(V||[]),[X,I]=g.useState(!1),[Y,B]=g.useState(!1),[c,w]=g.useState(null),[W,A]=g.useState({config:{}}),[b,x]=g.useState({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]}),[h,Z]=g.useState({office_start_time:(n==null?void 0:n.office_start_time)||"09:00",office_end_time:(n==null?void 0:n.office_end_time)||"18:00",break_time_duration:(n==null?void 0:n.break_time_duration)||60,late_mark_after:(n==null?void 0:n.late_mark_after)||15,early_leave_before:(n==null?void 0:n.early_leave_before)||15,overtime_after:(n==null?void 0:n.overtime_after)||30,auto_punch_out:(n==null?void 0:n.auto_punch_out)??!1,auto_punch_out_time:(n==null?void 0:n.auto_punch_out_time)||"20:00",weekend_days:(n==null?void 0:n.weekend_days)||["saturday","sunday"]}),[ee,L]=g.useState(!1),[s,O]=g.useState({}),y=(a,r)=>{Z(l=>({...l,[a]:r}))},ae=async a=>{a.preventDefault(),L(!0);try{const r=await S.post(route("attendance-settings.update"),h);r.status===200&&(K(r.data.attendanceSettings),O({}),f.success(r.data.message||"Attendance settings updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}}))}catch(r){r.response&&r.response.status===422?(O(r.response.data.errors||{}),f.error(r.response.data.error||"Failed to update attendance settings.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})):f.error("An unexpected error occurred. Please try again later.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})}finally{L(!1)}},re=a=>{a.slug==="route-waypoint"||a.name.toLowerCase().includes("waypoint")||a.name.toLowerCase().includes("route")?ne(a):(w(a),A({config:a.config||{}}),I(!0))},T=()=>I(!1),te=(a,r)=>{A(l=>({...l,config:{...l.config,[a]:r}}))},oe=async()=>{if(!c)return;const a=await S.post(route("attendance-types.update",c.id),{config:W.config});D(v.map(r=>r.id===c.id?a.data.attendanceType:r)),T()},ne=(a=null)=>{var r,l;if(a){w(a);const u=((r=a.config)==null?void 0:r.waypoints)||[],k=((l=a.config)==null?void 0:l.tolerance)||100;u.length>0?x({tolerance:k,waypoints:u}):x({tolerance:k,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})}B(!0)},F=()=>{B(!1),w(null),x({tolerance:100,waypoints:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]})},R=(a,r,l)=>{x(u=>({...u,waypoints:u.waypoints.map((k,ce)=>ce===a?{...k,[r]:l}:k)}))},ie=()=>{x(a=>({...a,waypoints:[...a.waypoints,{lat:"",lng:""}]}))},le=a=>{b.waypoints.length>2&&x(r=>({...r,waypoints:r.waypoints.filter((l,u)=>u!==a)}))},se=a=>{x(r=>({...r,tolerance:a}))},de=async()=>{const a=b.waypoints.filter(r=>r.lat&&r.lng);if(a.length===0){f.error("Please add at least one valid waypoint.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}});return}if(!b.tolerance||b.tolerance<=0){f.error("Please enter a valid tolerance value.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}});return}try{if(c){const r={...c.config,tolerance:b.tolerance,waypoints:a},l=await S.post(route("attendance-types.update",c.id),{config:r});D(v.map(u=>u.id===c.id?l.data.attendanceType:u)),f.success("Waypoints updated successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})}else f.success("Waypoints saved successfully!",{icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}});F()}catch{f.error("Failed to save waypoints.",{icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,color:t.palette.text.primary}})}};return o(M,{children:[e(pe,{title:C}),e(p,{sx:{display:"flex",justifyContent:"center",p:2},children:o(i,{container:!0,spacing:4,children:[e(i,{item:!0,xs:12,md:6,children:e(ge,{in:!0,children:o(P,{children:[e(E,{title:"Attendance Settings"}),o("form",{onSubmit:ae,children:[o($,{children:[e(d,{variant:"h6",gutterBottom:!0,children:"Office Timing"}),o(i,{container:!0,spacing:3,children:[e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Office Start Time",type:"time",value:h.office_start_time,onChange:a=>y("office_start_time",a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!s.office_start_time,helperText:s.office_start_time})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Office End Time",type:"time",value:h.office_end_time,onChange:a=>y("office_end_time",a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0},error:!!s.office_end_time,helperText:s.office_end_time})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Break Time Duration (minutes)",type:"number",value:h.break_time_duration,onChange:a=>y("break_time_duration",parseInt(a.target.value)),fullWidth:!0,error:!!s.break_time_duration,helperText:s.break_time_duration})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Late Mark After (minutes)",type:"number",value:h.late_mark_after,onChange:a=>y("late_mark_after",parseInt(a.target.value)),fullWidth:!0,error:!!s.late_mark_after,helperText:s.late_mark_after})})]}),e(d,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Attendance Rules"}),o(i,{container:!0,spacing:3,children:[e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Early Leave Before (minutes)",type:"number",value:h.early_leave_before,onChange:a=>y("early_leave_before",parseInt(a.target.value)),fullWidth:!0,error:!!s.early_leave_before,helperText:s.early_leave_before})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Overtime After (minutes)",type:"number",value:h.overtime_after,onChange:a=>y("overtime_after",parseInt(a.target.value)),fullWidth:!0,error:!!s.overtime_after,helperText:s.overtime_after})})]}),e(d,{variant:"h6",gutterBottom:!0,sx:{marginTop:2},children:"Weekend Settings"}),e(i,{container:!0,spacing:3,children:e(i,{item:!0,xs:12,children:o(me,{fullWidth:!0,children:[e(xe,{id:"weekend-days",children:"Weekend Days"}),e(ye,{labelId:"weekend-days",multiple:!0,value:h.weekend_days,onChange:a=>y("weekend_days",a.target.value),input:e(ke,{label:"Weekend Days"}),error:!!s.weekend_days,renderValue:a=>e(p,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(r=>e(be,{label:r.charAt(0).toUpperCase()+r.slice(1)},r))}),MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:Te.map(a=>e(_e,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),e(fe,{children:s.weekend_days})]})})})]}),e(Ce,{sx:{justifyContent:"center"},children:e(G,{loading:ee,sx:{borderRadius:"50px",padding:"6px 16px"},variant:"outlined",color:"primary",type:"submit",children:"Save"})})]})]})})}),e(i,{item:!0,xs:12,md:6,children:o(P,{children:[e(E,{title:"Attendance Types"}),e($,{children:e(i,{container:!0,spacing:2,children:v.map(a=>e(i,{item:!0,xs:12,children:o(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderRadius:3,background:"rgba(255,255,255,0.12)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.18)",backdropFilter:"blur(12px) saturate(180%)",transition:"box-shadow 0.2s","&:hover":{boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.18)"}},children:[o(p,{sx:{display:"flex",alignItems:"center",gap:2},children:[e(p,{sx:{mr:1},children:a.icon}),o(p,{children:[e(d,{variant:"subtitle1",sx:{fontWeight:600},children:a.name}),e(d,{variant:"body2",color:"text.secondary",children:a.description}),o(d,{variant:"caption",color:"text.secondary",children:["Slug: ",a.slug]}),o(d,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5},children:["Config: ",JSON.stringify(a.config)]})]})]}),e(p,{children:e(j,{onClick:()=>re(a),children:e(ve,{style:{width:20,height:20,color:t.palette.primary.main}})})})]})},a.id))})})]})})]})}),o(z,{open:X,onClose:T,maxWidth:"sm",fullWidth:!0,children:[e(H,{children:"Edit Attendance Type Config"}),e(N,{children:c&&o(M,{children:[o(d,{variant:"subtitle1",sx:{mb:2},children:[c.name," (",c.slug,")"]}),Object.keys(W.config).length===0&&e(d,{variant:"body2",color:"text.secondary",children:"No config fields available for this type."}),Object.entries(W.config).map(([a,r])=>e(m,{label:a,value:r,onChange:l=>te(a,l.target.value),fullWidth:!0,margin:"normal"},a))]})}),o(Q,{children:[e(_,{onClick:T,children:"Cancel"}),e(_,{onClick:oe,variant:"contained",children:"Save"})]})]}),o(z,{open:Y,onClose:F,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",background:t.glassCard.background,border:t.glassCard.border,borderRadius:3,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"}},children:[o(H,{sx:{display:"flex",alignItems:"center",gap:2,borderBottom:"1px solid rgba(255,255,255,0.1)",pb:2},children:[e(U,{style:{width:24,height:24,color:t.palette.primary.main}}),e(d,{variant:"h6",component:"span",children:c?`Manage Waypoints - ${c.name}`:"Manage Waypoints"})]}),o(N,{sx:{pt:3},children:[e(d,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Define location waypoints for attendance tracking. Each waypoint requires latitude and longitude coordinates."}),e(p,{sx:{mb:4},children:o(p,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[o(d,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:t.palette.primary.main,fontWeight:600,mb:2},children:[o("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",children:[e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Location Tolerance Settings"]}),e(m,{label:"Tolerance (meters)",placeholder:"e.g., 100",type:"number",value:b.tolerance,onChange:a=>se(parseInt(a.target.value)||0),fullWidth:!0,inputProps:{min:1,max:1e4,step:1},helperText:"Distance in meters within which attendance can be marked from each waypoint",sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})]})}),e(q,{sx:{my:3,opacity:.3}}),e(i,{container:!0,spacing:3,children:b.waypoints.map((a,r)=>o(i,{item:!0,xs:12,children:[o(p,{sx:{p:2.5,borderRadius:3,background:"rgba(255,255,255,0.08)",boxShadow:"0 4px 24px 0 rgba(31, 38, 135, 0.10)",border:"1px solid rgba(255,255,255,0.12)",backdropFilter:"blur(12px) saturate(180%)"},children:[o(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[o(d,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",gap:1,color:t.palette.primary.main,fontWeight:600},children:[e(U,{style:{width:16,height:16}}),"Waypoint ",r+1]}),b.waypoints.length>2&&e(j,{onClick:()=>le(r),size:"small",sx:{color:t.palette.error.main,"&:hover":{background:"rgba(255,0,0,0.08)"}},children:e(we,{style:{width:16,height:16}})})]}),o(i,{container:!0,spacing:2,children:[e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Latitude",placeholder:"e.g., 40.7128",type:"number",value:a.lat,onChange:l=>R(r,"lat",l.target.value),fullWidth:!0,inputProps:{step:"any",min:-90,max:90},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})}),e(i,{item:!0,xs:12,sm:6,children:e(m,{label:"Longitude",placeholder:"e.g., -74.0060",type:"number",value:a.lng,onChange:l=>R(r,"lng",l.target.value),fullWidth:!0,inputProps:{step:"any",min:-180,max:180},sx:{"& .MuiOutlinedInput-root":{background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)","&:hover":{background:"rgba(255,255,255,0.08)"},"&.Mui-focused":{background:"rgba(255,255,255,0.1)"}}}})})]})]}),r<b.waypoints.length-1&&e(q,{sx:{my:2,opacity:.3}})]},r))}),e(p,{sx:{mt:3,display:"flex",justifyContent:"center"},children:e(_,{startIcon:e(We,{style:{width:20,height:20}}),onClick:ie,variant:"outlined",sx:{borderRadius:3,background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.2)",color:t.palette.primary.main,"&:hover":{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.3)"}},children:"Add Another Waypoint"})})]}),o(Q,{sx:{p:3,borderTop:"1px solid rgba(255,255,255,0.1)",gap:2},children:[e(_,{onClick:F,sx:{borderRadius:3,color:t.palette.text.secondary,"&:hover":{background:"rgba(255,255,255,0.05)"}},children:"Cancel"}),e(G,{onClick:de,variant:"contained",sx:{borderRadius:3,background:`linear-gradient(135deg, ${t.palette.primary.main}, ${t.palette.primary.dark})`,boxShadow:"0 4px 20px rgba(0,0,0,0.15)","&:hover":{boxShadow:"0 6px 25px rgba(0,0,0,0.2)"}},children:"Save Waypoints"})]})]})]})};Fe.layout=C=>e(he,{children:C});export{Fe as default};
