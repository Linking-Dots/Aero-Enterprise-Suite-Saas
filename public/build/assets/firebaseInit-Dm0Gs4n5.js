import{_ as f,a as l}from"./app-vxJEuD-Q.js";import"./app-CX8GSXRI.js";let s=!1;const m=async()=>{if(!s)try{const{onMessageListener:t,requestNotificationPermission:a}=await f(async()=>{const{onMessageListener:e,requestNotificationPermission:o}=await import("./firebase-config-C3K-XTXI.js");return{onMessageListener:e,requestNotificationPermission:o}},[]),n=await a();if(n)try{const e=await l.post(route("updateFcmToken"),{fcm_token:n});e.status===200&&console.log("FCM Token Updated:",e.data.fcm_token)}catch(e){console.error("Failed to update FCM token:",e)}else console.warn("Notification permission denied or no token retrieved.");const i=t().then(e=>{console.log("Message received:",e);const{title:o,body:r,icon:c}=e.notification;Notification.permission==="granted"&&new Notification(o,{body:r,icon:c}),alert(`${o}: ${r}`)}).catch(e=>console.error("onMessageListener error:",e));return s=!0,()=>{i&&typeof i=="function"&&i()}}catch(t){console.error("Firebase initialization error:",t)}};export{m as initFirebase};
