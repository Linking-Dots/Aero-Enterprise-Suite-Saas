import{c as k,r as D,a as e,j as n,b as g,F as b,Y as B}from"./app-CkW2VGJ3.js";import{z as v,u as H,D as O,T as V,M as u,I as S,E as G,F,c as J,B as j,d as U,a as W,A as $}from"./App-B5ClDIJV.js";import{G as q}from"./GlassCard-DyG5vAde.js";import{T as K,a as I,b as o,c as X,d as Y,e as Q}from"./TableRow-B7VSrpuV.js";import{F as N,I as P,S as M}from"./Select-BJM7bxqT.js";import{C as z}from"./CircularProgress-xAMr4Z2z.js";import{C as Z}from"./CardHeader-DTSs8N-B.js";const ee=v(k.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),re=v(k.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),ae=v(k.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),te=({allUsers:C,departments:f,designations:p})=>{const[y,E]=D.useState(C),a=H();console.log(a);const[oe,L]=D.useState({});async function A(r,d,t){const c=new Promise(async(l,s)=>{try{const i=t.target.value,h=await fetch(route("profile.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:d,[r]:i})}),m=await h.json();h.ok?(E(_=>_.map(x=>{if(x.id===d){const w={...x};return r==="department"&&x.department!==i&&(w.designation=null),w[r]=i,w}return x})),l([...m.messages]),console.log(m.messages)):(s(m.messages),console.error(m.messages))}catch(i){console.log(i),s(["An unexpected error occurred."])}});F.promise(c,{pending:{render(){return n("div",{style:{display:"flex",alignItems:"center"},children:[e(z,{}),n("span",{style:{marginLeft:"8px"},children:["Updating employee ",r,"..."]})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:l}){return e(b,{children:l.map((s,i)=>e("div",{children:s},i))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:l}){return e(b,{children:l.map((s,i)=>e("div",{children:s},i))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})}const R=async r=>{const d=new Promise(async(t,c)=>{try{const l=await fetch(route("profile.delete"),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({user_id:r})}),s=await l.json();l.ok?(E(i=>i.filter(h=>h.id!==r)),t([s.message])):c([s.message])}catch(l){console.error("Error deleting user:",l),c(["An error occurred while deleting user. Please try again."])}});F.promise(d,{pending:{render(){return n("div",{style:{display:"flex",alignItems:"center"},children:[e(z,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting user..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:t}){return e(b,{children:t.map((c,l)=>e("div",{children:c},l))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:t}){return e(b,{children:t.map((c,l)=>e("div",{children:c},l))})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},T=r=>{L(d=>({...d,[r]:null}))};return e(Q,{style:{maxHeight:"70vh",overflowY:"auto"},children:n(Y,{"aria-label":"employee table",children:[e(K,{children:n(I,{children:[e(o,{sx:{whiteSpace:"nowrap"},children:"Employee ID"}),e(o,{sx:{whiteSpace:"nowrap"},children:"Name"}),e(o,{sx:{whiteSpace:"nowrap"},children:"Email"}),e(o,{sx:{whiteSpace:"nowrap"},children:"Mobile"}),e(o,{sx:{whiteSpace:"nowrap"},children:"Join Date"}),e(o,{sx:{whiteSpace:"nowrap"},children:"Department"}),e(o,{sx:{whiteSpace:"nowrap"},children:"Role"}),e(o,{sx:{whiteSpace:"nowrap"},align:"right",children:"Action"})]})}),e(X,{children:y.map(r=>{var d;return n(I,{children:[e(o,{sx:{whiteSpace:"nowrap"},children:r.employee_id||"N/A"}),n(o,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap"},children:[e(O,{src:`assets/images/users/${r.user_name}.jpg`,alt:r.first_name}),n(V,{sx:{marginLeft:"10px"},children:[e(g,{style:{textDecoration:"none",color:a.palette.text.primary,fontWeight:"bold"},href:route("profile",{user:r.id}),children:r.name||"N/A"}),e("br",{}),((d=p.find(t=>t.id===r.designation))==null?void 0:d.title)||"N/A"]})]}),e(o,{sx:{whiteSpace:"nowrap"},children:r.phone||"N/A"}),e(o,{sx:{whiteSpace:"nowrap"},children:r.email||"N/A"}),e(o,{sx:{whiteSpace:"nowrap"},children:r.date_of_joining||"N/A"}),e(o,{sx:{whiteSpace:"nowrap"},children:n(N,{size:"small",fullWidth:!0,children:[e(P,{id:"department",children:"Department"}),n(M,{labelId:"department",id:`department-select-${r.id}`,value:r.department||"na",onChange:t=>A("department",r.id,t),label:"Department",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(u,{value:"na",disabled:!0,children:"Select Department"}),f.map(t=>e(u,{value:t.id,children:t.name},t.id))]})]})}),e(o,{sx:{whiteSpace:"nowrap"},children:n(N,{size:"small",fullWidth:!0,children:[e(P,{id:"designation",children:"Designation"}),n(M,{labelId:"designation",id:`designation-select-${r.id}`,value:r.designation||"na",onChange:t=>A("designation",r.id,t),disabled:!r.department,label:"Designation",MenuProps:{PaperProps:{sx:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,borderRadius:2,boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px"}}},children:[e(u,{value:"na",disabled:!0,children:"Select Designation"}),p.filter(t=>t.department_id===r.department).map(t=>e(u,{value:t.id,children:t.title},t.id))]})]})}),n(o,{sx:{whiteSpace:"nowrap"},align:"right",children:[e(S,{component:g,href:route("profile",{user:r.id}),onClick:()=>{T(r.id)},children:e(G,{})}),e(S,{component:g,href:route("profile",{user:r.id}),onClick:()=>{T(r.id)},children:e(ae,{})}),n(S,{component:g,href:route("profile",{user:r.id}),onClick:()=>{R(r.id)},children:[e(re,{})," "]})]})]},r.id)})})]})})},he=({title:C,allUsers:f,departments:p,designations:y})=>n($,{children:[e(B,{title:C}),e(j,{sx:{display:"flex",justifyContent:"center",p:2},children:e(J,{in:!0,children:n(q,{children:[e(Z,{title:"Employees",sx:{padding:"24px"},action:e(j,{display:"flex",gap:2,children:e(U,{title:"Add Employee",variant:"outlined",color:"success",startIcon:e(ee,{}),children:"Add Employee"})})}),e(W,{children:e(te,{allUsers:f,departments:p,designations:y})})]})})})]});export{he as default};
