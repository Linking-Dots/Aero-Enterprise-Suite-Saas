import{a as e,j as n,V as I,F as C,M as q}from"./app-Cd8DeGGd.js";import{T as B,u as L,r as c,V as H,c as V,G as D,b as S,X as P,Y as M,p as E,Z as U,f as T,g as Y,D as $,a as j,B as O}from"./vendor-COEImg3x.js";import{g as R,B as G,G as X,A as Z}from"./App-BUxVUvFm.js";import{d as z}from"./Delete-C6_JM5CI.js";import{a as J,b as Q,c as K,d as ee,e as te,t as re}from"./chunk-F3UDT23P-COZpGvNJ.js";import{t as w}from"./chunk-CSXHODZI-wbuC5vLx.js";import{d as ae,G as W}from"./GlassDialog-CKA3D0qM.js";import{L as oe}from"./LoadingButton-CGkHSsrC.js";import{A as le}from"./Add-_FAdX1Lj.js";import"./chunk-MZRCPRP2-DMCeja31.js";import"./chunk-SLABUSGS-CzDOPjJe.js";import"./chunk-7F3ZLNJ6-C6MyY-gZ.js";const se=({holidaysData:d,handleClickOpen:u,setCurrentHoliday:g,openModal:l,setHolidaysData:t})=>{console.log(d);const a=(r,s)=>{const o=r[s];switch(s){case"title":return o;case"from_date":return new Date(o).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"});case"to_date":return new Date(o).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"});case"actions":return n("div",{className:"relative flex items-center gap-2",children:[e(w,{content:"Edit Holiday",children:e("span",{className:"text-lg text-default-400 cursor-pointer active:opacity-50",onClick:()=>{g(r),l("edit_holiday")},children:e(R,{})})}),e(w,{content:"Delete Holiday",color:"danger",children:e("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",onClick:()=>u(r.id,"delete_holiday"),children:e(z,{})})})]});default:return o}},h=[{name:"Title",uid:"title"},{name:"From Date",uid:"from_date"},{name:"To Date",uid:"to_date"},{name:"Actions",uid:"actions"}];return e("div",{style:{maxHeight:"84vh",overflowY:"auto"},children:d.length===0?e(B,{variant:"h6",align:"center",sx:{mt:2},children:"No holidays"}):n(re,{isStriped:!0,selectionMode:"multiple",selectionBehavior:"toggle",isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Holiday Table",children:[e(J,{columns:h,children:r=>e(Q,{align:r.uid==="actions"?"center":"start",children:r.name},r.uid)}),e(K,{items:d,children:r=>e(ee,{children:s=>e(te,{style:{whiteSpace:"nowrap"},children:a(r,s)})},r.id)})]})})},A=({open:d,closeModal:u,holidaysData:g,setHolidaysData:l,currentHoliday:t})=>{I().props;const a=L(),[h,r]=c.useState((t==null?void 0:t.title)||""),[s,o]=c.useState((t==null?void 0:t.from_date)||""),[f,p]=c.useState((t==null?void 0:t.to_date)||""),[m,k]=c.useState({}),[F,_]=c.useState(!1);return n(W,{open:d,onClose:u,fullWidth:!0,maxWidth:"sm",children:[n(H,{sx:{display:"flex",alignItems:"center"},children:[e(B,{variant:"h6",children:"Add Holiday"}),e(V,{onClick:u,sx:{position:"absolute",top:8,right:16},children:e(ae,{})})]}),n("form",{onSubmit:async y=>{y.preventDefault(),_(!0);const N=new Promise(async(x,b)=>{try{const i={title:h,fromDate:s,toDate:f};t&&(i.id=t.id);const v=await axios.post(route("holiday-add"),i);v.status===200&&(l(v.data.holidays),x([v.data.message||"Holiday added successfully"]),u())}catch(i){_(!1),i.response?(i.response.status===422?(k(i.response.data.errors||{}),b(i.response.statusText||"Failed to add holiday")):b("An unexpected error occurred. Please try again later."),console.error(i.response)):i.request?(b("No response received from the server. Please check your internet connection."),console.error(i.request)):(b("An error occurred while setting up the request."),console.error("Error",i.message))}finally{_(!1)}});G.promise(N,{pending:{render(){return n("div",{style:{display:"flex",alignItems:"center"},children:[e(E,{}),e("span",{style:{marginLeft:"8px"},children:"Adding holiday..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},success:{render({data:x}){return e(C,{children:x.map((b,i)=>e("div",{children:b},i))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}},error:{render({data:x}){return e(C,{children:x})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:a.glassCard.backgroundColor,border:a.glassCard.border,color:a.palette.text.primary}}})},children:[e(P,{children:n(D,{container:!0,spacing:2,children:[e(D,{item:!0,xs:12,md:6,children:e(S,{label:"Title",type:"text",fullWidth:!0,value:h,onChange:y=>r(y.target.value),InputLabelProps:{shrink:!0},error:!!m.title,helperText:m.title})}),e(D,{item:!0,xs:12,md:6,children:e(S,{label:"From",type:"date",fullWidth:!0,value:s,onChange:y=>o(y.target.value),InputLabelProps:{shrink:!0},error:!!m.fromDate,helperText:m.fromDate})}),e(D,{item:!0,xs:12,md:6,children:e(S,{label:"To",type:"date",fullWidth:!0,value:f,onChange:y=>p(y.target.value),InputLabelProps:{shrink:!0},error:!!m.toDate,helperText:m.toDate})})]})}),e(M,{sx:{padding:"16px",justifyContent:"center"},children:e(oe,{type:"submit",variant:"outlined",color:"primary",loading:F,disabled:F,sx:{borderRadius:"50px"},children:"Submit"})})]})]})},ie=({open:d,handleClose:u,holidayIdToDelete:g,setHolidaysData:l})=>{const t=L();return n(W,{open:d,onClose:u,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(H,{id:"alert-dialog-title",children:"Confirm Deletion"}),e(P,{children:e(U,{id:"alert-dialog-description",children:"Are you sure you want to delete this holiday? This action cannot be undone."})}),n(M,{children:[e(T,{onClick:u,color:"primary",children:"Cancel"}),e(T,{onClick:()=>{const h=new Promise(async(r,s)=>{try{const o=await axios.delete(route("holiday-delete",{id:g,route:route().current()}));o.status===200&&(l(o.data.holidays),r("Holiday deleted successfully"))}catch(o){console.error("Error deleting task:",o),s(o.response.data.error||"Failed to delete holiday")}finally{u()}});G.promise(h,{pending:{render(){return n("div",{style:{display:"flex",alignItems:"center"},children:[e(E,{}),e("span",{style:{marginLeft:"8px"},children:"Deleting holiday..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:t.glassCard.backgroundColor,border:t.glassCard.border,color:t.palette.text.primary}},success:{render({data:r}){return e(C,{children:r})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:t.glassCard.backgroundColor,border:t.glassCard.border,color:t.palette.text.primary}},error:{render({data:r}){return e(C,{children:r})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",backgroundColor:t.glassCard.backgroundColor,border:t.glassCard.border,color:t.palette.text.primary}}})},color:"error",autoFocus:!0,children:"Delete"})]})]})},ne=({title:d})=>{const{auth:u,holidays:g}=I().props,[l,t]=c.useState({type:null,holidayId:null,currentHoliday:null}),[a,h]=c.useState(g),r=c.useCallback((p,m=null,k=null)=>{t({type:p,holidayId:m,currentHoliday:k})},[]),s=c.useCallback(()=>{t({type:null,holidayId:null,currentHoliday:null})},[]),o=c.useCallback(p=>{h(p)},[]),f=c.useMemo(()=>({open:!!l.type,closeModal:s,setHolidaysData:o,holidaysData:a,currentHoliday:l.currentHoliday}),[l.type,s,o,a,l.currentHoliday]);return n(C,{children:[e(q,{title:d}),l.type==="add_holiday"&&e(A,{...f}),l.type==="edit_holiday"&&e(A,{...f}),l.type==="delete_holiday"&&e(ie,{open:!0,holidayId:l.holidayId,setHolidaysData:o,closeModal:s,holidaysData:a}),e(O,{sx:{p:2},children:n(X,{children:[e(Y,{title:"Leaves",sx:{padding:"24px"},action:e(T,{title:"Add Leave",variant:"outlined",startIcon:e(le,{}),onClick:()=>r("add_holiday"),children:"Add Holiday"})}),e($,{}),e(j,{children:e(se,{holidaysData:a,onEdit:p=>r("edit_holiday",null,p),onDelete:p=>r("delete_holiday",p)})})]})})]})};ne.layout=d=>e(Z,{children:d});export{ne as default};
